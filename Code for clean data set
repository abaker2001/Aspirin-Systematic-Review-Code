library(readxl)
Transposed_DE_form_1_sheet_for_SPSS_ <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Transposed DE form (1 sheet, for SPSS).xlsx")
#dataset now imported (probably be different code on a different computer)
library(tidyverse)
data <- Transposed_DE_form_1_sheet_for_SPSS_
#remove blank 40 rows at bottom
data <- data[1:26,]
#change column names for ease of use 
names(data)[1] <- "title"
names(data)[2] <- "authors"
names(data)[3] <- "year"
names(data)[4] <- "reference"
names(data)[5] <- "country"
names(data)[6] <- "design"
names(data)[7] <- "cohort_size"
names(data)[8] <- "control_group"
names(data)[9] <- "exposed_group"
names(data)[10] <- "age"
names(data)[11] <- "sex"
names(data)[12] <- "stage_characteristics"
names(data)[13] <- "node_characteristics"
names(data)[14] <- "metastasis_characteristics"
names(data)[15] <- "grade_characteristics"
names(data)[16] <- "molsubtype_characteristics"
names(data)[17] <- "treatment_characteristics"
names(data)[18] <- "menopause_characteristics"
names(data)[19] <- "smoking_characteristics"
names(data)[20] <- "weight_characteristics"
names(data)[21] <- "race_characteristics"
names(data)[22] <- "recruitment_years"
names(data)[23] <- "followup_end"
names(data)[24] <- "mean_or_median_followup"
names(data)[25] <- "exposure"
names(data)[26] <- "prediagnostic_controls_bc_death"
names(data)[27] <- "prediagnostic_exposed_bc_death"
names(data)[28] <- "unadjusted_prediagnostic_bc_death"
names(data)[29] <- "adjusted_prediagnostic_bc_death"
names(data)[30] <- "stage_stratified_prediagnostic_bc_death"
names(data)[31] <- "menopause_stratified_prediagnostic_bc_death"
names(data)[32] <- "molsubtype_stratified_prediagnostic_bc_death"
names(data)[33] <- "BMI_stratified_prediagnostic_bc_death"
names(data)[34] <- "dose_stratified_prediagnostic_bc_death"
names(data)[35] <- "treatment_stratified_prediagnostic_bc_death"
names(data)[36] <- "prediagnostic_controls_allcause_death"
names(data)[37] <- "prediagnostic_exposed_allcause_death"
names(data)[38] <- "unadjusted_prediagnostic_allcause_death"
names(data)[39] <- "adjusted_prediagnostic_allcause_death"
names(data)[40] <- "stratified_prediagnostic_allcause_death"
names(data)[41] <- "prediagnostic_controls_recurrence"
names(data)[42] <- "prediagnostic_exposed_recurrence"
names(data)[43] <- "unadjusted_prediagnostic_recurrence"
names(data)[44] <- "adjusted_prediagnostic_recurrence"
names(data)[45] <- "stratified_prediagnostic_recurrence"
names(data)[46] <- "prediagnostic_controls_progression"
names(data)[47] <- "prediagnostic_exposed_progression"
names(data)[48] <- "unadjusted_prediagnostic_progression"
names(data)[49] <- "adjusted_prediagnostic_progression"
names(data)[50] <- "stratified_prediagnostic_progression"
names(data)[51] <- "postdiagnostic_controls_bc_death"
names(data)[52] <- "postdiagnostic_exposed_bc_death"
names(data)[53] <- "unadjusted_postdiagnostic_bc_death"
names(data)[54] <- "adjusted_postdiagnostic_bc_death"
names(data)[55] <- "stage_stratified_postdiagnostic_bc_death"
names(data)[56] <- "menopause_stratified_postdiagnostic_bc_death"
names(data)[57] <- "molsubtype_stratified_postdiagnostic_bc_death"
names(data)[58] <- "BMI_stratified_postdiagnostic_bc_death"
names(data)[59] <- "dose_stratified_postdiagnostic_bc_death"
names(data)[60] <- "treatment_stratified_postdiagnostic_bc_death"
names(data)[61] <- "postdiagnostic_controls_allcause_death"
names(data)[62] <- "postdiagnostic_exposed_allcause_death"
names(data)[63] <- "unadjusted_postdiagnostic_allcause_death"
names(data)[64] <- "adjusted_postdiagnostic_allcause_death"
names(data)[65] <- "stratified_postdiagnostic_allcause_death"
names(data)[66] <- "postdiagnostic_controls_recurrence"
names(data)[67] <- "postdiagnostic_exposed_recurrence"
names(data)[68] <- "unadjusted_postdiagnostic_recurrence"
names(data)[69] <- "adjusted_postdiagnostic_recurrence"
names(data)[70] <- "stratified_postdiagnostic_recurrence"
names(data)[71] <- "postdiagnostic_controls_progression"
names(data)[72] <- "postdiagnostic_exposed_progression"
names(data)[73] <- "unadjusted_postdiagnostic_progression"
names(data)[74] <- "adjusted_postdiagnostic_progression"
names(data)[75] <- "stratified_postdiagnostic_progression"
names(data)[76] <- "confounders"
#create column with first author and year together 
data$first_author <- sapply(data$authors, function(x) strsplit(x, ", ")[[1]][1])
data$first_author2 <- sapply(data$first_author, function(x) {s <- strsplit(x, " ")[[1]]; return(s[length(s)])})
data$author_year <- paste0(data$first_author2, " (", data$year, ")")
#create data table with author_year instead of author and year
data <- subset(data, select = -c(authors, year, first_author, first_author2))
#reorder columns to put author_year in 2nd position
data <- data [, c(1, 75, 2:74)]
#split mean_or_median_followup into mean_followup and median_followup
data$mean_followup <- NA
data$median_followup <- NA
data[grep("Mean|Average", data$mean_or_median_followup, ignore.case = TRUE),]$mean_followup <- data[grep("Mean|Average", data$mean_or_median_followup, ignore.case = TRUE),]$mean_or_median_followup
data[grep("Mean|Average", data$mean_or_median_followup, invert = TRUE),]$median_followup <- data[grep("Mean|Average", data$mean_or_median_followup, invert = TRUE),]$mean_or_median_followup
#replace mean_or_median_followup with mean_followup and median_followup
data <- subset(data, select = -c(mean_or_median_followup))
data <- data[, c(1:23, 75, 76, 24:74)]
#group papers' unadjusted prediagnostic breast cancer death data by OR, HR etc. (aren't any RR for this)
data$unadj_pre_bc_death_OR <- NA
data$unadj_pre_bc_death_HR <- NA
data[grep("OR", data$unadjusted_prediagnostic_bc_death),]$unadj_pre_bc_death_OR <- data[grep("OR", data$unadjusted_prediagnostic_bc_death),]$unadjusted_prediagnostic_bc_death
data[grep("HR", data$unadjusted_prediagnostic_bc_death),]$unadj_pre_bc_death_HR <- data[grep("HR", data$unadjusted_prediagnostic_bc_death),]$unadjusted_prediagnostic_bc_death
#reorder so that these new columns are next to the original unadjusted prediagnostic BC death column
data <- data[, c(1:28, 77, 78, 29:76)]
#all adjusted prediagnostic breast cancer death data given as HR so no need to split this column
#remove columns with no data in them (pre d BC mort strat menopause, pre d adjusted progression, pre d strat progression)
data <- subset(data, select = -c(menopause_stratified_prediagnostic_bc_death, adjusted_prediagnostic_progression, stratified_prediagnostic_progression))
#group papers' prediagnostic bc death stratified by stage data into OR and HR
data$pre_bc_death_stage_OR <- NA
data$pre_bc_death_stage_HR <- NA
data[grep("OR", data$stage_stratified_prediagnostic_bc_death),]$pre_bc_death_stage_OR <- data[grep("OR", data$stage_stratified_prediagnostic_bc_death),]$stage_stratified_prediagnostic_bc_death
data[grep("HR", data$stage_stratified_prediagnostic_bc_death),]$pre_bc_death_stage_HR <- data[grep("HR", data$stage_stratified_prediagnostic_bc_death),]$stage_stratified_prediagnostic_bc_death
data <- data[, c(1:32, 76, 77, 33:75)]
#all molsubtype stratified prediagnostic bc death data given by HR so no need to split
#all bmi stratified prediagnostic bc death data given by HR so no need to split
#group papers' prediagnostic bc death data stratified by aspirin dose into OR and HR
data$pre_bc_death_dose_OR <- NA
data$pre_bc_death_dose_HR <- NA
data[grep("OR", data$dose_stratified_prediagnostic_bc_death),]$pre_bc_death_dose_OR <- data[grep("OR", data$dose_stratified_prediagnostic_bc_death),]$dose_stratified_prediagnostic_bc_death
data[grep("HR", data$dose_stratified_prediagnostic_bc_death),]$pre_bc_death_dose_HR <- data[grep("HR", data$dose_stratified_prediagnostic_bc_death),]$dose_stratified_prediagnostic_bc_death
data <- data[, c(1:37, 78, 79, 38:77)]
#all treatment stratified prediagnostic bc death data given by HR so no need to split
#group papers' unadjusted prediagnostic all cause death into OR and HR
data$unadj_pre_ac_death_OR <- NA
data$unadj_pre_ac_death_HR <- NA
data[grep("OR", data$unadjusted_prediagnostic_allcause_death),]$unadj_pre_ac_death_OR <- data[grep("OR", data$unadjusted_prediagnostic_allcause_death),]$unadjusted_prediagnostic_allcause_death
data[grep("HR", data$unadjusted_prediagnostic_allcause_death),]$unadj_pre_ac_death_HR <- data[grep("HR", data$unadjusted_prediagnostic_allcause_death),]$unadjusted_prediagnostic_allcause_death
data <- data[, c(1:43, 80, 81, 44:79)]
#adjusted and stratified prediagnostic all cause survival data all in HR so no need to split
#split prediagnostic unadjusted recurrence into OR, RR and HR
data$pre_rec_unadj_RR <- NA
data$pre_rec_unadj_HR <- NA
data[grep("RR", data$unadjusted_prediagnostic_recurrence),]$pre_rec_unadj_RR <- data[grep("RR", data$unadjusted_prediagnostic_recurrence),]$unadjusted_prediagnostic_recurrence
data[grep("HR", data$unadjusted_prediagnostic_recurrence),]$pre_rec_unadj_HR <- data[grep("HR", data$unadjusted_prediagnostic_recurrence),]$unadjusted_prediagnostic_recurrence
data <- data[, c(1:50, 82, 83, 51:81)]
#split prediagnostic adjusted recurrence into HR and RR
data$pre_rec_adj_RR <- NA
data$pre_rec_adj_HR <- NA
data[grep("RR", data$adjusted_prediagnostic_recurrence),]$pre_rec_adj_RR <- data[grep("RR", data$adjusted_prediagnostic_recurrence),]$adjusted_prediagnostic_recurrence
data[grep("HR", data$adjusted_prediagnostic_recurrence),]$pre_rec_adj_HR <- data[grep("HR", data$adjusted_prediagnostic_recurrence),]$adjusted_prediagnostic_recurrence
data <- data[, c(1:53, 84, 85, 54:83)]
#stratified prediagnostic recurrence data all given by HR so no need to split
#unadjusted prediagnostic progression all given by OR so no need to split
#split unadjusted postdiagnostic bc death data into RR, OR and HR
data$unadj_post_bc_death_RR <- NA
data$unadj_post_bc_death_OR <- NA
data$unadj_post_bc_death_HR <- NA
data[grep("RR", data$unadjusted_postdiagnostic_bc_death),]$unadj_post_bc_death_RR <- data[grep("RR", data$unadjusted_postdiagnostic_bc_death),]$unadjusted_postdiagnostic_bc_death
data[grep("OR", data$unadjusted_postdiagnostic_bc_death),]$unadj_post_bc_death_OR <- data[grep("OR", data$unadjusted_postdiagnostic_bc_death),]$unadjusted_postdiagnostic_bc_death
data[grep("HR", data$unadjusted_postdiagnostic_bc_death),]$unadj_post_bc_death_HR <- data[grep("HR", data$unadjusted_postdiagnostic_bc_death),]$unadjusted_postdiagnostic_bc_death
data <- data[, c(1:62, 86, 87, 88, 63:85)]
#split adjusted postdiagnostic bc death data into RR, OR and HR
data$adj_post_bc_death_RR <- NA
data$adj_post_bc_death_OR <- NA
data$adj_post_bc_death_HR <- NA
data[grep("RR", data$adjusted_postdiagnostic_bc_death),]$adj_post_bc_death_RR <- data[grep("RR", data$adjusted_postdiagnostic_bc_death),]$adjusted_postdiagnostic_bc_death
data[grep("OR", data$adjusted_postdiagnostic_bc_death),]$adj_post_bc_death_OR <- data[grep("OR", data$adjusted_postdiagnostic_bc_death),]$adjusted_postdiagnostic_bc_death
data[grep("HR", data$adjusted_postdiagnostic_bc_death),]$adj_post_bc_death_HR <- data[grep("HR", data$adjusted_postdiagnostic_bc_death),]$adjusted_postdiagnostic_bc_death
data <- data[, c(1:66, 89, 90, 91, 67:88)]
#split postdiagnostic bc death data stratified by stage into RR, OR and HR
data$post_bc_death_stage_RR <- NA
data$post_bc_death_stage_OR <- NA
data$post_bc_death_stage_HR <- NA
data[grep("RR", data$stage_stratified_postdiagnostic_bc_death),]$post_bc_death_stage_RR <- data[grep("RR", data$stage_stratified_postdiagnostic_bc_death),]$stage_stratified_postdiagnostic_bc_death
data[grep("OR", data$stage_stratified_postdiagnostic_bc_death),]$post_bc_death_stage_OR <- data[grep("OR", data$stage_stratified_postdiagnostic_bc_death),]$stage_stratified_postdiagnostic_bc_death
data[grep("HR", data$stage_stratified_postdiagnostic_bc_death),]$post_bc_death_stage_HR <- data[grep("HR", data$stage_stratified_postdiagnostic_bc_death),]$stage_stratified_postdiagnostic_bc_death
data <- data[, c(1:70, 92, 93, 94, 71:91)]
#menopause stratified postdiagnostic bc death data stratified by menopause all given by RR so no need to split
#split molsubtype stratified postdiagnostic bc death data into RR and HR
data$post_bc_death_molsubtype_RR <- NA
data$post_bc_death_molsubtype_HR <- NA
data[grep("RR", data$molsubtype_stratified_postdiagnostic_bc_death),]$post_bc_death_molsubtype_RR <- data[grep("RR", data$molsubtype_stratified_postdiagnostic_bc_death),]$molsubtype_stratified_postdiagnostic_bc_death
data[grep("HR", data$molsubtype_stratified_postdiagnostic_bc_death),]$post_bc_death_molsubtype_HR <- data[grep("HR", data$molsubtype_stratified_postdiagnostic_bc_death),]$molsubtype_stratified_postdiagnostic_bc_death
data <- data[, c(1:75, 95, 96, 76:94)]
#bmi stratified postdiagnostic bc death data all given by RR so no need to split
#split dose stratified postdiagnostic bc death data into OR and HR
data$post_bc_death_dose_OR <- NA
data$post_bc_death_dose_HR <- NA
data[grep("OR", data$dose_stratified_postdiagnostic_bc_death),]$post_bc_death_dose_OR <- data[grep("OR", data$dose_stratified_postdiagnostic_bc_death),]$dose_stratified_postdiagnostic_bc_death
data[grep("HR", data$dose_stratified_postdiagnostic_bc_death),]$post_bc_death_dose_HR <- data[grep("HR", data$dose_stratified_postdiagnostic_bc_death),]$dose_stratified_postdiagnostic_bc_death
data <- data[, c(1:79, 97, 98, 80:96)]
#split treatment stratified postdiagnostic bc death data into OR and HR
data$post_bc_death_treatment_OR <- NA
data$post_bc_death_treatment_HR <- NA
data[grep("OR", data$treatment_stratified_postdiagnostic_bc_death),]$post_bc_death_treatment_OR <- data[grep("OR", data$treatment_stratified_postdiagnostic_bc_death),]$treatment_stratified_postdiagnostic_bc_death
data[grep("HR", data$treatment_stratified_postdiagnostic_bc_death),]$post_bc_death_treatment_HR <- data[grep("HR", data$treatment_stratified_postdiagnostic_bc_death),]$treatment_stratified_postdiagnostic_bc_death
data <- data[, c(1:82, 99, 100, 83:98)]
#split unadjusted postdiagnostic ac death into RR, OR and HR
data$unadj_post_ac_death_RR <- NA
data$unadj_post_ac_death_OR <- NA
data$unadj_post_ac_death_HR <- NA
data[grep("RR", data$unadjusted_postdiagnostic_allcause_death),]$unadj_post_ac_death_RR <- data[grep("RR", data$unadjusted_postdiagnostic_allcause_death),]$unadjusted_postdiagnostic_allcause_death
data[grep("OR", data$unadjusted_postdiagnostic_allcause_death),]$unadj_post_ac_death_OR <- data[grep("OR", data$unadjusted_postdiagnostic_allcause_death),]$unadjusted_postdiagnostic_allcause_death
data[grep("HR", data$unadjusted_postdiagnostic_allcause_death),]$unadj_post_ac_death_HR <- data[grep("HR", data$unadjusted_postdiagnostic_allcause_death),]$unadjusted_postdiagnostic_allcause_death
data <- data[, c(1:87, 101, 102, 103, 88:100)]
#split adjusted postdiagnostic ac death into RR, OR, and HR
data$adj_post_ac_death_RR <- NA
data$adj_post_ac_death_OR <- NA
data$adj_post_ac_death_HR <- NA
data[grep("RR", data$adjusted_postdiagnostic_allcause_death),]$adj_post_ac_death_RR <- data[grep("RR", data$adjusted_postdiagnostic_allcause_death),]$adjusted_postdiagnostic_allcause_death
data[grep("OR", data$adjusted_postdiagnostic_allcause_death),]$adj_post_ac_death_OR <- data[grep("OR", data$adjusted_postdiagnostic_allcause_death),]$adjusted_postdiagnostic_allcause_death
data[grep("HR", data$adjusted_postdiagnostic_allcause_death),]$adj_post_ac_death_HR <- data[grep("HR", data$adjusted_postdiagnostic_allcause_death),]$adjusted_postdiagnostic_allcause_death
data <- data[, c(1:91, 104, 105, 106, 92:103)]
#split stratified postdiagnostic ac death into OR and HR
data$strat_post_ac_death_OR <- NA
data$strat_post_ac_death_HR <- NA
data[grep("OR", data$stratified_postdiagnostic_allcause_death),]$strat_post_ac_death_OR <- data[grep("OR", data$stratified_postdiagnostic_allcause_death),]$stratified_postdiagnostic_allcause_death
data[grep("HR", data$stratified_postdiagnostic_allcause_death),]$strat_post_ac_death_HR <- data[grep("HR", data$stratified_postdiagnostic_allcause_death),]$stratified_postdiagnostic_allcause_death
data <- data[, c(1:95, 107, 108, 96:106)]
#split unadjusted postdiagnostic recurrence into RR and HR
data$post_rec_unadj_RR <- NA
data$post_rec_unadj_HR <- NA
data[grep("RR", data$unadjusted_postdiagnostic_recurrence),]$post_rec_unadj_RR <- data[grep("RR", data$unadjusted_postdiagnostic_recurrence),]$unadjusted_postdiagnostic_recurrence
data[grep("HR", data$unadjusted_postdiagnostic_recurrence),]$post_rec_unadj_HR <- data[grep("HR", data$unadjusted_postdiagnostic_recurrence),]$unadjusted_postdiagnostic_recurrence
data <- data[, c(1:100, 109, 110, 101:108)]
#split adjusted postdiagnostic recurrence into RR and HR
data$post_rec_adj_RR <- NA
data$post_rec_adj_HR <- NA
data[grep("RR", data$adjusted_postdiagnostic_recurrence),]$post_rec_adj_RR <- data[grep("RR", data$adjusted_postdiagnostic_recurrence),]$adjusted_postdiagnostic_recurrence
data[grep("HR", data$adjusted_postdiagnostic_recurrence),]$post_rec_adj_HR <- data[grep("HR", data$adjusted_postdiagnostic_recurrence),]$adjusted_postdiagnostic_recurrence
data <- data[, c(1:103, 111, 112, 104:110)]
#postdiagnostic stratified recurrence data all given by HR so no need to split
#unadjusted, adjusted and stratified postdiagnostic progression data all given by HR, so no need to split
#split unadjusted bc death OR column into OR and 95% CI columns
data$unadj_pre_bc_death_OR_only <- sapply(data$unadj_pre_bc_death_OR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_pre_bc_death_OR_CI <- sapply(data$unadj_pre_bc_death_OR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data <- data[, c(1:29, 113, 114, 30:112)]
data$unadj_pre_bc_death_OR_CI <- gsub(")", "", data$unadj_pre_bc_death_OR_CI)
#create 2 columns for lower and upper halves of 95% CIs for unadjusted prediagnostic bc deaths OR
data$unadj_pre_bc_death_OR_lower_CI <- sapply(data$unadj_pre_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_bc_death_OR_higher_CI <- sapply(data$unadj_pre_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:31, 115, 116, 32:114)]
#remove all non-numeric characters from unadj_pre_bc_death_OR_only
data$unadj_pre_bc_death_OR_only <- gsub("[^0-9.]", "", data$unadj_pre_bc_death_OR_only)
#split unadjusted bc death HR column into HR and 95% CI columns
data$unadj_pre_bc_death_HR_only <- sapply(data$unadj_pre_bc_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_pre_bc_death_HR_CI <- sapply(data$unadj_pre_bc_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data <- data[, c(1:34, 117, 118, 35:116)]
data$unadj_pre_bc_death_HR_CI <- gsub(")", "", data$unadj_pre_bc_death_HR_CI)
data$unadj_pre_bc_death_HR_CI <- gsub("95% CI", "", data$unadj_pre_bc_death_HR_CI)
data$unadj_pre_bc_death_HR_only <- gsub("[^0-9.]", "", data$unadj_pre_bc_death_HR_only)
#create 2 columns for lower and upper halves of 95% CIs for unadjusted prediagnostic bc deaths HR
data$unadj_pre_bc_death_HR_lower_CI <- sapply(data$unadj_pre_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_bc_death_HR_higher_CI <- sapply(data$unadj_pre_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:36, 119, 120, 37:118)]
#split adjusted prediagnostic bc death into HR and 95% CI columns
#need to first remove Model A stuff from Murray 2014 cell (Model B chosen bc more confounders used in multivariate analysis)
data$adjusted_prediagnostic_bc_death <- gsub("95% CI", "", data$adjusted_prediagnostic_bc_death)
data$adjusted_prediagnostic_bc_death <- gsub("0.92", "", data$adjusted_prediagnostic_bc_death)
data$adjusted_prediagnostic_bc_death <- gsub("0.770", "", data$adjusted_prediagnostic_bc_death)
data$adjusted_prediagnostic_bc_death <- gsub("1.09", "", data$adjusted_prediagnostic_bc_death)
data$adjusted_prediagnostic_bc_death <- gsub("[^0-9.()-]", "", data$adjusted_prediagnostic_bc_death)
#Model A stuff now removed
data$adj_pre_bc_death_HR_only <- sapply(data$adjusted_prediagnostic_bc_death, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$adj_pre_bc_death_HR_CI <- sapply(data$adjusted_prediagnostic_bc_death, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$adj_pre_bc_death_HR_CI <- gsub(")", "", data$adj_pre_bc_death_HR_CI)
data <- data[, c(1:39, 121, 122, 40:120)]
data$adj_pre_bc_death_HR_CI_lower <- sapply(data$adj_pre_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_pre_bc_death_HR_CI_upper <- sapply(data$adj_pre_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:41, 123, 124, 42:122)]
#split prediagnostic bc death data stratified by stage into stage stratified, metastasis stratified and node stratified
#this line splits off node status
data$node_stratified_pre_bc_death <- NA
data[grep("node", data$stage_stratified_prediagnostic_bc_death, ignore.case = TRUE),]$node_stratified_pre_bc_death <- data[grep("node", data$stage_stratified_prediagnostic_bc_death, ignore.case = TRUE),]$stage_stratified_prediagnostic_bc_death
#this line splits off metastasis status
data$metastasis_stratified_pre_bc_death <- NA
data[grep("metastasis", data$stage_stratified_prediagnostic_bc_death, ignore.case = TRUE),]$metastasis_stratified_pre_bc_death <- data[grep("metastasis", data$stage_stratified_prediagnostic_bc_death, ignore.case = TRUE),]$stage_stratified_prediagnostic_bc_death
#this line splits off stage status
data$stage_stratified_pre_bc_death <- NA
data[grep("Stage I", data$stage_stratified_prediagnostic_bc_death),]$stage_stratified_pre_bc_death <- data[grep("Stage I", data$stage_stratified_prediagnostic_bc_death),]$stage_stratified_prediagnostic_bc_death
#rearrange these 3 new columns
#pre_bc_death_stage_OR and pre_bc_death_stage_HR are now redundant so can remove as well
data <- data[, c(1:43, 125, 126, 127, 47:124)]
#clean node_stratified_pre_bc_death
#remove some unnecessary text
data$node_stratified_pre_bc_death <- gsub("Lymph node status data not stage data", "", data$node_stratified_pre_bc_death)
data$node_stratified_pre_bc_death <- gsub("LYMPH NODE DATA NOT STAGE DATA", "", data$node_stratified_pre_bc_death)
#split into two columns
data$node_stratified_pre_bc_death_numbers <- sapply(data$node_stratified_pre_bc_death, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$node_stratified_pre_bc_death_HR <- sapply(data$node_stratified_pre_bc_death, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data <- data[, c(1:44, 125, 126, 45:124)]
#split HRs into several individual columns
data$HR_lymph_node_positive_users_pre_bc_death <- sapply(data$node_stratified_pre_bc_death_HR, function(x) strsplit(x, "/", fixed = TRUE)[[1]][1])
data$placeholder <- sapply(data$node_stratified_pre_bc_death_HR, function(x) strsplit(x, "/", fixed = TRUE)[[1]][2])
data$node_positive_users_pre_bc_death_HR <- sapply(data$HR_lymph_node_positive_users_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$node_positive_users_pre_bc_death_CI <- sapply(data$HR_lymph_node_positive_users_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$node_positive_users_pre_bc_death_HR <- gsub("[^0-9.]", "", data$node_positive_users_pre_bc_death_HR)
data$node_positive_users_pre_bc_death_CI <- gsub(")", "", data$node_positive_users_pre_bc_death_CI)
data$node_positive_users_pre_bc_death_CI_lower <- sapply(data$node_positive_users_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$node_positive_users_pre_bc_death_CI_upper <- sapply(data$node_positive_users_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:46, 129, 130, 131, 132, 47:128)]
data$HR_lymph_node_negative_users_pre_bc_death <- sapply(data$placeholder, function(x) strsplit(x, "=", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$placeholder, function(x) strsplit(x, "=", fixed = TRUE)[[1]][2])
data$node_negative_users_pre_bc_death_HR <- sapply(data$HR_lymph_node_negative_users_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$node_negative_users_pre_bc_death_CI <- sapply(data$HR_lymph_node_negative_users_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$node_negative_users_pre_bc_death_HR <- gsub("[^0-9.]", "", data$node_negative_users_pre_bc_death_HR)
data$node_negative_users_pre_bc_death_CI <- gsub(")", "", data$node_negative_users_pre_bc_death_CI)
data$node_negative_users_pre_bc_death_CI_lower <- sapply(data$node_negative_users_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$node_negative_users_pre_bc_death_CI_upper <- sapply(data$node_negative_users_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:50, 135, 136, 137, 138, 51:134)]
data$HR_nodepos_vs_nodeneg_nonusers_pre_bc_death <- sapply(data$placeholder2, function(x) strsplit(x, "+", fixed = TRUE)[[1]][1])
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "+", fixed = TRUE)[[1]][2])
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_HR <- sapply(data$HR_nodepos_vs_nodeneg_nonusers_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI <- sapply(data$HR_nodepos_vs_nodeneg_nonusers_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_HR <- gsub("[^0-9.]", "", data$nodeneg_vs_nodepos_nonusers_pre_bc_death_HR)
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI <- gsub(")", "", data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI)
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI_lower <- sapply(data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI_upper <- sapply(data$nodeneg_vs_nodepos_nonusers_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:54, 141, 142, 143, 144, 55:140)]
data$HR_nodenegusers_vs_nodeposnonusers_pre_bc_death <- sapply(data$placeholder3, function(x) strsplit(x, "&", fixed = TRUE)[[1]][1])
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death <- sapply(data$placeholder3, function(x) strsplit(x, "&", fixed = TRUE)[[1]][2])
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_HR <- sapply(data$HR_nodenegusers_vs_nodeposnonusers_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI <- sapply(data$HR_nodenegusers_vs_nodeposnonusers_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_HR <- gsub("[^0-9.]", "", data$nodenegusers_vs_nodeposnonusers_pre_bc_death_HR)
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI <- gsub(")", "", data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI)
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI_lower <- sapply(data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI_upper <- sapply(data$nodenegusers_vs_nodeposnonusers_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:58, 147, 148, 149, 150, 59:146)]
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_rHR <- sapply(data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI <- sapply(data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_rHR <- gsub("[^0-9.]", "", data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_rHR)
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI <- gsub(")", "", data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI)
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI_lower <- sapply(data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI_upper <- sapply(data$multiplicative_rHR_aspirin_nodestatus_pre_bc_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:62, 151, 152, 153, 154, 63:150)]
#remove unwanted columns generated during cleaning of node stratified pre bc death
data <- data[, c(1:146)]
#pre bc death stratified by metastasis, treatment, bmi and stage stratified have only 1 data point so no point cleaning
#appears to be no direct comparison to be made btwn the 2 in tum mol char as well so will leave that too
#leave pre bc death strat by aspirin dose for now- unclear if direct comparisons can be drawn
#presumably no point cleaning pre ac mortality unadjusted OR column bc only 1 value?
#clean pre ac mortality unadjusted HR column
data$unadj_pre_ac_death_HR_only <- NA
data$unadj_pre_ac_death_CI <- NA
data$unadj_pre_ac_death_HR_only <- sapply(data$unadj_pre_ac_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_CI <- sapply(data$unadj_pre_ac_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_CI_lower <- sapply(data$unadj_pre_ac_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_CI_upper <- sapply(data$unadj_pre_ac_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_CI <- gsub("95% CI", "", data$unadj_pre_ac_death_CI)
data$unadj_pre_ac_death_CI_upper <- gsub("95% CI", "", data$unadj_pre_ac_death_CI_upper)
data$unadj_pre_ac_death_CI_lower <- gsub("95% CI", "", data$unadj_pre_ac_death_CI_lower)
data$unadj_pre_ac_death_CI <- gsub(")", "", data$unadj_pre_ac_death_CI)
data$unadj_pre_ac_death_CI_upper <- gsub(")", "", data$unadj_pre_ac_death_CI_upper)
data$unadj_pre_ac_death_HR_only <- gsub("[^0-9.()-]", "", data$unadj_pre_ac_death_HR_only)
data <- data[, c(1:79, 147, 148, 149, 150, 80:146)]
#split adjusted prediagnostic ac death into HR and CI columns
data$adj_pre_ac_death_HR <- NA
data$adj_pre_ac_death_CI <- NA
data$adj_pre_ac_death_HR <- sapply(data$adjusted_prediagnostic_allcause_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$adj_pre_ac_death_CI <- sapply(data$adjusted_prediagnostic_allcause_death, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$adj_pre_ac_death_HR <- gsub("[^0-9.()-]", "", data$adj_pre_ac_death_HR)
data$adj_pre_ac_death_CI <- gsub("; this is based off 74 aspirin users before and 74 users after diagnosis", "", data$adj_pre_ac_death_CI)
data$adj_pre_ac_death_CI <- gsub(")", "", data$adj_pre_ac_death_CI)
data$adj_pre_ac_death_CI_lower <- sapply(data$adj_pre_ac_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_pre_ac_death_CI_upper <- sapply(data$adj_pre_ac_death_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:84, 151, 152, 153, 154, 85:150)]
#again doesn't appear that a direct comparison can be made for stratified pre ac death so move on without cleaning 
#add an OR column to prediagnostic unadjusted recurrence because didn't in first set of code
data$pre_rec_unadj_OR <- NA
data[grep("OR", data$unadjusted_prediagnostic_recurrence),]$pre_rec_unadj_OR <- data[grep("OR", data$unadjusted_prediagnostic_recurrence),]$unadjusted_prediagnostic_recurrence
data <- data[, c(1:92, 155, 93:154)]
#only one data point for RR and OR in unadjusted prediagnostic recurrence, so no point cleaning
#clean HR unadjusted prediagnostic recurrence column
data$unadj_pre_rec_HR_only <- NA
data$unadj_pre_rec_HR_CI <- NA
data$unadj_pre_rec_HR_only <- sapply(data$pre_rec_unadj_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_HR_CI <- sapply(data$pre_rec_unadj_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_HR_only <- gsub("[^0-9.()-]", "", data$unadj_pre_rec_HR_only)
data$unadj_pre_rec_CI_lower <- sapply(data$unadj_pre_rec_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_CI_upper <- sapply(data$unadj_pre_rec_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_HR_CI <- gsub("), although P was 0.27", "", data$unadj_pre_rec_HR_CI)
data$unadj_pre_rec_HR_CI <- gsub("Any aspirin use", "", data$unadj_pre_rec_HR_CI)
data$unadj_pre_rec_CI_upper <- gsub("[^0-9.()-]", "", data$unadj_pre_rec_CI_upper)
data$unadj_pre_rec_CI_upper <- gsub("0.27", "", data$unadj_pre_rec_CI_upper)
data$unadj_pre_rec_HR_CI <- gsub(")", "", data$unadj_pre_rec_HR_CI)
data$unadj_pre_rec_CI_upper <- gsub(")", "", data$unadj_pre_rec_CI_upper)
data <- data[, c(1:95, 156, 157, 158, 159, 96:155)]
#only one data point in adjusted prediagnostic recurrence RR so no need to clean
#clean adjusted prediagnostic recurrence HR
#for Cronin-Fenton 2016 I'm choosing to keep prediagnostic only data and not ever use bc it is a direct comparison to other data point
data$adj_pre_rec_HR_only <- NA
data$adj_pre_rec_HR_CI <- NA
data$adj_pre_rec_HR_only <- sapply(data$pre_rec_adj_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$adj_pre_rec_HR_CI <- sapply(data$pre_rec_adj_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$adj_pre_rec_HR_CI <- gsub("[^0-9.()-]", "", data$adj_pre_rec_HR_CI)
data$adj_pre_rec_HR_only <- gsub("[^0-9.()-]", "", data$adj_pre_rec_HR_only)
data$adj_pre_rec_HR_CI <- gsub(")", "", data$adj_pre_rec_HR_CI)
data$adj_pre_rec__HR_CI_lower <- sapply(data$adj_pre_rec_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_pre_rec__HR_CI_upper <- sapply(data$adj_pre_rec_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:102, 160, 161, 162, 163, 103:159)]
#only one data point in stratified prediagnostic recurrence so no point cleaning
#only one data point in unadjusted prediagnostic progression so no point cleaning
#clean unadjusted postdiagnostic bc death
#no point cleaning RR bc only one data point
#clean unadjusted postdiagnostic bc death OR
data$unadj_post_bc_death_OR_only <- NA
data$unadj_post_bc_death_OR_CI <- NA
data$unadj_post_bc_death_OR_only <- sapply(data$unadj_post_bc_death_OR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_post_bc_death_OR_CI <- sapply(data$unadj_post_bc_death_OR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data$unadj_post_bc_death_OR_only <- gsub("[^0-9.()-]", "", data$unadj_post_bc_death_OR_only)
data$unadj_post_bc_death_OR_CI <- gsub(")", "", data$unadj_post_bc_death_OR_CI)
data$unadj_post_bc_death_OR_CI_lower <- sapply(data$unadj_post_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_post_bc_death_OR_CI_upper <- sapply(data$unadj_post_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:115, 164, 165, 166, 167, 116:163)]
#clean unadjusted postdiagnostic death HR
#in Frisk 2018 I am choosing to include the data for aspirin use at any point in followup and not just 3-9 months post-diagnosis
#in Blair 2007 I am choosing to include the data for just aspirin use instead of aspirin and NSAID use
#in McMenamin 2017 I am choosing to use the 6-month lagged data instead of the 1-year lagged data
data$unadj_post_bc_death_HR_2 <- sapply(data$unadj_post_bc_death_HR, function(x) strsplit(x, ",", fixed = TRUE)[[1]][1])
data$placeholder <- sapply(data$unadj_post_bc_death_HR, function(x) strsplit(x, ",", fixed = TRUE)[[1]][2])
data <- data[, c(1:168)]
data$unadj_post_bc_death_HR_only <- NA
data$unadj_post_bc_death_HR_CI <- NA
data$unadj_post_bc_death_HR_only <- sapply(data$unadj_post_bc_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][1])
data$unadj_post_bc_death_HR_CI <- sapply(data$unadj_post_bc_death_HR, function(x) strsplit(x, " (", fixed = TRUE)[[1]][2])
data <- data[, c(1:167, 169, 170)]
data$unadj_post_bc_death_HR_only <- gsub("[^0-9.()-]", "", data$unadj_post_bc_death_HR_only)
data$unadj_post_bc_death_HR_CI <- sapply(data$unadj_post_bc_death_HR_CI, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$unadj_post_bc_death_HR_CI <- gsub("[^0-9.()-]", "", data$unadj_post_bc_death_HR_CI)
data$unadj_post_bc_death_HR_CI_lower <- sapply(data$unadj_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_post_bc_death_HR_CI_upper <- sapply(data$unadj_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:120, 168, 169, 170, 171, 121:167)]
#clean adjusted postdiagnostic bc death RR
#for Holmes 2011 I am choosing to include the full multivariate data
#for Holmes 2013 I am choosing to including only the multivariate data including aspirin use only
#for Holmes 2010 I am choosing to include the data which used marginal structural models
data$placeholder <- sapply(data$adj_post_bc_death_RR, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$adj_post_bc_death_RR_only <- sapply(data$adj_post_bc_death_RR, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$adj_post_bc_death_RR_only <- sapply(data$adj_post_bc_death_RR_only, function(x) strsplit(x, "+", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$adj_post_bc_death_RR_only, function(x) strsplit(x, "+", fixed = TRUE)[[1]][2])
data <- data[, c(1:171, 173)]
data$adj_postdiagnostic_bc_death_RR_only <- sapply(data$adj_post_bc_death_RR_only, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$adj_post_bc_death_RR_CI <- sapply(data$adj_post_bc_death_RR_only, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data <- data[, c(1:171, 173, 174)]
names(data)[172] <- "adj_post_bc_death_RR_only"
data$adj_post_bc_death_RR_only <- gsub("[^0-9.()-]", "", data$adj_post_bc_death_RR_only)
data$adj_post_bc_death_RR_CI <- gsub(")", "", data$adj_post_bc_death_RR_CI)
data$adj_post_bc_death_RR_CI_lower <- sapply(data$adj_post_bc_death_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_post_bc_death_RR_CI_upper <- sapply(data$adj_post_bc_death_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:126, 172, 173, 174, 175, 127:171)]
#no point cleaning adjusted postdiagnostic bc death OR as only one data point
#next bit is a slight detour while I figured something out
#clean cohort_size column
#split into numbers and deaths etc.
#this line creates an identical column to cohort size which I manipulate to get numbers only
data$cohort_size_number_only <- data$cohort_size
#these lines create new columns for all the data types in cohort_size
data$cohort_size_person_years <- NA
data[grep("person", data$cohort_size, ignore.case = TRUE),]$cohort_size_person_years <- data[grep("person", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$total_bc_deaths <- NA
data[grep("breast", data$cohort_size, ignore.case = TRUE),]$total_bc_deaths <- data[grep("breast", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$total_ac_deaths <- NA
data[grep("all", data$cohort_size, ignore.case = TRUE),]$total_ac_deaths <- data[grep("all", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$total_recurrences <- NA
data[grep("recur", data$cohort_size, ignore.case = TRUE),]$total_recurrences <- data[grep("recur", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$total_metastases <- NA
data[grep("metas", data$cohort_size, ignore.case = TRUE),]$total_metastases <- data[grep("metas", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$prediagnostic_only_numbers <- NA
data[grep("pre", data$cohort_size, ignore.case = TRUE),]$prediagnostic_only_numbers <- data[grep("pre", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$stage_I_to_III_numbers_only <- NA
data[grep("stage", data$cohort_size, ignore.case = TRUE),]$stage_I_to_III_numbers_only <- data[grep("stage", data$cohort_size, ignore.case = TRUE),]$cohort_size
data$stage_IV_numbers_only <- data$stage_I_to_III_numbers_only
#clean these new columns
#clean cohort_size_numbers_only
#note for the total cohort size here I am including number of breast cancer patients in the study and not just total number of patients
data$cohort_size_number_only <- gsub("including 292", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("[^0-9]", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("16613032", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("45139341400341732", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("63308", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("1802815", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("544848", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("473", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("10319", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("17825", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("77565547", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("139896", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("333", "", data$cohort_size_number_only)
#for McMenamin 2014 I am using the post-diagnosis number as this is the total cohort size as indicated in the paper
data$cohort_size_number_only <- gsub("12231", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("2331305325", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("21414621", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("79159", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("270", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("71328991", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("237597", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("18073351153", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("83120", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("463163", "", data$cohort_size_number_only)
data$cohort_size_number_only <- gsub("16095", "", data$cohort_size_number_only)
#clean person years column
data$cohort_size_person_years <- gsub("[^0-9]", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("4164", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("341400341732", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("34188", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("5325", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("2925", "", data$cohort_size_person_years)
data$cohort_size_person_years <- gsub("351153", "", data$cohort_size_person_years)
#clean total bc deaths column 
data$total_bc_deaths <- gsub("48 distant", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("[^0-9]", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("27424", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("3032", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("416445139", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("400341732", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("46271802", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("22254", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("2001", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("4661", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("1398964552", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("591", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("159", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("1442", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("597", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("292518073351", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("1113", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("120", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("3058463", "", data$total_bc_deaths)
data$total_bc_deaths <- gsub("1024160", "", data$total_bc_deaths)
#clean total ac deaths column
data$total_ac_deaths <- gsub("[^0-9]", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("274241661", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("416445139341400341", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("4627", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("815", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("222", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("4848", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("59179", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("1442237", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("292518073", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("153", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("111383", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("163", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("3058", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("1024", "", data$total_ac_deaths)
data$total_ac_deaths <- gsub("95", "", data$total_ac_deaths)
#clean total recurrence column
data$total_recurrences <- gsub("[^0-9]", "", data$total_recurrences)
data$total_recurrences <- gsub("416445139341", "", data$total_recurrences)
data$total_recurrences <- gsub("341732", "", data$total_recurrences)
data$total_recurrences <- gsub("34188233130", "", data$total_recurrences)
data$total_recurrences <- gsub("2292", "", data$total_recurrences)
#clean total metastases column 
data$total_metastases <- gsub("[^0-9]", "", data$total_metastases)
data$total_metastases <- gsub("2225448", "", data$total_metastases)
#clean prediagnostic only numbers column
data$prediagnostic_only_numbers <- gsub("[^0-9]", "", data$prediagnostic_only_numbers)
data$prediagnostic_only_numbers <- gsub("15140", "", data$prediagnostic_only_numbers)
#clean stage I-III and IV columns 
data$stage_I_to_III_numbers_only <- gsub("[^0-9]", "", data$stage_I_to_III_numbers_only)
data$stage_I_to_III_numbers_only <- gsub("62122035", "", data$stage_I_to_III_numbers_only)
data$stage_IV_numbers_only <- gsub("[^0-9]", "", data$stage_IV_numbers_only)
data$stage_IV_numbers_only <- gsub("21414", "", data$stage_IV_numbers_only)
data$stage_IV_numbers_only <- gsub("22035", "", data$stage_IV_numbers_only)
#rearrange dataset so these columns are next to the 'cohort_size' column 
data <- data[, c(1:6, 176:184, 7:175)]
#clean control group column 
#split into new columns again
data$controls_numbers_only <- data$control_group
data$controls_person_years <- NA
data[grep("person", data$control_group, ignore.case = TRUE),]$controls_person_years <- data[grep("person", data$control_group, ignore.case = TRUE),]$control_group
#this next column is needed because in one study only NSAID use/nonuse is listed and not aspirin use/nonuse
data$controls_NSAID_data_only <- NA
data[grep("NSAID nonusers", data$control_group, ignore.case = TRUE),]$controls_NSAID_data_only <- data[grep("NSAID nonusers", data$control_group, ignore.case = TRUE),]$control_group
data$controls_prediagnostic_only <- NA
data[grep("prediagnostic", data$control_group, ignore.case = TRUE),]$controls_prediagnostic_only <- data[grep("prediagnostic", data$control_group, ignore.case = TRUE),]$control_group
data$controls_postdiagnostic_only <- NA
data[grep("postdiagnostic", data$control_group, ignore.case = TRUE),]$controls_postdiagnostic_only <- data[grep("postdiagnostic", data$control_group, ignore.case = TRUE),]$control_group
data$controls_for_ac_deaths_only <- NA
data[grep("ac", data$control_group, ignore.case = TRUE),]$controls_for_ac_deaths_only <- data[grep("ac", data$control_group, ignore.case = TRUE),]$control_group
data$controls_for_bc_deaths_only <- data$controls_for_ac_deaths_only
data$controls_stage_I_to_III_only <- NA
data[grep("stage", data$control_group, ignore.case = TRUE),]$controls_stage_I_to_III_only <- data[grep("stage", data$control_group, ignore.case = TRUE),]$control_group
data$controls_stage_IV_only <- data$controls_stage_I_to_III_only
data$bc_deaths_in_controls <- NA
data[grep("breast cancer deaths", data$control_group, ignore.case = TRUE),]$bc_deaths_in_controls <- data[grep("breast cancer deaths", data$control_group, ignore.case = TRUE),]$control_group
data$ac_deaths_in_controls <- NA
data[grep("overall", data$control_group, ignore.case = TRUE),]$ac_deaths_in_controls <- data[grep("overall", data$control_group, ignore.case = TRUE),]$control_group
data$recurrences_in_controls <- NA
data[grep("recur", data$control_group, ignore.case = TRUE),]$recurrences_in_controls <- data[grep("recur", data$control_group, ignore.case = TRUE),]$control_group
#clean new columns 
#clean controls_numbers_only
#For Shiao 2017 I am choosing to use the no aspirin use number rather than the no antiplatelet use number
data$controls_numbers_only <- gsub("157 in no", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("[^0-9]", "", data$controls_numbers_only)
#for Holmes 2014 I am choosing to use Period A data as it is labelled in the paper as 'baseline'
data$controls_numbers_only <- gsub("393042126242293276060", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("36304233332233322", "", data$controls_numbers_only)
#I am choosing to use the 7380 number for Rothwell to reflect the number I chose to take from the cohort size column
data$controls_numbers_only <- gsub("17108172540638167539", "", data$controls_numbers_only)
#I am choosing to use the 2626 number for Loomans-Kropp et al. for the same reason as stated for Rothwell
data$controls_numbers_only <- gsub("7166512", "", data$controls_numbers_only)
#for McMenamin 2014 I am using the post-diagnosis number as this is the total cohort size as indicated in the paper
data$controls_numbers_only <- gsub("344521026432771", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("2080144814", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("18331521", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("30201018451221624", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("56971856733", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("1000888", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("6791", "", data$controls_numbers_only)
data$controls_numbers_only <- gsub("1095", "", data$controls_numbers_only)
#clean controls person years column
data$controls_person_years <- gsub("[^0-9]", "", data$controls_person_years)
data$controls_person_years <- gsub("12786", "", data$controls_person_years)
data$controls_person_years <- gsub("1026432771", "", data$controls_person_years)
data$controls_person_years <- gsub("27386", "", data$controls_person_years)
data$controls_person_years <- gsub("4814", "", data$controls_person_years)
data$controls_person_years <- gsub("302010", "", data$controls_person_years)
data$controls_person_years <- gsub("1221624", "", data$controls_person_years)
data$controls_person_years <- gsub("1651", "", data$controls_person_years)
data$controls_person_years <- gsub("88", "", data$controls_person_years)
#clean NSAID only data column
data$controls_NSAID_data_only <- gsub("[^0-9]", "", data$controls_NSAID_data_only)
#clean controls prediagnostic only column
data$controls_prediagnostic_only <- gsub("[^0-9]", "", data$controls_prediagnostic_only)
data$controls_prediagnostic_only <- gsub("1278634452", "", data$controls_prediagnostic_only)
data$controls_prediagnostic_only <- gsub("32771", "", data$controls_prediagnostic_only)
data$controls_prediagnostic_only <- gsub("1000888", "", data$controls_prediagnostic_only)
#clean controls postdiagnostic only column
data$controls_postdiagnostic_only <- gsub("[^0-9]", "", data$controls_postdiagnostic_only)
data$controls_postdiagnostic_only <- gsub("344521026432771", "", data$controls_postdiagnostic_only)
#clean controls for ac deaths column
data$controls_for_ac_deaths_only <- gsub("[^0-9]", "", data$controls_for_ac_deaths_only)
data$controls_for_ac_deaths_only <- gsub("5697185", "", data$controls_for_ac_deaths_only)
#clean controls for bc deaths column
data$controls_for_bc_deaths_only <- gsub("[^0-9]", "", data$controls_for_bc_deaths_only)
data$controls_for_bc_deaths_only <- gsub("1856733", "", data$controls_for_bc_deaths_only)
#clean stage I-III and stage IV columns
data$controls_stage_I_to_III_only<- gsub("[^0-9]", "", data$controls_stage_I_to_III_only)
data$controls_stage_I_to_III_only<- gsub("52118852", "", data$controls_stage_I_to_III_only)
data$controls_stage_IV_only<- gsub("[^0-9]", "", data$controls_stage_IV_only)
data$controls_stage_IV_only<- gsub("18331", "", data$controls_stage_IV_only)
data$controls_stage_IV_only<- gsub("18852", "", data$controls_stage_IV_only)
#clean bc deaths in controls column
data$bc_deaths_in_controls <- gsub("[^0-9]", "", data$bc_deaths_in_controls)
data$bc_deaths_in_controls <- gsub("165110008", "", data$bc_deaths_in_controls)
data$bc_deaths_in_controls <- gsub("944", "", data$bc_deaths_in_controls)
data$bc_deaths_in_controls <- gsub("91", "", data$bc_deaths_in_controls)	
#clean ac deaths in controls column
data$ac_deaths_in_controls <- gsub("[^0-9]", "", data$ac_deaths_in_controls)
data$ac_deaths_in_controls <- gsub("94467", "", data$ac_deaths_in_controls)
#clean recurrences in controls column
data$recurrences_in_controls <- gsub("[^0-9]", "", data$recurrences_in_controls)
data$recurrences_in_controls <- gsub("27386208014", "", data$recurrences_in_controls)
#rearrange
data <- data[, c(1:16, 185:196, 17:184)]
#clean exposed column 
#split into multiple columns again
data$cases_or_exposed_numbers <- data$exposed_group
data$exposed_person_years <- NA
data[grep("person", data$exposed_group, ignore.case = TRUE),]$exposed_person_years <- data[grep("person", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_bc_deaths <- NA
data[grep("breast cancer death", data$exposed_group, ignore.case = TRUE),]$exposed_bc_deaths <- data[grep("breast cancer death", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$bc_deaths_cases <- NA
data[grep("18.3", data$exposed_group, ignore.case = TRUE),]$bc_deaths_cases <- data[grep("18.3", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_ac_deaths <- NA
data[grep("overall", data$exposed_group, ignore.case = TRUE),]$exposed_ac_deaths <- data[grep("overall", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$ac_deaths_cases <- data$bc_deaths_cases
data$exposed_recurrences <- NA
data[grep("recur", data$exposed_group, ignore.case = TRUE),]$exposed_recurrences <- data[grep("recur", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_1_day_pw_use_person_years <- NA
data[grep("6-7", data$exposed_group, ignore.case = TRUE),]$exposed_1_day_pw_use_person_years <- data[grep("6-7", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_2to5_days_pw_use_person_years <- data$exposed_1_day_pw_use_person_years
data$exposed_6to7_days_pw_use_person_years <- data$exposed_1_day_pw_use_person_years
data$exposed_81mg_users <- NA
data[grep("81mg", data$exposed_group, ignore.case = TRUE),]$exposed_81mg_users <- data[grep("81mg", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_325mg_users <- data$exposed_81mg_users
data$exposed_prediagnostic_use <- NA
data[grep("prediagn", data$exposed_group, ignore.case = TRUE),]$exposed_prediagnostic_use <- data[grep("prediagn", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_postdiagnostic_use<- NA
data[grep("postdiagn", data$exposed_group, ignore.case = TRUE),]$exposed_postdiagnostic_use <- data[grep("postdiagn", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_pre_and_postdiagnostic_use <- NA
data[grep("&", data$exposed_group, ignore.case = TRUE),]$exposed_pre_and_postdiagnostic_use <- data[grep("&", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_NSAID_users_number <- NA
data[grep("NSAID use", data$exposed_group, ignore.case = TRUE),]$exposed_NSAID_users_number <- data[grep("NSAID use", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_NSAID_users_person_years <- NA
data[grep("women reported aspirin", data$exposed_group, ignore.case = TRUE),]$exposed_NSAID_users_person_years <- data[grep("women reported aspirin", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_lessthan_3_times_pw_use <- NA
data[grep("<3", data$exposed_group, ignore.case = TRUE),]$exposed_lessthan_3_times_pw_use <- data[grep("<3", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_morethan_3_times_pw_use <- data$exposed_lessthan_3_times_pw_use
data$exposed_stage_I_to_III_only <- NA
data[grep("Stage IV", data$exposed_group, ignore.case = TRUE),]$exposed_stage_I_to_III_only <- data[grep("Stage IV", data$exposed_group, ignore.case = TRUE),]$exposed_group
data$exposed_stage_IV_only <- data$exposed_stage_I_to_III_only
#clean these new columns
#clean the cases or exposed numbers column
#for Shiao 2017 I am again choosing to use the no aspirin use number rather than the no antiplatelet use number
data$cases_or_exposed_numbers <- gsub("65 in antiplatelet", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("5 of", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("108 took", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("238 in", "", data$cases_or_exposed_numbers)
#for Barron 2014 I am using the de novo number as this adds up to give the full cohort (with the controls number)
data$cases_or_exposed_numbers <- gsub("400 de", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("[^0-9]", "", data$cases_or_exposed_numbers)
#for Holmes 2014 I am again choosing to use the 'baseline' Period A data. 
data$cases_or_exposed_numbers <- gsub("391521126121193138060", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("36152133166131661", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("17450492114902251141667", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("12181625633232512182", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("74745", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("2095624736821035", "", data$cases_or_exposed_numbers)
#I am choosing to use the 9919 number for Rothwell to reflect the number I chose to take from the cohort size column
data$cases_or_exposed_numbers <- gsub("342916322545638167542", "", data$cases_or_exposed_numbers)
#I am choosing to use the 1926 number for Loomans-Kropp et al. for the same reason as stated for Rothwell
data$cases_or_exposed_numbers <- gsub("6823112", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("25383127704284631156", "", data$cases_or_exposed_numbers)
#for McMenamin 2014 I am using the post-diagnosis number as this is the total cohort size as indicated in the paper
data$cases_or_exposed_numbers <- gsub("682119675652", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("25116511", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("266039281339409110039", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("704327465428851769", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("148207", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("14351832258", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("806565", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("7961490712", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("1326", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("38689", "", data$cases_or_exposed_numbers)
data$cases_or_exposed_numbers <- gsub("2760", "", data$cases_or_exposed_numbers)
#clean exposed person years column
data$exposed_person_years <- gsub("511 recurrences", "", data$exposed_person_years)
data$exposed_person_years <- gsub("65 breast", "", data$exposed_person_years)
data$exposed_person_years <- gsub("[^0-9]", "", data$exposed_person_years)
data$exposed_person_years <- gsub("17450492114902251141667", "", data$exposed_person_years)
data$exposed_person_years <- gsub("2354", "", data$exposed_person_years)
data$exposed_person_years <- gsub("19675652", "", data$exposed_person_years)
data$exposed_person_years <- gsub("6802", "", data$exposed_person_years)
#For Blair 2007 I am using the aspirin only number instead of the combined aspirin and NSAID number
data$exposed_person_years <- gsub("7043274654", "", data$exposed_person_years)
data$exposed_person_years <- gsub("1769", "", data$exposed_person_years)
data$exposed_person_years <- gsub("1274", "", data$exposed_person_years)
#clean exposed bc deaths column 
data$exposed_bc_deaths <- gsub("[^0-9]", "", data$exposed_bc_deaths)
data$exposed_bc_deaths <- gsub("12748065", "", data$exposed_bc_deaths)
data$exposed_bc_deaths <- gsub("7961490712169", "", data$exposed_bc_deaths)
data$exposed_bc_deaths <- gsub("26", "", data$exposed_bc_deaths)
#clean bc deaths cases column
data$bc_deaths_cases <- gsub("[^0-9]", "", data$bc_deaths_cases)
data$bc_deaths_cases <- gsub("1832258", "", data$bc_deaths_cases)
#clean exposed ac deaths column 
data$exposed_ac_deaths <- gsub("[^0-9]", "", data$exposed_ac_deaths)
data$exposed_ac_deaths <- gsub("796149071216913", "", data$exposed_ac_deaths)
#clean ac deaths cases column 
data$ac_deaths_cases <- gsub("[^0-9]", "", data$ac_deaths_cases)
data$ac_deaths_cases <- gsub("1435183", "", data$ac_deaths_cases)
#clean exposed recurrences column 
data$exposed_recurrences <- gsub("[^0-9]", "", data$exposed_recurrences)
data$exposed_recurrences <- gsub("680225116", "", data$exposed_recurrences)
#clean exposed 1 day, 2-5 days and 6-7 days pw use columns
data$exposed_1_day_pw_use_person_years <- gsub("[^0-9]", "", data$exposed_1_day_pw_use_person_years)
data$exposed_1_day_pw_use_person_years <- gsub("17450", "", data$exposed_1_day_pw_use_person_years)
data$exposed_1_day_pw_use_person_years <- gsub("1490225114166738689", "", data$exposed_1_day_pw_use_person_years)
data$exposed_2to5_days_pw_use_person_years <- gsub("[^0-9]", "", data$exposed_2to5_days_pw_use_person_years)
data$exposed_2to5_days_pw_use_person_years <- gsub("1745049211", "", data$exposed_2to5_days_pw_use_person_years)
data$exposed_2to5_days_pw_use_person_years <- gsub("25114166738689", "", data$exposed_2to5_days_pw_use_person_years)
data$exposed_6to7_days_pw_use_person_years <- gsub("[^0-9]", "", data$exposed_6to7_days_pw_use_person_years)
data$exposed_6to7_days_pw_use_person_years <- gsub("1745049211490225", "", data$exposed_6to7_days_pw_use_person_years)
data$exposed_6to7_days_pw_use_person_years <- gsub("6738689", "", data$exposed_6to7_days_pw_use_person_years)
#clean exposed 81mg and 325mg use columns
data$exposed_81mg_users <- gsub("[^0-9]", "", data$exposed_81mg_users)
data$exposed_81mg_users <- gsub("8162563323251218215374745", "", data$exposed_81mg_users)
data$exposed_325mg_users <- gsub("[^0-9]", "", data$exposed_325mg_users)
data$exposed_325mg_users <- gsub("1218162563", "", data$exposed_325mg_users)
data$exposed_325mg_users <- gsub("3251218215374745", "", data$exposed_325mg_users)
#clean exposed prediagnostic use column 
data$exposed_prediagnostic_use <- gsub("[^0-9]", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("209562473", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("10351244", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("23546821", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("5652", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("2660392813394091100394191", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("806565", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("400", "", data$exposed_prediagnostic_use)
data$exposed_prediagnostic_use <- gsub("614907121691326", "", data$exposed_prediagnostic_use)
#clean exposed postdiagnostic use column
data$exposed_postdiagnostic_use <- gsub("[^0-9]", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("12181625633232512182153", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("745", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("209562473682", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("1244", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("682119675652", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("266039", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("3940911003941912760", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("355", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("207", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("740", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("79614", "", data$exposed_postdiagnostic_use)
data$exposed_postdiagnostic_use <- gsub("7121691326", "", data$exposed_postdiagnostic_use)
#clean pre and postdiagnostic use column 
data$exposed_pre_and_postdiagnostic_use <- gsub("[^0-9]", "", data$exposed_pre_and_postdiagnostic_use)
data$exposed_pre_and_postdiagnostic_use <- gsub("12181625633232512182153", "", data$exposed_pre_and_postdiagnostic_use)
data$exposed_pre_and_postdiagnostic_use <- gsub("745", "", data$exposed_pre_and_postdiagnostic_use)
data$exposed_pre_and_postdiagnostic_use <- gsub("209562", "", data$exposed_pre_and_postdiagnostic_use)
data$exposed_pre_and_postdiagnostic_use <- gsub("68210351244", "", data$exposed_pre_and_postdiagnostic_use)
data$exposed_pre_and_postdiagnostic_use <- gsub("355148", "", data$exposed_pre_and_postdiagnostic_use)
#clean exposed NSAID number and person year columns
data$exposed_NSAID_users_number <- gsub("[^0-9]", "", data$exposed_NSAID_users_number)
data$exposed_NSAID_users_person_years <- gsub("[^0-9]", "", data$exposed_NSAID_users_person_years)
data$exposed_NSAID_users_person_years <- gsub("70432746542885", "", data$exposed_NSAID_users_person_years)
#clean exposed less than and more than 3 times pw columns
data$exposed_lessthan_3_times_pw_use <- gsub("[^0-9]", "", data$exposed_lessthan_3_times_pw_use)
data$exposed_lessthan_3_times_pw_use <- gsub("6823112192625385312770428463", "", data$exposed_lessthan_3_times_pw_use)
data$exposed_morethan_3_times_pw_use <- gsub("[^0-9]", "", data$exposed_morethan_3_times_pw_use)
data$exposed_morethan_3_times_pw_use <- gsub("6823112192625385312", "", data$exposed_morethan_3_times_pw_use)
data$exposed_morethan_3_times_pw_use <- gsub("4284631156", "", data$exposed_morethan_3_times_pw_use)
#clean exposed stage I to III and stage IV columns
data$exposed_stage_I_to_III_only <- gsub("[^0-9]", "", data$exposed_stage_I_to_III_only)
data$exposed_stage_I_to_III_only <- gsub("266039281339", "", data$exposed_stage_I_to_III_only)
data$exposed_stage_I_to_III_only <- gsub("1003941912760", "", data$exposed_stage_I_to_III_only)
data$exposed_stage_IV_only <- gsub("[^0-9]", "", data$exposed_stage_IV_only)
data$exposed_stage_IV_only <- gsub("2660392813394091", "", data$exposed_stage_IV_only)
data$exposed_stage_IV_only <- gsub("3941912760", "", data$exposed_stage_IV_only)
#rearrange
data <- data[, c(1:29, 197:217, 30:196)]
#detour over
#clean adjusted postdiagnostic bc death HR
#for Wernli 2011 I am choosing to include the Model B data as it adjusts for more confounders
#for Blair 2007 I am choosing to include data for aspirin only and not aspirin and other NSAIDs
#for Frisk 2018 I am choosing to include Model B data for aspirin use at any point in followup
#for McMenamin 2017 I am choosing to include 6-month lagged data instead of 1-year lagged data
#for Holmes 2014 I am choosing to use the Period E data as it covers most of followup without getting too close to the patient's death. I am also using the >75% use of aspirin, but will save the other categories in a seperate column.
#however for Holmes 2014 I am also saving the Period A data in a seperate column for further analysis.  
#for the Holmes 2014 Period A data I am using the additionally adjusted data
#split off this new Period A column 
data$period_A_postbcdeathHR_lessthan1dailydose <- NA
data[grep("Period", data$adj_post_bc_death_HR, ignore.case = TRUE),]$period_A_postbcdeathHR_lessthan1dailydose <- data[grep("Period", data$adj_post_bc_death_HR, ignore.case = TRUE),]$adj_post_bc_death_HR
data$period_A_post_bc_death_HR_lessthan1dailydose <- sapply(data$period_A_postbcdeathHR_lessthan1dailydose, function(x) strsplit(x, "&", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$period_A_postbcdeathHR_lessthan1dailydose, function(x) strsplit(x, "&", fixed = TRUE)[[1]][2])
data <- data[, c(1:217, 219)]
data$placeholder2 <- sapply(data$period_A_post_bc_death_HR_lessthan1dailydose, function(x) strsplit(x, "since", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_less_than_1daily_dose <- sapply(data$period_A_post_bc_death_HR_lessthan1dailydose, function(x) strsplit(x, "since", fixed = TRUE)[[1]][2])
data$period_A_post_bc_death_HR_less_than_1daily_dose <- gsub("1 daily", "", data$period_A_post_bc_death_HR_less_than_1daily_dose)
data$period_A_post_bc_death_HR_less_than_1_daily_dose <- sapply(data$period_A_post_bc_death_HR_less_than_1daily_dose, function(x) strsplit(x, ",", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_more_than_1_daily_dose <- sapply(data$period_A_post_bc_death_HR_less_than_1daily_dose, function(x) strsplit(x, ",", fixed = TRUE)[[1]][2])
data$period_A_post_bc_death_HR_less_than_1_daily_dose  <- gsub("diagnosis.", "", data$period_A_post_bc_death_HR_less_than_1_daily_dose)
data$period_A_post_bc_death_HR_less_than_1_daily_dose  <- gsub("[^0-9.()-]", "", data$period_A_post_bc_death_HR_less_than_1_daily_dose)
data$period_A_post_bc_death_HR_more_than_1_daily_dose  <- gsub("[^0-9.()-]", "", data$period_A_post_bc_death_HR_more_than_1_daily_dose)
data <- data[, c(1:217, 221, 222)]
data$period_A_post_bc_death_HR_less_than_1_daily_dose_HR_only <- sapply(data$period_A_post_bc_death_HR_less_than_1_daily_dose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI <- sapply(data$period_A_post_bc_death_HR_less_than_1_daily_dose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI  <- gsub(")", "", data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI)
data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI_lower <- sapply(data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI_upper <- sapply(data$period_A_post_bc_death_HR_less_than_1_daily_dose_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$period_A_post_bc_death_HR_more_than_1_daily_dose_HR_only <- sapply(data$period_A_post_bc_death_HR_more_than_1_daily_dose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI <- sapply(data$period_A_post_bc_death_HR_more_than_1_daily_dose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI  <- gsub(")", "", data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI)
data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI_lower <- sapply(data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI_upper <- sapply(data$period_A_post_bc_death_HR_more_than_1_daily_dose_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:217, 220:227)]
data <- data[, c(1:174, 218:225, 175:217)]
#split off the new Period E columns
data$placeholder <- NA
data[grep("Period", data$adj_post_bc_death_HR, ignore.case = TRUE),]$placeholder <- data[grep("Period", data$adj_post_bc_death_HR, ignore.case = TRUE),]$adj_post_bc_death_HR
data$placeholder2 <- sapply(data$placeholder, function(x) strsplit(x, "all when adjusted", fixed = TRUE)[[1]][1])
data$period_E_data <- sapply(data$placeholder, function(x) strsplit(x, "all when adjusted", fixed = TRUE)[[1]][2])
data$periodE_data <- sapply(data$period_E_data, function(x) strsplit(x, "additionally adjusted", fixed = TRUE)[[1]][1])
data$placeholder3 <- sapply(data$period_E_data, function(x) strsplit(x, "additionally adjusted", fixed = TRUE)[[1]][2])
data <- data[, c(1:225, 229)]
data$zero_twentyfive_data_period_E_post_bc_death_HR <- sapply(data$periodE_data, function(x) strsplit(x, ">0-25%,", fixed = TRUE)[[1]][1])
data$placeholder3 <- sapply(data$periodE_data, function(x) strsplit(x, ">0-25%,", fixed = TRUE)[[1]][2])
data$twentyfive_fifty_data_period_E_post_bc_death_HR <- sapply(data$placeholder3, function(x) strsplit(x, ">25-50%,", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder3, function(x) strsplit(x, ">25-50%,", fixed = TRUE)[[1]][2])
data$fifty_seventyfive_data_period_E_post_bc_death_HR <- sapply(data$placeholder4, function(x) strsplit(x, ">50-75%,", fixed = TRUE)[[1]][1])
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, ">50-75%,", fixed = TRUE)[[1]][2])
data <- data[, c(1:225, 227, 229, 231)]
data$zero_twentyfive_data_period_E_post_bc_death_HR_only <- sapply(data$zero_twentyfive_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$zero_twentyfive_data_period_E_post_bc_death_HR_CI <- sapply(data$zero_twentyfive_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$zero_twentyfive_data_period_E_post_bc_death_HR_CI <- gsub(") for", "", data$zero_twentyfive_data_period_E_post_bc_death_HR_CI)
data$zero_twentyfive_data_period_E_post_bc_death_HR_CI_lower  <- sapply(data$zero_twentyfive_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$zero_twentyfive_data_period_E_post_bc_death_HR_CI_upper <- sapply(data$zero_twentyfive_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$twentyfive_fifty_data_period_E_post_bc_death_HR_only <- sapply(data$twentyfive_fifty_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI <- sapply(data$twentyfive_fifty_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI <- gsub(") for", "", data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI)
data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI_lower  <- sapply(data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI_upper <- sapply(data$twentyfive_fifty_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$fifty_seventyfive_data_period_E_post_bc_death_HR_only <- sapply(data$fifty_seventyfive_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI <- sapply(data$fifty_seventyfive_data_period_E_post_bc_death_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI <- gsub(") for", "", data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI)
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI_lower  <- sapply(data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI_upper <- sapply(data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:225, 229:240)]
data <- data[, c(1:182, 226:237, 183:225)]
#clean the main adjusted postdiagnostic bc death HR column 
data$placeholder <- sapply(data$adj_post_bc_death_HR, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$adj_post_bc_death_HR, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data <- data[, (1:238)]
data$placeholder3 <- sapply(data$placeholder, function(x) strsplit(x, "*", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder, function(x) strsplit(x, "*", fixed = TRUE)[[1]][2])
data <- data[, c(1:237, 240)]
data$placeholder4 <- gsub("for >75%", "", data$placeholder4)
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$placeholder6 <- sapply(data$placeholder4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data <- data[, c(1:237, 239)]
data$placeholder5 <- gsub("[^0-9.()-]", "", data$placeholder5)
data$adj_post_bc_death_HR_only <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$adj_post_bc_death_HR_CI <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data <- data[, c(1:237, 239, 240)]
data$adj_post_bc_death_HR_CI_lower  <- sapply(data$adj_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_post_bc_death_HR_CI_upper <- sapply(data$adj_post_bc_death_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:174, 238:241, 175:237)]
#remove a couple of glitches
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI_upper <- gsub(">50", "", data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI_upper)
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI <- gsub(">50-75%", "", data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI)
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI <- gsub("[^0-9.()-]", "", data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI)
data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI <- gsub("1.05", "", data$fifty_seventyfive_data_period_E_post_bc_death_HR_CI)
#no point cleaning post bc stage RR/OR as only 1 data point each
#clean post bc stage HR
#for Holmes 2014 I will be using Period A data because there is no stage stratified Period E data
#I will include >1 daily dose data in the main column as it has a larger sample size, but will record <1 daily dose data in a separate column
#For McMenamin 2017 I will be including the adjusted HRs
data$placeholder1  <- sapply(data$post_bc_death_stage_HR, function(x) strsplit(x, "Stage I:", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$post_bc_death_stage_HR, function(x) strsplit(x, "Stage I:", fixed = TRUE)[[1]][2])
data$post_bc_death_HR_stage_I  <- sapply(data$placeholder2, function(x) strsplit(x, "Stage II:", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder2, function(x) strsplit(x, "Stage II:", fixed = TRUE)[[1]][2])
#Holmes groups Stage III and IV data together- will keep in a seperate column
data$post_bc_death_HR_stage_II  <- sapply(data$placeholder4, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][1])
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][2])
data$post_bc_death_HR_combined_stage_III_and_IV_data <- sapply(data$placeholder5, function(x) strsplit(x, "62", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_III_data <- sapply(data$placeholder5, function(x) strsplit(x, "62", fixed = TRUE)[[1]][2])
data$post_bc_death_HR_stage_III <- sapply(data$post_bc_death_HR_stage_III_data, function(x) strsplit(x, "Stage IV", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_IV <- sapply(data$post_bc_death_HR_stage_III_data, function(x) strsplit(x, "Stage IV", fixed = TRUE)[[1]][2])
data <- data[, c(1:241, 244, 246, 250, 251, 248)]
data$post_bc_death_HR_stage_I <- sapply(data$post_bc_death_HR_stage_I, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][1])
data$placeholder <- sapply(data$post_bc_death_HR_stage_I, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][2])
data$placeholder2 <- sapply(data$post_bc_death_HR_stage_I, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_I_data <- sapply(data$post_bc_death_HR_stage_I, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "comparison", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_I_data_lessthan1dailydose <- sapply(data$placeholder2, function(x) strsplit(x, "comparison", fixed = TRUE)[[1]][2])
data <- data[, c(1:241, 249, 251, 243, 244, 245, 246)]
data$post_bc_death_HR_stage_I_data <- gsub("1 daily", "", data$post_bc_death_HR_stage_I_data)
data$post_bc_death_HR_stage_I_data <- gsub("[^0-9.()-]", "", data$post_bc_death_HR_stage_I_data)
data$post_bc_death_stage_I_HR <- sapply(data$post_bc_death_HR_stage_I_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_I_HR_CI <- sapply(data$post_bc_death_HR_stage_I_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_HR_stage_I_HR_CI <- gsub(").", "", data$post_bc_death_HR_stage_I_HR_CI)
data$post_bc_death_HR_stage_I_HR_CI <- gsub(")", "", data$post_bc_death_HR_stage_I_HR_CI)
data$post_bc_death_stage_I_HR_CI_lower <- sapply(data$post_bc_death_HR_stage_I_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_I_HR_CI_upper <- sapply(data$post_bc_death_HR_stage_I_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:241, 248:251, 243:247)]
data$post_bc_death_HR_stage_I_data_lessthan1dailydose <- gsub("[^0-9.()-]", "", data$post_bc_death_HR_stage_I_data_lessthan1dailydose)
data$post_bc_death_stage_I_lessthan1dailydose_HR <- sapply(data$post_bc_death_HR_stage_I_data_lessthan1dailydose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_HR_stage_I_lessthan1dailydose_HR_CI <- sapply(data$post_bc_death_HR_stage_I_data_lessthan1dailydose, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_HR_stage_I_lessthan1dailydose_HR_CI <- gsub(")", "", data$post_bc_death_HR_stage_I_lessthan1dailydose_HR_CI)
data$post_bc_death_stage_I_lessthan1dailydose_HR_CI_lower <- sapply(data$post_bc_death_HR_stage_I_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_lessthan1dailydose_HR_CI_upper <- sapply(data$post_bc_death_HR_stage_I_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:245, 251:254, 247:250)]
data$post_bc_death_stage_II_data <- sapply(data$post_bc_death_HR_stage_II, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][1])
data$placeholder <- sapply(data$post_bc_death_HR_stage_II, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][2])
data$placeholder2 <- sapply(data$post_bc_death_stage_II_data, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_HR_data <- sapply(data$post_bc_death_stage_II_data, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "95/188", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_lessthan1dailydose_HR_data <- sapply(data$placeholder2, function(x) strsplit(x, "95/188", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_lessthan1dailydose_HR_data <- gsub("1 daily", "", data$post_bc_death_stage_II_lessthan1dailydose_HR_data)
data$post_bc_death_stage_II_HR_data <- gsub("1 daily", "", data$post_bc_death_stage_II_HR_data)
data <- data[, c(1:253, 257, 259)]
data$post_bc_death_stage_II_HR_data <- gsub("[^0-9.()-]", "", data$post_bc_death_stage_II_HR_data)
data$post_bc_death_stage_II_lessthan1dailydose_HR_data <- gsub("dose.", "", data$post_bc_death_stage_II_lessthan1dailydose_HR_data)
data$post_bc_death_stage_II_lessthan1dailydose_HR_data <- gsub("[^0-9.()-]", "", data$post_bc_death_stage_II_lessthan1dailydose_HR_data)
data$post_bc_death_stage_II_HR <- sapply(data$post_bc_death_stage_II_HR_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_HR_CI <- sapply(data$post_bc_death_stage_II_HR_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_HR_CI <- gsub(").", "", data$post_bc_death_stage_II_HR_CI)
data$post_bc_death_stage_II_HR_CI <- gsub(")", "", data$post_bc_death_stage_II_HR_CI)
data$post_bc_death_stage_II_HR_CI_lower <- sapply(data$post_bc_death_stage_II_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_HR_CI_upper <- sapply(data$post_bc_death_stage_II_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_lessthan1dailydose_HR <- sapply(data$post_bc_death_stage_II_lessthan1dailydose_HR_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_lessthan1dailydose_HR_CI <- sapply(data$post_bc_death_stage_II_lessthan1dailydose_HR_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_lessthan1dailydose_HR_CI <- gsub(").", "", data$post_bc_death_stage_II_lessthan1dailydose_HR_CI)
data$post_bc_death_stage_II_lessthan1dailydose_HR_CI <- gsub(")", "", data$post_bc_death_stage_II_lessthan1dailydose_HR_CI)
data$post_bc_death_stage_II_lessthan1dailydose_HR_CI_lower <- sapply(data$post_bc_death_stage_II_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_lessthan1dailydose_HR_CI_upper <- sapply(data$post_bc_death_stage_II_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:249, 256:263, 251:253)]
data$placeholder <- sapply(data$post_bc_death_HR_stage_III, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_data <- sapply(data$post_bc_death_HR_stage_III, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_data <- gsub("[^0-9.()-]", "", data$post_bc_death_stage_III_data)
data$post_bc_death_stage_III_data <- gsub(").", "", data$post_bc_death_stage_III_data)
data$post_bc_death_stage_III_data <- gsub(")", "", data$post_bc_death_stage_III_data)
data$post_bc_death_stage_III_HR <- sapply(data$post_bc_death_stage_III_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_HR_CI <- sapply(data$post_bc_death_stage_III_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_HR_CI_lower <- sapply(data$post_bc_death_stage_III_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_HR_CI_upper <- sapply(data$post_bc_death_stage_III_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:257, 263:266, 259, 260)]
data$placeholder <- sapply(data$post_bc_death_HR_stage_IV, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IV_data <- sapply(data$post_bc_death_HR_stage_IV, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_IV_data <- gsub("[^0-9.()-]", "", data$post_bc_death_stage_IV_data)
data$post_bc_death_stage_IV_data <- gsub(")", "", data$post_bc_death_stage_IV_data)
data$post_bc_death_stage_IV_HR <- sapply(data$post_bc_death_stage_IV_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IV_HR_CI <- sapply(data$post_bc_death_stage_IV_data, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_IV_HR_CI_lower <- sapply(data$post_bc_death_stage_IV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IV_HR_CI_upper <- sapply(data$post_bc_death_stage_IV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:261, 266:269, 263)]
data$post_bc_death_HR_combined_stage_III_and_IV <- sapply(data$post_bc_death_HR_combined_stage_III_and_IV_data, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][1])
data$placeholder <- sapply(data$post_bc_death_HR_combined_stage_III_and_IV_data, function(x) strsplit(x, "Period B", fixed = TRUE)[[1]][2])
data$placeholder2 <- sapply(data$post_bc_death_HR_combined_stage_III_and_IV, function(x) strsplit(x, "52/109", fixed = TRUE)[[1]][1])
data$placeholder3 <- sapply(data$post_bc_death_HR_combined_stage_III_and_IV, function(x) strsplit(x, "52/109", fixed = TRUE)[[1]][2])
data$placeholder3 <- gsub("1 daily", "", data$placeholder3)
data$placeholder4 <- sapply(data$placeholder3, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$placeholder5 <- sapply(data$placeholder3, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$placeholder4 <- gsub("dose.", "", data$placeholder4)
data$placeholder4 <- gsub("[^0-9.()-]", "", data$placeholder4)
data$placeholder5 <- gsub(").", "", data$placeholder5)
data$placeholder5 <- gsub("[^0-9.()-]", "", data$placeholder5)
data$post_bc_death_stage_IIIandIV_HR <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IIIandIV_HR_CI <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_IIIandIV_HR_CI_lower <- sapply(data$post_bc_death_stage_IIIandIV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IIIandIV_HR_CI_upper <- sapply(data$post_bc_death_stage_IIIandIV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR <- sapply(data$placeholder4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI <- sapply(data$placeholder4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI <- gsub(")", "", data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI)
data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI_lower <- sapply(data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI_upper <- sapply(data$post_bc_death_stage_IIIandIV_lessthan1dailydose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:265, 273:280)]
#note all the stage_IIIandIV store the combined Stage III and IV data from Holmes 2014
data <- data[, c(1:202, 242:273, 203:241)]
#only one data point for menopause stratified postdiagnostic bc death so no point cleaning
#clean molsubtype stratified post bc death RR column 
data$post_bc_death_molsubtype_RR <- gsub ("All RRs compared with never aspirin group", "", data$post_bc_death_molsubtype_RR)
#for Holmes 2011 I am including the multivariate as opposed to univariate data
#create columns for COX-2 positive and negative RRs
data$post_bc_death_molsubtype_RR <- gsub ("COX-2 positive:", "", data$post_bc_death_molsubtype_RR)
data$post_bc_death_molsubtype_RR <- gsub ("Simple adjusted RR 0.60", "", data$post_bc_death_molsubtype_RR)
data$placeholder1 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$placeholder3 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "0.56", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "0.56", fixed = TRUE)[[1]][2])
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$placeholder6 <- sapply(data$placeholder4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$placeholder6 <- gsub("[^0-9.()-]", "", data$placeholder6)
data$post_bc_death_COX2_neg_RR <- sapply(data$placeholder6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_COX2_neg_RR_CI <- sapply(data$placeholder6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_COX2_neg_RR_CI <- gsub(")", "", data$post_bc_death_COX2_neg_RR_CI)
data$post_bc_death_COX2_neg_RR_CI_lower <- sapply(data$post_bc_death_COX2_neg_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_COX2_neg_RR_CI_upper <- sapply(data$post_bc_death_COX2_neg_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$placeholder7 <- sapply(data$placeholder2, function(x) strsplit(x, "COX", fixed = TRUE)[[1]][1])
data$placeholder8 <- sapply(data$placeholder2, function(x) strsplit(x, "COX", fixed = TRUE)[[1]][2])
data$placeholder7 <- gsub("[^0-9.()-]", "", data$placeholder7)
data$post_bc_death_COX2_pos_RR <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_COX2_pos_RR_CI <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_COX2_pos_RR_CI <- gsub(")", "", data$post_bc_death_COX2_pos_RR_CI)
data$post_bc_death_COX2_pos_RR_CI_lower <- sapply(data$post_bc_death_COX2_pos_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_COX2_pos_RR_CI_upper <- sapply(data$post_bc_death_COX2_pos_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:237, 286:289, 280:283, 238:273)]
#create columns for ER+ data for 1 day a week, 2-5 days a week and 6-7 days a week use
data$placeholder1 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "past", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "past", fixed = TRUE)[[1]][2])
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, "for 2-5", fixed = TRUE)[[1]][1])
data$placeholder6 <- sapply(data$placeholder4, function(x) strsplit(x, "for 2-5", fixed = TRUE)[[1]][2])
data$placeholder7 <- sapply(data$placeholder6, function(x) strsplit(x, "6-7", fixed = TRUE)[[1]][1])
data$placeholder8 <- sapply(data$placeholder6, function(x) strsplit(x, "6-7", fixed = TRUE)[[1]][2])
data$placeholder3 <- gsub("[^0-9.()-]", "", data$placeholder3)
data$post_bc_death_ER_pos_1dayaweekuse_RR <- sapply(data$placeholder3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_1dayaweekuse_RR_CI <- sapply(data$placeholder3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_pos_1dayaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_pos_1dayaweekuse_RR_CI)
data$post_bc_death_ER_pos_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_pos_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_pos_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$placeholder5 <- gsub("[^0-9.()-]", "", data$placeholder5)
data$post_bc_death_ER_pos_2to5_daysaweekuse_RR <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI)
data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_pos_2to5_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$placeholder7 <- gsub("[^0-9.()-]", "", data$placeholder7)
data$post_bc_death_ER_pos_6to7_daysaweekuse_RR <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI)
data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:245, 290:301, 246:281)]
#create columns for ER- data for 1 day a week, 2-5 days a week and 6-7 days a week use
data$placeholder1 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "receptor negative", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$post_bc_death_molsubtype_RR, function(x) strsplit(x, "receptor negative", fixed = TRUE)[[1]][2])
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "past use", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder2, function(x) strsplit(x, "past use", fixed = TRUE)[[1]][2])
data$placeholder5 <- sapply(data$placeholder4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$placeholder6 <- sapply(data$placeholder4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$placeholder7 <- sapply(data$placeholder6, function(x) strsplit(x, "for 2-5", fixed = TRUE)[[1]][1])
data$placeholder8 <- sapply(data$placeholder6, function(x) strsplit(x, "for 2-5", fixed = TRUE)[[1]][2])
data$placeholder8 <- gsub("6-7", "", data$placeholder8)
data$placeholder5 <- gsub("[^0-9.()-]", "", data$placeholder5)
data$post_bc_death_ER_neg_1dayaweekuse_RR <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_1dayaweekuse_RR_CI <- sapply(data$placeholder5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_neg_1dayaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_neg_1dayaweekuse_RR_CI)
data$post_bc_death_ER_neg_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_neg_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_neg_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$placeholder7 <- gsub("[^0-9.()-]", "", data$placeholder7)
data$post_bc_death_ER_neg_2to5_daysaweekuse_RR <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI <- sapply(data$placeholder7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI)
data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_neg_2to5_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$placeholder8 <- gsub("[^0-9.()-]", "", data$placeholder8)
data$post_bc_death_ER_neg_6to7_daysaweekuse_RR <- sapply(data$placeholder8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI <- sapply(data$placeholder8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI <- gsub(")", "", data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI)
data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:257, 302:313, 258:293)]
#clean molsubtype stratified post bc death HR column  
data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis <- data$post_bc_death_molsubtype_HR
data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis <- gsub("[^0-9]", "", data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis)
data$number_of_deaths_ER_pos_aspirin_users <- data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis
data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis <- data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis
data$number_of_deaths_in_ER_pos_aspirin_nonusers <- data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis
data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "", data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis)
data$number_of_deaths_ER_pos_aspirin_users <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "111", data$number_of_deaths_ER_pos_aspirin_users)
data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "", data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis)
data$number_of_deaths_in_ER_pos_aspirin_nonusers <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "434", data$number_of_deaths_in_ER_pos_aspirin_nonusers)
data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis <- gsub("185", "", data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis)
data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis <- gsub("58876101022728793149127176091070119215816683860604786021015144121172091069120", "", data$number_of_aspirin_users_in_postdiagnostic_ER_pos_analysis)
data$number_of_deaths_ER_pos_aspirin_users <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "", data$number_of_deaths_ER_pos_aspirin_users)
data$number_of_deaths_ER_pos_aspirin_users <- gsub("242358876101022728793149127176091070119215816683860604786021015144121172091069120", "", data$number_of_deaths_ER_pos_aspirin_users)
data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "", data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis)
data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis <- gsub("18524235887610", "", data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis)
data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis <- gsub("28793149127176091070119215816683860604786021015144121172091069120", "", data$number_of_nonusers_in_postdiagnostic_ER_pos_analysis)
data$number_of_deaths_in_ER_pos_aspirin_nonusers <- gsub("231119124071217211548608306111311143408406211381292129088189244194130077222", "", data$number_of_deaths_in_ER_pos_aspirin_nonusers)
data$number_of_deaths_in_ER_pos_aspirin_nonusers <- gsub("18524235887", "", data$number_of_deaths_in_ER_pos_aspirin_nonusers)
data$number_of_deaths_in_ER_pos_aspirin_nonusers <- gsub("1022728793149127176091070119215816683860604786021015144121172091069120", "", data$number_of_deaths_in_ER_pos_aspirin_nonusers)
data <- data[, c(1:270, 306:309, 271:305)]
#for McMenamin 2017 I am keeping the adjusted HR
data$placeholder1 <- sapply(data$post_bc_death_molsubtype_HR, function(x) strsplit(x, "Unadjusted HR 1.49 (1.27-1.76)", fixed = TRUE)[[1]][1])
data$placeholder2 <- sapply(data$post_bc_death_molsubtype_HR, function(x) strsplit(x, "Unadjusted HR 1.49 (1.27-1.76)", fixed = TRUE)[[1]][2])
#only one data point for BMI stratified postdiagnostic bc death so no point cleaning 
data$placeholder3 <- sapply(data$placeholder2, function(x) strsplit(x, "Multivariate", fixed = TRUE)[[1]][1])
data$placeholder4 <- sapply(data$placeholder2, function(x) strsplit(x, "Multivariate", fixed = TRUE)[[1]][2])
data$placeholder3 <- gsub("[^0-9.(-]", "", data$placeholder3)
data$post_bc_death_ER_pos_HR <- sapply(data$placeholder3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_HR_CI <- sapply(data$placeholder3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_pos_HR_CI_lower <- sapply(data$post_bc_death_ER_pos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_HR_CI_upper <- sapply(data$post_bc_death_ER_pos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:274, 314:317, 275:310)]
data$placeholder1 <- gsub("HER2+", "", data$placeholder1)
data$placeholder2 <- gsub("[^0-9]", "", data$placeholder1)
data$placeholder2 <- gsub("185242358876101022728793", "", data$placeholder2)
data$deaths_in_HER2_pos_post_aspirin_users <- data$placeholder2
data$deaths_in_HER2_pos_post_nonusers <- data$placeholder2
data$deaths_in_HER2_neg_post_aspirin_users <- data$placeholder2
data$deaths_in_HER2_neg_post_nonusers <- data$placeholder2
data$deaths_in_ER_neg_post_aspirin_users <- data$placeholder2
data$deaths_in_ER_neg_post_nonusers <- data$placeholder2
data$deaths_in_ER_and_HER2_neg_post_aspirin_users <- data$placeholder2
data$deaths_in_ER_and_HER2_neg_post_nonusers <- data$placeholder2
data$deaths_in_HER2_pos_post_aspirin_users <- gsub("1191240712171154860830611131114340840621138129212908818944194130077222", "", data$deaths_in_HER2_pos_post_aspirin_users)
data$deaths_in_HER2_pos_post_nonusers <- gsub("31", "", data$deaths_in_HER2_pos_post_nonusers)
data$deaths_in_HER2_pos_post_nonusers <- gsub("12407121711548608306111114340840621138129212908818944194130077222", "", data$deaths_in_HER2_pos_post_nonusers)
data$deaths_in_HER2_neg_post_aspirin_users <- gsub("31119124071217", "", data$deaths_in_HER2_neg_post_aspirin_users)
data$deaths_in_HER2_neg_post_aspirin_users <- gsub("4860830611131114340840621138129212908818944194130077222", "", data$deaths_in_HER2_neg_post_aspirin_users)
data$deaths_in_HER2_neg_post_nonusers <- gsub("31119124071217115", "", data$deaths_in_HER2_neg_post_nonusers)
data$deaths_in_HER2_neg_post_nonusers <- gsub("0830611131114340840621138129212908818944194130077222", "", data$deaths_in_HER2_neg_post_nonusers)
data$deaths_in_ER_neg_post_aspirin_users <- gsub("311191240712171154860830611131114340840621138129212908818944194130077222", "81", data$deaths_in_ER_neg_post_aspirin_users)
data$deaths_in_ER_neg_post_nonusers <- gsub("311191240712171154860830611131114340840621138129212908818944194130077222", "292", data$deaths_in_ER_neg_post_nonusers)
data$deaths_in_ER_and_HER2_neg_post_aspirin_users <- gsub("311191240712171154860830611131114340840621138129212908818944194130077222", "44", data$deaths_in_ER_and_HER2_neg_post_aspirin_users)
data$deaths_in_ER_and_HER2_neg_post_nonusers <- gsub("311191240712171154860830611131114340840621138129212908818944194130077222", "194", data$deaths_in_ER_and_HER2_neg_post_nonusers)
data <- data[, c(1:274, 316:323, 275:313, 314)]
data$p2 <- sapply(data$placeholder1, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$placeholder1, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p4 <- sapply(data$placeholder1, function(x) strsplit(x, "486", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$placeholder1, function(x) strsplit(x, "486", fixed = TRUE)[[1]][2])
data$p5 <- gsub("111 deaths", "", data$p5)
data$p6 <- sapply(data$p5, function(x) strsplit(x, "434", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "434", fixed = TRUE)[[1]][2])
data$p7 <- gsub("81 deaths", "", data$p7)
data$p8 <- sapply(data$p7, function(x) strsplit(x, "292", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "292", fixed = TRUE)[[1]][2])
data$p9 <- gsub("44 deaths", "", data$p9)
data$p10 <- sapply(data$p9, function(x) strsplit(x, "194", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "194", fixed = TRUE)[[1]][2])
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$p3 <- gsub(".-115486.", "", data$p3)
data$post_bc_death_HER2_pos_HR <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_pos_HR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_HER2_pos_HR_CI_lower <- sapply(data$post_bc_death_HER2_pos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_pos_HR_CI_upper <- sapply(data$post_bc_death_HER2_pos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p6 <- gsub("nonusers.", "", data$p6)
data$p6 <- gsub(").", "", data$p6)
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$post_bc_death_HER2_neg_HR <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_neg_HR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_HER2_neg_HR_CI_lower <- sapply(data$post_bc_death_HER2_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_neg_HR_CI_upper <- sapply(data$post_bc_death_HER2_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p8 <- gsub("nonusers.", "", data$p8)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_bc_death_ER_pos_HR_2 <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_HR_2_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_pos_HR_2_CI_lower <- sapply(data$post_bc_death_ER_pos_HR_2_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_pos_HR_2_CI_upper <- sapply(data$post_bc_death_ER_pos_HR_2_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p10 <- gsub("nonusers.", "", data$p10)
data$p10 <- gsub("-/-", "", data$p10)
data$p10 <- gsub("[^0-9.(-]", "", data$p10)
data$post_bc_death_ER_neg_HR <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_HR_CI <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_ER_neg_HR_CI_lower <- sapply(data$post_bc_death_ER_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_ER_neg_HR_CI_upper <- sapply(data$post_bc_death_ER_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p11 <- gsub("nonusers.", "", data$p11)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$post_bc_death_HER2_and_ER_neg_HR <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_and_ER_neg_HR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_HER2_and_ER_neg_HR_CI_lower <- sapply(data$post_bc_death_HER2_and_ER_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_HER2_and_ER_neg_HR_CI_upper <- sapply(data$post_bc_death_HER2_and_ER_neg_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:286, 333:352, 287:321)]
#unite the two ER pos HR and CI columns because I created one for each row
data <- data %>% unite(ER_pos_HR_post_bc_death, post_bc_death_ER_pos_HR, post_bc_death_ER_pos_HR_2, sep = "")
data$ER_pos_HR_post_bc_death <- gsub("NA", "", data$ER_pos_HR_post_bc_death)
data <- data %>% unite(ER_pos_HR_CI_post_bc_death, post_bc_death_ER_pos_HR_CI, post_bc_death_ER_pos_HR_2_CI, sep = "")
data$ER_pos_HR_CI_post_bc_death <- gsub("NA", "", data$ER_pos_HR_CI_post_bc_death)
data <- data %>% unite(ER_pos_HR_CI_lower_post_bc_death, post_bc_death_ER_pos_HR_CI_lower, post_bc_death_ER_pos_HR_2_CI_lower, sep = "")
data$ER_pos_HR_CI_lower_post_bc_death <- gsub("NA", "", data$ER_pos_HR_CI_lower_post_bc_death)
data <- data %>% unite(ER_pos_HR_CI_upper_post_bc_death, post_bc_death_ER_pos_HR_CI_upper, post_bc_death_ER_pos_HR_2_CI_upper, sep = "")
data$ER_pos_HR_CI_upper_post_bc_death <- gsub("NA", "", data$ER_pos_HR_CI_upper_post_bc_death)
#no point cleaning BMI stratified post bc death yet bc only 1 data point
#same for post bc death dose OR
#clean post bc death dose HR
#start by creating columns for low intensity aspirin users' deaths and HR
data$p1 <- sapply(data$post_bc_death_dose_HR, function(x) strsplit(x, "'High-intensity'", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_dose_HR, function(x) strsplit(x, "'High-intensity'", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "univariate", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "univariate", fixed = TRUE)[[1]][2])
data$p3 <- gsub("[^0-9]", "", data$p3)
data$post_bc_death_low_intensity_deaths <- NA
data[grep("27", data$p3),]$post_bc_death_low_intensity_deaths <- data[grep("27", data$p3),]$p3
#for Barron 2015 I am keeping multivariate rather than univariate HR
data$p5 <- sapply(data$p4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$p6 <- gsub(")", "", data$p6)
data$post_bc_death_low_intensity_HR <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_intensity_HR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_intensity_HR_CI_lower <- sapply(data$post_bc_death_low_intensity_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_intensity_HR_CI_upper <- sapply(data$post_bc_death_low_intensity_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:306, 342, 345:348, 307:339)]
#now do same for high intensity users
data$p3 <- sapply(data$p2, function(x) strsplit(x, "Aspirin use initiated", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "Aspirin use initiated", fixed = TRUE)[[1]][2])
data$post_bc_death_high_intensity_deaths <- sapply(data$p3, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$post_bc_death_high_intensity_deaths <- gsub("[^0-9]", "", data$post_bc_death_high_intensity_deaths)
data$post_bc_death_high_intensity_deaths <- gsub("107076152", "", data$post_bc_death_high_intensity_deaths)
data$p5 <- gsub(")", "", data$p5)
data$post_bc_death_high_intensity_HR <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_high_intensity_HR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_high_intensity_HR_CI_lower <- sapply(data$post_bc_death_high_intensity_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_high_intensity_HR_CI_upper <- sapply(data$post_bc_death_high_intensity_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:311, 347, 349:352, 312:343)]
#now make columns for 1-365 tablet users; patients, deaths and HR
#for McMenamin 2017 I am again using adjusted HR
data$p2 <- sapply(data$p1, function(x) strsplit(x, "365-730", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "365-730", fixed = TRUE)[[1]][2])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "compared with no aspirin", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p2, function(x) strsplit(x, "compared with no aspirin", fixed = TRUE)[[1]][2])
data$p2 <- gsub("[^0-9]", "", data$p2)
data$p2 <- gsub("13658362853120150124182098074130", "836", data$p2)
data$post_bc_death_1to365tabs_patients <- NA
data[grep("836", data$p2),]$post_bc_death_1to365tabs_patients <- data[grep("836", data$p2),]$p2
data$p4 <- gsub("[^0-9]", "", data$p4)
data$p4 <- gsub("13658362853", "", data$p4)
data$post_bc_death_1to365tabs_deaths <- NA
data[grep("120", data$p4),]$post_bc_death_1to365tabs_deaths <- data[grep("120", data$p4),]$p4
data$p6 <- sapply(data$p5, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p7 <- gsub(")", "", data$p7)
data$post_bc_death_1to365tabs_HR <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_1to365tabs_HR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_1to365tabs_HR_CI_lower <- sapply(data$post_bc_death_1to365tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_1to365tabs_HR_CI_upper <- sapply(data$post_bc_death_1to365tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:316, 353, 354, 357:360, 317:348, 350)]
#ditto for 365-730 tablet users
data$p4 <- sapply(data$p3, function(x) strsplit(x, "730-1095", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "730-1095", fixed = TRUE)[[1]][2])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p4, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$post_bc_death_365to730tabs_patients <- gsub("[^0-9]", "", data$p6)
data$post_bc_death_365to730tabs_deaths <- data$post_bc_death_365to730tabs_patients
data$post_bc_death_365to730tabs_patients <- gsub("209891", "", data$post_bc_death_365to730tabs_patients)
data$post_bc_death_365to730tabs_deaths <- gsub("692209891", "91", data$post_bc_death_365to730tabs_deaths)
data$p8 <- sapply(data$p7, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p9 <- gsub(")", "", data$p9)
data$post_bc_death_365to730tabs_HR <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_365to730tabs_HR_CI <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_365to730tabs_HR_CI_lower <- sapply(data$post_bc_death_365to730tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_365to730tabs_HR_CI_upper <- sapply(data$post_bc_death_365to730tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:322, 360, 361, 364:367, 323:354, 357)]
#ditto for 730-1095 tablet users
data$p6 <- sapply(data$p5, function(x) strsplit(x, "1095+", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "1095+", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p6, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$post_bc_death_730to1095tabs_patients <- gsub("[^0-9]", "", data$p8)
data$post_bc_death_730to1095tabs_deaths <- data$post_bc_death_730to1095tabs_patients
data$post_bc_death_730to1095tabs_patients <- gsub("107425", "", data$post_bc_death_730to1095tabs_patients)
data$post_bc_death_730to1095tabs_deaths <- gsub("548107425", "25", data$post_bc_death_730to1095tabs_deaths)
data$p10 <- sapply(data$p9, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p11 <- gsub(")", "", data$p11)
data$post_bc_death_730to1095tabs_HR <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_730to1095tabs_HR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_730to1095tabs_HR_CI_lower <- sapply(data$post_bc_death_730to1095tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_730to1095tabs_HR_CI_upper <- sapply(data$post_bc_death_730to1095tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:328, 366, 367, 370:373, 329:360, 363)]
#ditto for 1095+ tablet users
data$p8 <- sapply(data$p7, function(x) strsplit(x, "Use", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "Use", fixed = TRUE)[[1]][2])
data$p10 <- sapply(data$p8, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p8, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$post_bc_death_1095plustabs_patients <- gsub("[^0-9]", "", data$p10)
data$post_bc_death_1095plustabs_deaths <- data$post_bc_death_1095plustabs_patients
data$post_bc_death_1095plustabs_patients <- gsub("79625", "", data$post_bc_death_1095plustabs_patients)
data$post_bc_death_1095plustabs_deaths <- gsub("74679625", "25", data$post_bc_death_1095plustabs_deaths)
data$p12 <- sapply(data$p11, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p11, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p13 <- gsub(")", "", data$p13)
data$post_bc_death_1095plustabs_HR <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_1095plustabs_HR_CI <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_1095plustabs_HR_CI_lower <- sapply(data$post_bc_death_1095plustabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_1095plustabs_HR_CI_upper <- sapply(data$post_bc_death_1095plustabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:334, 372, 373, 376:379, 335:366)]
#the data I'm extracting from Frisk 2018 is <75 and >75mg use at any point in followup, use for <6 months, use for 6-24 months and use for >24 months
#could compare use for >24 months (for example) to 730-1095 tablets from McMenamin (assuming ~1 tablet per day)
#will be extracting Model B data
#start with <75mg use
data$p2 <- sapply(data$p1, function(x) strsplit(x, "(0.73-1.16),", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "(0.73-1.16),", fixed = TRUE)[[1]][2])
data$p4 <- sapply(data$p3, function(x) strsplit(x, ">75 mg per day", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p3, function(x) strsplit(x, ">75 mg per day", fixed = TRUE)[[1]][2])
data$p4 <- gsub("[^0-9.()-]", "", data$p4)
data$p4 <- gsub(").", "", data$p4)
data$post_bc_death_lessthanorequal_75mg_dose_HR <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_lessthanorequal_75mg_dose_HR_CI <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_lessthanorequal_75mg_dose_HR_CI_lower <- sapply(data$post_bc_death_lessthanorequal_75mg_dose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_lessthanorequal_75mg_dose_HR_CI_upper <- sapply(data$post_bc_death_lessthanorequal_75mg_dose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:340, 377:380, 341:371, 376)]
data$p6 <- sapply(data$p5, function(x) strsplit(x, ">75", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p5, function(x) strsplit(x, ">75", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p7, function(x) strsplit(x, "<6", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "<6", fixed = TRUE)[[1]][2])
data$p10 <- sapply(data$p8, function(x) strsplit(x, "(0.99-2.19),", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p8, function(x) strsplit(x, "(0.99-2.19),", fixed = TRUE)[[1]][2])
data$p11 <- gsub("[^0-9.()-]", "", data$p11)
data$p11 <- gsub(").", "", data$p11)
data$post_bc_death_greaterthan_75mg_dose_HR <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_greaterthan_75mg_dose_HR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_greaterthan_75mg_dose_HR_CI_lower <- sapply(data$post_bc_death_greaterthan_75mg_dose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_greaterthan_75mg_dose_HR_CI_upper <- sapply(data$post_bc_death_greaterthan_75mg_dose_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:344, 383:386, 345:375, 380)]
data$p10 <- sapply(data$p9, function(x) strsplit(x, "6 months-2 years", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "6 months-2 years", fixed = TRUE)[[1]][2])
data$p12 <- sapply(data$p10, function(x) strsplit(x, "(0.71-1.26),", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p10, function(x) strsplit(x, "(0.71-1.26),", fixed = TRUE)[[1]][2])
data$p13 <- gsub("[^0-9.()-]", "", data$p13)
data$p13 <- gsub(")", "", data$p13)
data$post_bc_death_upto6months_use_HR <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_upto6months_use_HR_CI <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_upto6months_use_HR_CI_lower <- sapply(data$post_bc_death_upto6months_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_upto6months_use_HR_CI_upper <- sapply(data$post_bc_death_upto6months_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:348, 385:388, 349:379, 382)]
data$p12 <- sapply(data$p11, function(x) strsplit(x, ">2", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p11, function(x) strsplit(x, ">2", fixed = TRUE)[[1]][2])
data$p14 <- sapply(data$p12, function(x) strsplit(x, "(0.79-1.34),", fixed = TRUE)[[1]][1])
data$p15 <- sapply(data$p12, function(x) strsplit(x, "(0.79-1.34),", fixed = TRUE)[[1]][2])
data$p15 <- gsub("[^0-9.()-]", "", data$p15)
data$p15 <- gsub(").", "", data$p15)
data$post_bc_death_6monthsto2years_use_HR <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_6monthsto2years_use_HR_CI <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_6monthsto2years_use_HR_CI_lower <- sapply(data$post_bc_death_6monthsto2years_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_6monthsto2years_use_HR_CI_upper <- sapply(data$post_bc_death_6monthsto2years_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p16 <- sapply(data$p13, function(x) strsplit(x, "(0.60-1.22),", fixed = TRUE)[[1]][1])
data$p17 <- sapply(data$p13, function(x) strsplit(x, "(0.60-1.22),", fixed = TRUE)[[1]][2])
data$p17 <- gsub("[^0-9.()-]", "", data$p17)
data$p17 <- gsub(").", "", data$p17)
data$post_bc_death_over2years_use_HR <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_over2years_use_HR_CI <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_over2years_use_HR_CI_lower <- sapply(data$post_bc_death_over2years_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_over2years_use_HR_CI_upper <- sapply(data$post_bc_death_over2years_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:352, 389:392, 395:398, 353:383)]
#in treatment stratified post bc death there are 2 data points, one OR and one HR- leave for now and come back to?
#only one data point for unadj post ac death RR and OR columns so no point cleaning
#clean unadj post ac death HR column 
#for Zhou 2019 I am only including the first HR (81mg aspirin vs no aspirin)
#for Strasser-Weippl 2018 I am only including overall survival and not event free survival (as there is no other EFS data point to compare it to)
#for McMenamin 2017 I am only including the HR with a 6-month lag
#for Blair 2007 I am only including the HR for aspirin only and not aspirin and other NSAIDs
data$p1 <- sapply(data$unadj_post_ac_death_HR, function(x) strsplit(x, "was found", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$unadj_post_ac_death_HR, function(x) strsplit(x, "was found", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "event-free", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p3, function(x) strsplit(x, "event-free", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "aspirin only", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p5, function(x) strsplit(x, "aspirin only", fixed = TRUE)[[1]][2])
data$p7 <- gsub("95% CI", "", data$p7)
data$p7 <- gsub("81mg", "", data$p7)
data$p7 <- gsub("124 controls", "", data$p7)
data$p7 <- gsub("62 patients", "", data$p7)
data$p7 <- gsub("[^0-9.()-]", "", data$p7)
data$p7 <- gsub(")", "", data$p7)
data$post_ac_death_unadj_HR <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_unadj_HR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_unadj_HR_CI_lower <- sapply(data$post_ac_death_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_unadj_HR_CI_upper <- sapply(data$post_ac_death_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:369, 400:403, 370:391)]
#clean adj post ac death RR 
#for Holmes 2010 I am keeping the 6-7 days use data in the main column (because in most cases when aspirin is prescribed for a long term condition users are instructed to take it daily), whilst keeping 1 day a week and 2-5 days a week use data in seperate columns
data$p1 <- sapply(data$adj_post_ac_death_RR, function(x) strsplit(x, "RR", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$adj_post_ac_death_RR, function(x) strsplit(x, "RR", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "2-5", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "2-5", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p2, function(x) strsplit(x, ":", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p2, function(x) strsplit(x, ":", fixed = TRUE)[[1]][2])
data$p4 <- gsub("6-7", "", data$p4)
data$p4 <- gsub("[^0-9.()-]", "", data$p4)
data$p4 <- gsub(").", "", data$p4)
data$p5 <- gsub(")", "", data$p5)
data <- data %>% unite(p7, p4, p5, sep = "")
data$p7 <- gsub("NA", "", data$p7)
data$post_ac_death_adj_RR <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_RR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_RR_CI_lower <- sapply(data$post_ac_death_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_RR_CI_upper <- sapply(data$post_ac_death_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p3, function(x) strsplit(x, "past", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p3, function(x) strsplit(x, "past", fixed = TRUE)[[1]][2])
data$p10 <- sapply(data$p9, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p10 <- gsub("[^0-9.(-]", "", data$p10)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$post_ac_death_adj_1dayaweekuse_RR <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_1dayaweekuse_RR_CI <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_1dayaweekuse_RR_CI_lower <- sapply(data$post_ac_death_adj_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_1dayaweekuse_RR_CI_upper <- sapply(data$post_ac_death_adj_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_2to5daysaweekuse_RR <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_2to5daysaweekuse_RR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_ac_death_adj_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_ac_death_adj_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:375, 401:404, 409:416, 376:395)]
#only one data point in adj post ac death OR column so no point cleaning for now
#clean adj post ac death HR
#for Holmes 2014 only Period A to D data is given in the paper so here I will keep Period A data  
#for the Holmes 2014 Period A data I am using the additionally adjusted data
#For Holmes 2014 I will keep ≥1 daily dose data in the main analysis because this includes 1 daily dose (the usual prescribed dose of aspirin)
#however I will also keep the <1 daily dose data in a separate column 
#for McCarthy 2020 I am using aspirin only data and not aspirin/other NSAID data
#for McMenamin 2017 I am again using the 6-month lagged data and not the 1-year lagged data
#for Blair 2007 I am using aspirin only data and not the aspirin/NSAID data
#for Wernli 2011 I am using the Model B data
data$p1 <- sapply(data$adj_post_ac_death_HR, function(x) strsplit(x, "aspirin/NSAID", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$adj_post_ac_death_HR, function(x) strsplit(x, "aspirin/NSAID", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "1-year", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "1-year", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "aspirin only", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p3, function(x) strsplit(x, "aspirin only", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "Model A", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p5, function(x) strsplit(x, "Model A", fixed = TRUE)[[1]][2])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "education level", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p7, function(x) strsplit(x, "education level", fixed = TRUE)[[1]][2])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "since diagnosis.", fixed = TRUE)[[1]][1])
data$p12 <- sapply(data$p9, function(x) strsplit(x, "since diagnosis.", fixed = TRUE)[[1]][2])
data$p12 <- gsub("<1", "", data$p12)
data$p13 <- sapply(data$p12, function(x) strsplit(x, "and", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p12, function(x) strsplit(x, "and", fixed = TRUE)[[1]][2])
data$p11 <- gsub("[^0-9.()-]", "", data$p11)
data$p11 <- gsub("(0.95-1.54)", "", data$p11)
data$p11 <- gsub("(1.22-1.67)", "", data$p11)
data$p11 <- gsub("11.42", "", data$p11)
data[1, 418] <- gsub("1.21", "", data[1, 418])
data[1, 418] <- gsub("1", "", data[1, 418])
data[1, 418] <- gsub("[^0-9]", "", data[1, 418])
data$p13 <- gsub("[^0-9.(-]", "", data$p13)
data$p14 <- gsub("[^0-9.(-]", "", data$p14)
data$post_ac_death_adj_lessthan1dailyuse_HR <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_lessthan1dailyuse_HR_CI <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_lessthan1dailyuse_HR_CI_lower <- sapply(data$post_ac_death_adj_lessthan1dailyuse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_lessthan1dailyuse_HR_CI_upper <- sapply(data$post_ac_death_adj_lessthan1dailyuse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data %>% unite(p15, p11, p14, sep = "")
data$p15 <- gsub("NA", "", data$p15)
data$p15 <- gsub(")", "", data$p15)
data$post_ac_death_adj_HR <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_HR_CI <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_adj_HR_CI_lower <- sapply(data$post_ac_death_adj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_adj_HR_CI_upper <- sapply(data$post_ac_death_adj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:389, 425:428, 421:424, 390:407)]
#no point cleaning strat post ac death OR yet as only 1 data point
#clean strat post ac death HR
#create new columns with different strat factors
data$post_ac_death_HR_strat_PIK3CA <- NA
data[grep("PIK3CA", data$strat_post_ac_death_HR),]$post_ac_death_HR_strat_PIK3CA <- data[grep("PIK3CA", data$strat_post_ac_death_HR),]$strat_post_ac_death_HR
data$p1 <- NA
data[grep("Low intensity", data$strat_post_ac_death_HR),]$p1 <- data[grep("Low intensity", data$strat_post_ac_death_HR),]$strat_post_ac_death_HR
data$post_ac_death_HR_strat_low_intensity_users <- sapply(data$p1, function(x) strsplit(x, "1.5 years", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "1.5 years", fixed = TRUE)[[1]][2])
#for Barron 2015 I am taking multivariate not univariate HRs
data$p4 <- sapply(data$post_ac_death_HR_strat_low_intensity_users, function(x) strsplit(x, "(0.77-1.34)", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$post_ac_death_HR_strat_low_intensity_users, function(x) strsplit(x, "(0.77-1.34)", fixed = TRUE)[[1]][2])
data$post_ac_death_HR_strat_low_intensity_users <- gsub("[^0-9]", "", data$post_ac_death_HR_strat_low_intensity_users)
data$post_ac_death_HR_strat_low_intensity_deaths <- data$post_ac_death_HR_strat_low_intensity_users
data$post_ac_death_HR_strat_high_intensity_users <- data$post_ac_death_HR_strat_low_intensity_users
data$post_ac_death_HR_strat_high_intensity_deaths <- data$post_ac_death_HR_strat_low_intensity_users
data$post_ac_death_HR_strat_low_intensity_users <- gsub("5210307713409907413249789135107170119094150", "", data$post_ac_death_HR_strat_low_intensity_users)
data$post_ac_death_HR_strat_low_intensity_deaths <- gsub("2675210307713409907413249789135107170119094150", "52", data$post_ac_death_HR_strat_low_intensity_deaths)
data$post_ac_death_HR_strat_high_intensity_users <- gsub("2675210307713409907413249789135107170119094150", "497", data$post_ac_death_HR_strat_high_intensity_users)
data$post_ac_death_HR_strat_high_intensity_deaths <- gsub("2675210307713409907413249789135107170119094150", "89", data$post_ac_death_HR_strat_high_intensity_deaths)
data$p6 <- sapply(data$p5, function(x) strsplit(x, "aspirin users", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p5, function(x) strsplit(x, "aspirin users", fixed = TRUE)[[1]][2])
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$post_ac_death_strat_low_intensity_users_HR <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_low_intensity_users_HR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_low_intensity_users_HR_CI_lower <- sapply(data$post_ac_death_strat_low_intensity_users_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_low_intensity_users_HR_CI_upper <- sapply(data$post_ac_death_strat_low_intensity_users_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p7, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$p9 <- gsub("[^0-9.(-]", "", data$p9)
data$post_ac_death_strat_high_intensity_users_HR <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_high_intensity_users_HR_CI <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_high_intensity_users_HR_CI_lower <- sapply(data$post_ac_death_strat_high_intensity_users_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_high_intensity_users_HR_CI_upper <- sapply(data$post_ac_death_strat_high_intensity_users_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:400, 418, 422, 427:430, 423, 424, 433:436, 401:416)]
data$p1 <- sapply(data$post_ac_death_HR_strat_PIK3CA, function(x) strsplit(x, "slightly", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_ac_death_HR_strat_PIK3CA, function(x) strsplit(x, "slightly", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$post_ac_death_HR_strat_PIK3CA, function(x) strsplit(x, "non-aspirin", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$post_ac_death_HR_strat_PIK3CA, function(x) strsplit(x, "non-aspirin", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "325", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "325", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p6, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_ac_death_strat_325vs81mguse_HR <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_325vs81mguse_HR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_325vs81mguse_HR_CI_lower <- sapply(data$post_ac_death_strat_325vs81mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_325vs81mguse_HR_CI_upper <- sapply(data$post_ac_death_strat_325vs81mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p9 <- sapply(data$p5, function(x) strsplit(x, "slightly", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p5, function(x) strsplit(x, "slightly", fixed = TRUE)[[1]][2])
data$p9 <- gsub("95%", "", data$p9)
data$p9 <- gsub("[^0-9.,-]", "", data$p9)
#note patients with PIK3CA mutations in Zhou 2019 all had HR+/HER2- subtype as well as being PIK3CA mutant, whereas for McCarthy 2020 it is not mentioned whether the people with PIK3CA mutation had other mutations
data$p19 <- sapply(data$p9, function(x) strsplit(x, ",", fixed = TRUE)[[1]][1])
data$p20 <- sapply(data$p9, function(x) strsplit(x, ",", fixed = TRUE)[[1]][2])
data$p21 <- sapply(data$p20, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p22 <- sapply(data$p20, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p10 <- gsub("[^0-9.(-]", "", data$p10)
data$p23 <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$p24 <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$p25 <- sapply(data$p24, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p26 <- sapply(data$p24, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p11 <- sapply(data$p3, function(x) strsplit(x, "users, association", fixed = TRUE)[[1]][1])
data$p12 <- sapply(data$p3, function(x) strsplit(x, "users, association", fixed = TRUE)[[1]][2])
data$p13 <- sapply(data$p3, function(x) strsplit(x, "non-users, association", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p3, function(x) strsplit(x, "non-users, association", fixed = TRUE)[[1]][2])
data$p12 <- gsub("PIK3CA", "", data$p12)
data$p14 <- gsub("PIK3CA", "", data$p14)
data$p12 <- gsub("[^0-9.(-]", "", data$p12)
data$p15 <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$p16 <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$p17 <- sapply(data$p16, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p18 <- sapply(data$p16, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p14 <- gsub("[^0-9.(-]", "", data$p14)
data$p27 <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$p28 <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$p29 <- sapply(data$p28, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p30 <- sapply(data$p28, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR, p19, p27, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI, p20, p28, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_lower, p21, p29, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_lower <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_lower)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_upper, p22, p30, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_upper <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_nonusers_HR_CI_upper)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR, p15, p23, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI, p16, p24, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_lower, p17, p25, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_lower <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_lower)
data <- data %>% unite(post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_upper, p18, p26, sep = "")
data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_upper <- gsub("NA", "", data$post_ac_death_strat_PIK3CA_mutant_aspirin_users_HR_CI_upper)
data <- data[, c(1:412, 437:440, 443:450, 413:427)]
data$p1 <- NA
data[grep("Stratified by dose", data$strat_post_ac_death_HR),]$p1 <- data[grep("Stratified by dose", data$strat_post_ac_death_HR),]$strat_post_ac_death_HR
data$p2 <- sapply(data$p1, function(x) strsplit(x, "365-730", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "365-730", fixed = TRUE)[[1]][2])
#for all columns created hereafter from McMenamin 2017 I will use adjusted HRs
data$post_ac_death_strat_HR_1to365_tabs_users <- sapply(data$p2, function(x) strsplit(x, "(1.84-2.43)", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p2, function(x) strsplit(x, "(1.84-2.43)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_1to365_tabs_users <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_1to365_tabs_users)
data$post_ac_death_strat_HR_1to365_tabs_deaths <- data$post_ac_death_strat_HR_1to365_tabs_users
data$post_ac_death_strat_HR_1to365_tabs_users <- gsub("13658362853252211", "836", data$post_ac_death_strat_HR_1to365_tabs_users)
data$post_ac_death_strat_HR_1to365_tabs_deaths <- gsub("13658362853252211", "252", data$post_ac_death_strat_HR_1to365_tabs_deaths)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$post_ac_death_strat_1to365_tabs_HR <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_1to365_tabs_HR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_1to365_tabs_HR_CI_lower <- sapply(data$post_ac_death_strat_1to365_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_1to365_tabs_HR_CI_upper <- sapply(data$post_ac_death_strat_1to365_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p6 <- sapply(data$p3, function(x) strsplit(x, "730-1095", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p3, function(x) strsplit(x, "730-1095", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_365to730_tabs_users <- sapply(data$p6, function(x) strsplit(x, "(1.90-2.58)", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "(1.90-2.58)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_365to730_tabs_users <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_365to730_tabs_users)
data$post_ac_death_strat_HR_365to730_tabs_deaths <- data$post_ac_death_strat_HR_365to730_tabs_users
data$post_ac_death_strat_HR_365to730_tabs_users <- gsub("6922098194222", "692", data$post_ac_death_strat_HR_365to730_tabs_users)
data$post_ac_death_strat_HR_365to730_tabs_deaths <- gsub("6922098194222", "194", data$post_ac_death_strat_HR_365to730_tabs_deaths)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_ac_death_strat_365to730_tabs_HR <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_365to730_tabs_HR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_365to730_tabs_HR_CI_lower <- sapply(data$post_ac_death_strat_365to730_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_365to730_tabs_HR_CI_upper <- sapply(data$post_ac_death_strat_365to730_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "1095+", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p7, function(x) strsplit(x, "1095+", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_730to1095_tabs_users <- sapply(data$p9, function(x) strsplit(x, "(1.74-2.70)", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "(1.74-2.70)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_730to1095_tabs_users <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_730to1095_tabs_users)
data$post_ac_death_strat_HR_730to1095_tabs_deaths <- data$post_ac_death_strat_HR_730to1095_tabs_users
data$post_ac_death_strat_HR_730to1095_tabs_users <- gsub("548107490217", "548", data$post_ac_death_strat_HR_730to1095_tabs_users)
data$post_ac_death_strat_HR_730to1095_tabs_deaths <- gsub("548107490217", "90", data$post_ac_death_strat_HR_730to1095_tabs_deaths)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$post_ac_death_strat_730to1095_tabs_HR <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_730to1095_tabs_HR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_730to1095_tabs_HR_CI_lower <- sapply(data$post_ac_death_strat_730to1095_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_730to1095_tabs_HR_CI_upper <- sapply(data$post_ac_death_strat_730to1095_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p12 <- sapply(data$p10, function(x) strsplit(x, "Stratified by stage:", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p10, function(x) strsplit(x, "Stratified by stage:", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_1095plus_tabs_users <- sapply(data$p12, function(x) strsplit(x, "(1.88-3.16)", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p12, function(x) strsplit(x, "(1.88-3.16)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_1095plus_tabs_users <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_1095plus_tabs_users)
data$post_ac_death_strat_HR_1095plus_tabs_deaths <- data$post_ac_death_strat_HR_1095plus_tabs_users
data$post_ac_death_strat_HR_1095plus_tabs_users <- gsub("74679666244", "746", data$post_ac_death_strat_HR_1095plus_tabs_users)
data$post_ac_death_strat_HR_1095plus_tabs_deaths <- gsub("74679666244", "66", data$post_ac_death_strat_HR_1095plus_tabs_deaths)
data$p14 <- gsub("[^0-9.(-]", "", data$p14)
data$post_ac_death_strat_1095plus_tabs_HR <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_1095plus_tabs_HR_CI <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_1095plus_tabs_HR_CI_lower <- sapply(data$post_ac_death_strat_1095plus_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_1095plus_tabs_HR_CI_upper <- sapply(data$post_ac_death_strat_1095plus_tabs_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p15 <- sapply(data$p13, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][1])
data$p16 <- sapply(data$p13, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageI_nonusers <- sapply(data$p15, function(x) strsplit(x, "(1.41-2.40)", fixed = TRUE)[[1]][1])
data$p17 <- sapply(data$p15, function(x) strsplit(x, "(1.41-2.40)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageI_nonusers <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_StageI_nonusers)
data$post_ac_death_strat_HR_StageI_nonuser_deaths <- data$post_ac_death_strat_HR_StageI_nonusers
data$post_ac_death_strat_HR_StageI_users <- data$post_ac_death_strat_HR_StageI_nonusers
data$post_ac_death_strat_HR_StageI_user_deaths<- data$post_ac_death_strat_HR_StageI_nonusers
data$post_ac_death_strat_HR_StageI_nonusers <- gsub("729882566217495314358184", "4953", data$post_ac_death_strat_HR_StageI_nonusers)
data$post_ac_death_strat_HR_StageI_nonuser_deaths <- gsub("729882566217495314358184", "217", data$post_ac_death_strat_HR_StageI_nonuser_deaths)
data$post_ac_death_strat_HR_StageI_users <- gsub("729882566217495314358184", "988", data$post_ac_death_strat_HR_StageI_users)
data$post_ac_death_strat_HR_StageI_user_deaths <- gsub("729882566217495314358184", "72", data$post_ac_death_strat_HR_StageI_user_deaths)
data$p17 <- gsub("[^0-9.()-]", "", data$p17)
data$p17 <- gsub(").", "", data$p17)
data$post_ac_death_strat_StageI_HR <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageI_HR_CI <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_StageI_HR_CI_lower <- sapply(data$post_ac_death_strat_StageI_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageI_HR_CI_upper <- sapply(data$post_ac_death_strat_StageI_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p18 <- sapply(data$p13, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][1])
data$p19 <- sapply(data$p13, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][2])
data$p20 <- sapply(data$p18, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][1])
data$p21 <- sapply(data$p18, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageII_nonusers <- sapply(data$p21, function(x) strsplit(x, "(1.96-2.81)", fixed = TRUE)[[1]][1])
data$p22 <- sapply(data$p21, function(x) strsplit(x, "(1.96-2.81)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageII_nonusers <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_StageII_nonusers)
data$post_ac_death_strat_HR_StageII_nonuser_deaths <- data$post_ac_death_strat_HR_StageII_nonusers
data$post_ac_death_strat_HR_StageII_users <- data$post_ac_death_strat_HR_StageII_nonusers
data$post_ac_death_strat_HR_StageII_user_deaths<- data$post_ac_death_strat_HR_StageII_nonusers
data$post_ac_death_strat_HR_StageII_nonusers <- gsub("1709992484392471213445235", "4712", data$post_ac_death_strat_HR_StageII_nonusers)
data$post_ac_death_strat_HR_StageII_nonuser_deaths <- gsub("1709992484392471213445235", "392", data$post_ac_death_strat_HR_StageII_nonuser_deaths)
data$post_ac_death_strat_HR_StageII_users <- gsub("1709992484392471213445235", "999", data$post_ac_death_strat_HR_StageII_users)
data$post_ac_death_strat_HR_StageII_user_deaths <- gsub("1709992484392471213445235", "170", data$post_ac_death_strat_HR_StageII_user_deaths)
data$p22 <- gsub("[^0-9.(-]", "", data$p22)
data$post_ac_death_strat_StageII_HR <- sapply(data$p22, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageII_HR_CI <- sapply(data$p22, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_StageII_HR_CI_lower <- sapply(data$post_ac_death_strat_StageII_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageII_HR_CI_upper <- sapply(data$post_ac_death_strat_StageII_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p23 <- sapply(data$p19, function(x) strsplit(x, "Stage IV", fixed = TRUE)[[1]][1])
data$p24 <- sapply(data$p19, function(x) strsplit(x, "Stage IV", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageIII_nonusers <- sapply(data$p23, function(x) strsplit(x, "(1.35-2.08)", fixed = TRUE)[[1]][1])
data$p25 <- sapply(data$p23, function(x) strsplit(x, "(1.35-2.08)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageIII_nonusers <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_StageIII_nonusers)
data$post_ac_death_strat_HR_StageIII_nonuser_deaths <- data$post_ac_death_strat_HR_StageIII_nonusers
data$post_ac_death_strat_HR_StageIII_users <- data$post_ac_death_strat_HR_StageIII_nonusers
data$post_ac_death_strat_HR_StageIII_user_deaths<- data$post_ac_death_strat_HR_StageIII_nonusers
data$post_ac_death_strat_HR_StageIII_nonusers <- gsub("11032974733514333771167", "1433", data$post_ac_death_strat_HR_StageIII_nonusers)
data$post_ac_death_strat_HR_StageIII_nonuser_deaths <- gsub("11032974733514333771167", "335", data$post_ac_death_strat_HR_StageIII_nonuser_deaths)
data$post_ac_death_strat_HR_StageIII_users <- gsub("11032974733514333771167", "329", data$post_ac_death_strat_HR_StageIII_users)
data$post_ac_death_strat_HR_StageIII_user_deaths <- gsub("11032974733514333771167", "110", data$post_ac_death_strat_HR_StageIII_user_deaths)
data$p25 <- gsub("[^0-9.(-]", "", data$p25)
data$post_ac_death_strat_StageIII_HR <- sapply(data$p25, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageIII_HR_CI <- sapply(data$p25, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_StageIII_HR_CI_lower <- sapply(data$post_ac_death_strat_StageIII_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageIII_HR_CI_upper <- sapply(data$post_ac_death_strat_StageIII_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p26 <- sapply(data$p24, function(x) strsplit(x, "molecular subtype", fixed = TRUE)[[1]][1])
data$p27 <- sapply(data$p24, function(x) strsplit(x, "molecular subtype", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageIV_nonusers <- sapply(data$p26, function(x) strsplit(x, "(0.97-1.75)", fixed = TRUE)[[1]][1])
data$p28 <- sapply(data$p26, function(x) strsplit(x, "(0.97-1.75)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_StageIV_nonusers <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_StageIV_nonusers)
data$post_ac_death_strat_HR_StageIV_nonuser_deaths <- data$post_ac_death_strat_HR_StageIV_nonusers
data$post_ac_death_strat_HR_StageIV_users <- data$post_ac_death_strat_HR_StageIV_nonusers
data$post_ac_death_strat_HR_StageIV_user_deaths<- data$post_ac_death_strat_HR_StageIV_nonusers
data$post_ac_death_strat_HR_StageIV_nonusers <- gsub("57111208207473933131", "473", data$post_ac_death_strat_HR_StageIV_nonusers)
data$post_ac_death_strat_HR_StageIV_nonuser_deaths <- gsub("57111208207473933131", "207", data$post_ac_death_strat_HR_StageIV_nonuser_deaths)
data$post_ac_death_strat_HR_StageIV_users <- gsub("57111208207473933131", "111", data$post_ac_death_strat_HR_StageIV_users)
data$post_ac_death_strat_HR_StageIV_user_deaths <- gsub("57111208207473933131", "57", data$post_ac_death_strat_HR_StageIV_user_deaths)
data$p28 <- gsub("[^0-9.(-]", "", data$p28)
data$post_ac_death_strat_StageIV_HR <- sapply(data$p28, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageIV_HR_CI <- sapply(data$p28, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_StageIV_HR_CI_lower <- sapply(data$post_ac_death_strat_StageIV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_StageIV_HR_CI_upper <- sapply(data$post_ac_death_strat_StageIV_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p29 <- sapply(data$p27, function(x) strsplit(x, "Multivariate", fixed = TRUE)[[1]][1])
data$p30 <- sapply(data$p27, function(x) strsplit(x, "Multivariate", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_ERpos_nonusers <- sapply(data$p29, function(x) strsplit(x, "(2.06-2.56)", fixed = TRUE)[[1]][1])
data$p31 <- sapply(data$p29, function(x) strsplit(x, "(2.06-2.56)", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_HR_ERpos_nonusers <- gsub("[^0-9]", "", data$post_ac_death_strat_HR_ERpos_nonusers)
data$post_ac_death_strat_HR_ERpos_nonuser_deaths <- data$post_ac_death_strat_HR_ERpos_nonusers
data$post_ac_death_strat_HR_ERpos_users <- data$post_ac_death_strat_HR_ERpos_nonusers
data$post_ac_death_strat_HR_ERpos_user_deaths<- data$post_ac_death_strat_HR_ERpos_nonusers
data$post_ac_death_strat_HR_ERpos_nonusers <- gsub("4772423588710181022728793230", "10227", data$post_ac_death_strat_HR_ERpos_nonusers)
data$post_ac_death_strat_HR_ERpos_nonuser_deaths <- gsub("4772423588710181022728793230", "1018", data$post_ac_death_strat_HR_ERpos_nonuser_deaths)
data$post_ac_death_strat_HR_ERpos_users <- gsub("4772423588710181022728793230", "2423", data$post_ac_death_strat_HR_ERpos_users)
data$post_ac_death_strat_HR_ERpos_user_deaths <- gsub("4772423588710181022728793230", "477", data$post_ac_death_strat_HR_ERpos_user_deaths)
data$p31 <- gsub("[^0-9.()-]", "", data$p31)
data$p31 <- gsub(").", "", data$p31)
data$post_ac_death_strat_ERpos_HR <- sapply(data$p31, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_ERpos_HR_CI <- sapply(data$p31, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_strat_ERpos_HR_CI_lower <- sapply(data$post_ac_death_strat_ERpos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_strat_ERpos_HR_CI_upper <- sapply(data$post_ac_death_strat_ERpos_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:424, 443, 445:449, 452, 454:458, 461, 463:467, 470, 472:476, 479, 481:487, 492, 494:500, 503, 505:511, 514, 516:522, 525, 527:533, 425:439)]
#clean unadj post rec RR
#again for Holmes 2010 I am using the 6-7 days a week data, but will keep 1 day and 2-5 days data in a separate column 
data$p1 <- sapply(data$post_rec_unadj_RR, function(x) strsplit(x, "2-5", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_rec_unadj_RR, function(x) strsplit(x, "2-5", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "past aspirin group", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p3, function(x) strsplit(x, "past aspirin group", fixed = TRUE)[[1]][2])
data$p5 <- gsub("0.89", "", data$p5)
data$p5 <- gsub("(0.67-1.19)", "", data$p5)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p7 <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$p9 <- sapply(data$p8, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p8, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p2 <- gsub("6-7", "", data$p2)
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$p11 <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$p12 <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$p13 <- sapply(data$p12, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p12, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data %>% unite(post_rec_unadj_RR_only, p7, p11, sep = "")
data$post_rec_unadj_RR_only <- gsub("NA", "", data$post_rec_unadj_RR_only)
data <- data %>% unite(post_rec_unadj_RR_CI, p8, p12, sep = "")
data$post_rec_unadj_RR_CI <- gsub("NA", "", data$post_rec_unadj_RR_CI)
data <- data %>% unite(post_rec_unadj_RR_CI_lower, p9, p13, sep = "")
data$post_rec_unadj_RR_CI_lower <- gsub("NA", "", data$post_rec_unadj_RR_CI_lower)
data <- data %>% unite(post_rec_unadj_RR_CI_upper, p10, p14, sep = "")
data$post_rec_unadj_RR_CI_upper <- gsub("NA", "", data$post_rec_unadj_RR_CI_upper)
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$post_rec_unadj_1dayaweekuse_RR <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_unadj_1dayaweekuse_RR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_unadj_1dayaweekuse_RR_CI_lower <- sapply(data$post_rec_unadj_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_unadj_1dayaweekuse_RR_CI_upper <- sapply(data$post_rec_unadj_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p4 <- gsub("[^0-9.(-]", "", data$p4)
data$post_rec_unadj_2to5daysaweekuse_RR <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_unadj_2to5daysaweekuse_RR_CI <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_unadj_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_rec_unadj_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_unadj_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_rec_unadj_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:492, 510:521, 493:503)]
#clean post rec unadj HR
#for Williams 2018 I am going to treat DFS HR the same as a recurrence HR and include it in the main column 
data$post_rec_unadj_HR <- gsub("95% CI", "", data$post_rec_unadj_HR)
data$post_rec_unadj_HR <- gsub("[^0-9.(-]", "", data$post_rec_unadj_HR)
data$post_rec_unadj_HR_only <- sapply(data$post_rec_unadj_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_unadj_HR_CI <- sapply(data$post_rec_unadj_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_unadj_HR_CI_lower <- sapply(data$post_rec_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_unadj_HR_CI_upper <- sapply(data$post_rec_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:505, 516:519, 506:515)]
#clean post rec adj RR
#again for Holmes 2010 I am keeping 6-7 days use in main column and saving 1 and 2-5 days use seperately 
data$post_rec_adj_RR <- gsub("1.03", "", data$post_rec_adj_RR)
data$post_rec_adj_RR <- gsub("(0.76-1.39)", "", data$post_rec_adj_RR)
data$p1 <- sapply(data$post_rec_adj_RR, function(x) strsplit(x, "*", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_rec_adj_RR, function(x) strsplit(x, "*", fixed = TRUE)[[1]][2])
data$p2 <- gsub("6-7", "", data$p2)
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$post_rec_adj_RR_only <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_adj_RR_CI <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_adj_RR_CI_lower <- sapply(data$post_rec_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_adj_RR_CI_upper <- sapply(data$post_rec_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p6 <- gsub("2-5 days", "", data$p6)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$post_rec_1dayaweekuse_adj_RR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_1dayaweekuse_adj_RR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_1dayaweekuse_adj_RR_CI_lower <- sapply(data$post_rec_1dayaweekuse_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_1dayaweekuse_adj_RR_CI_upper <- sapply(data$post_rec_1dayaweekuse_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$post_rec_2to5daysaweekuse_adj_RR_only <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_2to5daysaweekuse_adj_RR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_2to5daysaweekuse_adj_RR_CI_lower <- sapply(data$post_rec_2to5daysaweekuse_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_2to5daysaweekuse_adj_RR_CI_upper <- sapply(data$post_rec_2to5daysaweekuse_adj_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:511, 522:525, 530:537, 512:519)]
#clean post rec adj HR
data$post_rec_adj_HR <- gsub("HR", "", data$post_rec_adj_HR)
data$post_rec_adj_HR <- gsub(")", "", data$post_rec_adj_HR)
data$post_rec_adj_HR_only <- sapply(data$post_rec_adj_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_rec_adj_HR_CI <- sapply(data$post_rec_adj_HR, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_rec_adj_HR_CI_lower <- sapply(data$post_rec_adj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_rec_adj_HR_CI_upper <- sapply(data$post_rec_adj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:524, 532:535, 525:531)]
#no point cleaning stratified post recurrence as nothing to compare it to
#no point cleaning post progression stuff yet as only one row per column has data
#go back and clean any missed columns 
#clean pre bc death dose OR
data$pre_bc_death_dose_1to11 <- sapply(data$pre_bc_death_dose_OR, function(x) strsplit(x, "12+", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_12plus <- sapply(data$pre_bc_death_dose_OR, function(x) strsplit(x, "12+", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_1to11 <- gsub("1 to 11", "", data$pre_bc_death_dose_1to11)
data$pre_bc_death_dose_1to11 <- gsub("pre-diagnostic", "", data$pre_bc_death_dose_1to11)
data$pre_bc_death_dose_1to11 <- gsub("low-dose", "", data$pre_bc_death_dose_1to11)
data$pre_bc_death_dose_1to11 <- gsub("[^0-9.(-]", "", data$pre_bc_death_dose_1to11)
data$pre_bc_death_dose_1to11_OR_only <- sapply(data$pre_bc_death_dose_1to11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_1to11_OR_CI <- sapply(data$pre_bc_death_dose_1to11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_1to11_OR_CI_lower <- sapply(data$pre_bc_death_dose_1to11_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_1to11_OR_CI_upper <- sapply(data$pre_bc_death_dose_1to11_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_12plus <- gsub("pre-diagnostic", "", data$pre_bc_death_dose_12plus)
data$pre_bc_death_dose_12plus <- gsub("low-dose", "", data$pre_bc_death_dose_12plus)
data$pre_bc_death_dose_12plus <- gsub("[^0-9.(-]", "", data$pre_bc_death_dose_12plus)
data$pre_bc_death_dose_12plus_OR_only <- sapply(data$pre_bc_death_dose_12plus, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_12plus_OR_CI <- sapply(data$pre_bc_death_dose_12plus, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_12plus_OR_CI_lower <- sapply(data$pre_bc_death_dose_12plus_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_12plus_OR_CI_upper <- sapply(data$pre_bc_death_dose_12plus_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:114, 536:545, 115:535)]
#clean pre bc death dose HR
#for Loomans-Kropp 2021 I am using the adjusted data
#for Frisk 2018 I am using adjusted Model B data
#for Wang 2018 I am using multivariable adjusted data. I am keeping data on <7 times a week and >7 times a week use, as well as regular vs nonregular use
data$p1 <- sapply(data$pre_bc_death_dose_HR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$pre_bc_death_dose_HR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$pre_bc_death_dose_HR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][3])
data$p4 <- sapply(data$p2, function(x) strsplit(x, ">75", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p2, function(x) strsplit(x, ">75", fixed = TRUE)[[1]][2])
data$p4 <- gsub("[^0-9.()-]", "", data$p4)
data$p4 <- gsub(").", "", data$p4)
data$pre_bc_death_dose_lessthan75mguse_HR_only <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthan75mguse_HR_CI <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_lessthan75mguse_HR_CI_lower <- sapply(data$pre_bc_death_dose_lessthan75mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthan75mguse_HR_CI_upper <- sapply(data$pre_bc_death_dose_lessthan75mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p3 <- gsub("[^0-9.()-]", "", data$p3)
data$p3 <- gsub(").", "", data$p3)
data$pre_bc_death_dose_greaterthan75mguse_HR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthan75mguse_HR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_greaterthan75mguse_HR_CI_lower <- sapply(data$pre_bc_death_dose_greaterthan75mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthan75mguse_HR_CI_upper <- sapply(data$pre_bc_death_dose_greaterthan75mguse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:125, 551:558, 126:545)]
data$p1 <- sapply(data$pre_bc_death_dose_HR, function(x) strsplit(x, "Adjusted: Aspirin use", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$pre_bc_death_dose_HR, function(x) strsplit(x, "Adjusted: Aspirin use", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$p3 <- gsub("3", "", data$p3)
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_CI_lower <- sapply(data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_CI_upper <- sapply(data$pre_bc_death_dose_greaterthan3timesaweekuse_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:133, 558:561, 134:554)]
data$p2 <- sapply(data$p1, function(x) strsplit(x, "pill per day", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "pill per day", fixed = TRUE)[[1]][2])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "pill per day", fixed = TRUE)[[1]][3])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p4, function(x) strsplit(x, "multivariate", fixed = TRUE)[[1]][3])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "Univariate", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p6, function(x) strsplit(x, "Univariate", fixed = TRUE)[[1]][2])
data$p7 <- gsub(").", "", data$p7)
data$p8 <- gsub(").", "", data$p8)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$pre_bc_death_dose_lessthanonedailypill_HR_only <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthanonedailypill_HR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_lessthanonedailypill_HR_CI_lower <- sapply(data$pre_bc_death_dose_lessthanonedailypill_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthanonedailypill_HR_CI_upper <- sapply(data$pre_bc_death_dose_lessthanonedailypill_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
data$pre_bc_death_dose_greaterthanonedailypill_HR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthanonedailypill_HR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_greaterthanonedailypill_HR_CI_lower <- sapply(data$pre_bc_death_dose_greaterthanonedailypill_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_greaterthanonedailypill_HR_CI_upper <- sapply(data$pre_bc_death_dose_greaterthanonedailypill_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:137, 567:574, 138:557, 559)]
data$p3 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][3])
data$p6 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][4])
data$p7 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][5])
data$p8 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][6])
data$p9 <- sapply(data$p2, function(x) strsplit(x, "multivariable adjusted", fixed = TRUE)[[1]][7])
data$p10 <- sapply(data$p6, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p6, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][2])
data$p12 <- sapply(data$p7, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p7, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][2])
data$p14 <- sapply(data$p8, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][1])
data$p15 <- sapply(data$p8, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][2])
data$p16 <- sapply(data$p9, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][1])
data$p17 <- sapply(data$p9, function(x) strsplit(x, "followup truncated", fixed = TRUE)[[1]][2])
data$p10 <- gsub(").", "", data$p10)
data$p10 <- gsub("[^0-9.(-]", "", data$p10)
data$p12 <- gsub(").", "", data$p12)
data$p12 <- gsub("[^0-9.(-]", "", data$p12)
data$p14 <- gsub(").", "", data$p14)
data$p14 <- gsub("[^0-9.(-]", "", data$p14)
data$p16 <- gsub(").", "", data$p16)
data$p16 <- gsub("[^0-9.(-]", "", data$p16)
data$pre_bc_death_dose_lessthansevenweeklypills_HR_only <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthansevenweeklypills_HR_CI <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_lessthansevenweeklypills_HR_CI_lower <- sapply(data$pre_bc_death_dose_lessthansevenweeklypills_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_lessthansevenweeklypills_HR_CI_upper <- sapply(data$pre_bc_death_dose_lessthansevenweeklypills_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_morethansevenweeklypills_HR_only <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_morethansevenweeklypills_HR_CI <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_morethansevenweeklypills_HR_CI_lower <- sapply(data$pre_bc_death_dose_morethansevenweeklypills_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_morethansevenweeklypills_HR_CI_upper <- sapply(data$pre_bc_death_dose_morethansevenweeklypills_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_regular_vs_no_use_HR_only <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_regular_vs_no_use_HR_CI <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_regular_vs_no_use_HR_CI_lower <- sapply(data$pre_bc_death_dose_regular_vs_no_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_regular_vs_no_use_HR_CI_upper <- sapply(data$pre_bc_death_dose_regular_vs_no_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_irregular_vs_no_use_HR_only <- sapply(data$p16, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_irregular_vs_no_use_HR_CI <- sapply(data$p16, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_bc_death_dose_irregular_vs_no_use_HR_CI_lower <- sapply(data$pre_bc_death_dose_irregular_vs_no_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_bc_death_dose_irregular_vs_no_use_HR_CI_upper <- sapply(data$pre_bc_death_dose_irregular_vs_no_use_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:145, 582:597, 146:565)]
#clean unadj pre ac death OR
data$p1 <- sapply(data$unadj_pre_ac_death_OR, function(x) strsplit(x, "1 year", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$unadj_pre_ac_death_OR, function(x) strsplit(x, "1 year", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "after 3", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "after 3", fixed = TRUE)[[1]][2])
data$p4 <- gsub("5", "", data$p4)
data$p1 <- gsub("95%", "", data$p1)
data$p1 <- gsub("[^0-9.(-]", "", data$p1)
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$p4 <- gsub("[^0-9.(-]", "", data$p4)
data$placeholder <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after1year_OR_only <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_after1year_OR_CI <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][3])
data$unadj_pre_ac_death_after1year_OR_CI_lower <- sapply(data$unadj_pre_ac_death_after1year_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after1year_OR_CI_upper <- sapply(data$unadj_pre_ac_death_after1year_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_after3years_OR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after3years_OR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_after3years_OR_CI_lower <- sapply(data$unadj_pre_ac_death_after3years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after3years_OR_CI_upper <- sapply(data$unadj_pre_ac_death_after3years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_after5years_OR_only <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after5years_OR_CI <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_ac_death_after5years_OR_CI_lower <- sapply(data$unadj_pre_ac_death_after5years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_ac_death_after5years_OR_CI_upper <- sapply(data$unadj_pre_ac_death_after5years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:166, 587:598, 167:581)]
#clean pre rec unadj OR
data$p1 <- sapply(data$pre_rec_unadj_OR, function(x) strsplit(x, "1 year", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$pre_rec_unadj_OR, function(x) strsplit(x, "1 year", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "after 3", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "after 3", fixed = TRUE)[[1]][2])
data$p4 <- gsub("5", "", data$p4)
data$p4 <- gsub("disease-free", "", data$p4)
data$p1 <- gsub("[^0-9.(-]", "", data$p1)
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$p4 <- gsub("[^0-9.(-]", "", data$p4)
data$unadj_pre_rec_after1year_OR_only <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after1year_OR_CI <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_after1year_OR_CI_lower <- sapply(data$unadj_pre_rec_after1year_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after1year_OR_CI_upper <- sapply(data$unadj_pre_rec_after1year_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_after3years_OR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after3years_OR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_after3years_OR_CI_lower <- sapply(data$unadj_pre_rec_after3years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after3years_OR_CI_upper <- sapply(data$unadj_pre_rec_after3years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_after5years_OR_only <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after5years_OR_CI <- sapply(data$p4, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_pre_rec_after5years_OR_CI_lower <- sapply(data$unadj_pre_rec_after5years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_pre_rec_after5years_OR_CI_upper <- sapply(data$unadj_pre_rec_after5years_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:193, 598:609, 194:593)]
#clean pre unadj rec RR
#for this I'm going to use ever use instead of pre and postdiagnostic
data$p1 <- sapply(data$pre_rec_unadj_RR, function(x) strsplit(x, "Ever", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$pre_rec_unadj_RR, function(x) strsplit(x, "Ever", fixed = TRUE)[[1]][2])
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$pre_unadj_rec_RR_only <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_unadj_rec_RR_CI <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_unadj_rec_RR_CI_lower <- sapply(data$pre_unadj_rec_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_unadj_rec_RR_CI_upper <- sapply(data$pre_unadj_rec_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:206, 608:611, 207:605)]
#clean pre adj rec RR
#once again using ever use
data$p1 <- sapply(data$pre_rec_adj_RR, function(x) strsplit(x, "Ever", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$pre_rec_adj_RR, function(x) strsplit(x, "Ever", fixed = TRUE)[[1]][2])
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$pre_adj_rec_RR_only <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$pre_adj_rec_RR_CI <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$pre_adj_rec_RR_CI_lower <- sapply(data$pre_adj_rec_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$pre_adj_rec_RR_CI_upper <- sapply(data$pre_adj_rec_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:217, 612:615, 218:609)]
#still no point cleaning stratified pre recurrence as no points of comparison
#ditto pre progression
#clean unadj post death RR
#Split into 1 day, 2-5 days and 6-7 days pw use
data$p1 <- sapply(data$unadj_post_bc_death_RR, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$unadj_post_bc_death_RR, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][2])
data$p6 <- gsub("6-7 days", "", data$p6)
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$post_bc_death_1dayaweekuse_RR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_1dayaweekuse_RR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_2to5daysaweekuse_RR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_2to5daysaweekuse_RR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_6to7daysaweekuse_RR_only <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_6to7daysaweekuse_RR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_6to7daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_6to7daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:234, 620:631, 235:613)]
#clean post bc death stage strat RR
#same again- columns for 1 day, 2-5 days and 6-7 days pw use (for each stage)
data$p1 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p6, function(x) strsplit(x, "6-7 days", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "6-7 days", fixed = TRUE)[[1]][2])
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
data$post_bc_death_stage_I_1dayaweekuse_RR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_1dayaweekuse_RR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_I_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_I_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_I_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_I_2to5daysaweekuse_RR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_2to5daysaweekuse_RR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_I_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_I_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_I_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_I_6to7daysaweekuse_RR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_6to7daysaweekuse_RR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_I_6to7daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_I_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_I_6to7daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_I_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:290, 634:645, 291:625)]
data$p1 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "Stage II", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p6, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][2])
data$p8 <- gsub("6-7", "", data$p8)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_bc_death_stage_II_1dayaweekuse_RR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_1dayaweekuse_RR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_II_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_II_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_2to5daysaweekuse_RR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_2to5daysaweekuse_RR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_II_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_II_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_6to7daysaweekuse_RR_only <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_6to7daysaweekuse_RR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_II_6to7daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_II_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_II_6to7daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_II_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:302, 646:657, 303:637)]
data$p1 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_stage_RR, function(x) strsplit(x, "Stage III", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, "past aspirin", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "1 day", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p6, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][1])
data$p8 <- sapply(data$p6, function(x) strsplit(x, "2-5 days", fixed = TRUE)[[1]][2])
data$p8 <- gsub("6-7", "", data$p8)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_bc_death_stage_III_1dayaweekuse_RR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_1dayaweekuse_RR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_1dayaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_III_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_1dayaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_III_1dayaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_2to5daysaweekuse_RR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_2to5daysaweekuse_RR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_2to5daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_III_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_2to5daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_III_2to5daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_6to7daysaweekuse_RR_only <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_6to7daysaweekuse_RR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage_III_6to7daysaweekuse_RR_CI_lower <- sapply(data$post_bc_death_stage_III_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage_III_6to7daysaweekuse_RR_CI_upper <- sapply(data$post_bc_death_stage_III_6to7daysaweekuse_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:314, 658:669, 315:649)]
#clean post bc death adj OR
#for this I will use the model B data
data$p1 <- sapply(data$adj_post_bc_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$adj_post_bc_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][2])
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$post_adj_bc_death_OR_only <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_adj_bc_death_OR_CI <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_adj_bc_death_OR_CI_lower <- sapply(data$post_adj_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_adj_bc_death_OR_CI_upper <- sapply(data$post_adj_bc_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:263, 664:667, 264:661)]
#clean post bc death stage OR 
data$p1 <- sapply(data$post_bc_death_stage_OR, function(x) strsplit(x, "Stage 3 and 4", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_stage_OR, function(x) strsplit(x, "Stage 3 and 4", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p4, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][3])
data$p5 <- gsub("non-exposed", "", data$p5)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p6 <- gsub("1-11", "", data$p6)
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$p7 <- gsub("12+", "", data$p7)
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
#here "stage 1 and 2 only" (and later "stage 3 and 4 only") refers to the exposed vs nonexposed data from stage 1 and 2 patients
data$post_bc_death_stage1and2_OR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_OR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1and2_OR_CI_lower <- sapply(data$post_bc_death_stage1and2_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_OR_CI_upper <- sapply(data$post_bc_death_stage1and2_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1and2_1to11prescriptions_OR_only <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_1to11prescriptions_OR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1and2_1to11prescriptions_OR_CI_lower <- sapply(data$post_bc_death_stage1and2_1to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_1to11prescriptions_OR_CI_upper <- sapply(data$post_bc_death_stage1and2_1to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_CI_lower <- sapply(data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_CI_upper <- sapply(data$post_bc_death_stage1and2_twelveplus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p2, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p2, function(x) strsplit(x, "Unadjusted", fixed = TRUE)[[1]][2])
data$p10 <- sapply(data$p9, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p9, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][2])
data$p12 <- sapply(data$p9, function(x) strsplit(x, "unadjusted", fixed = TRUE)[[1]][3])
data$p10 <- gsub("non-exposed", "", data$p10)
data$p10 <- gsub("[^0-9.(-]", "", data$p10)
data$p11 <- gsub("1-11", "", data$p11)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$p13 <- sapply(data$p12, function(x) strsplit(x, "prescriptions", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p12, function(x) strsplit(x, "prescriptions", fixed = TRUE)[[1]][2])
data$p14 <- gsub("[^0-9.()-]", "", data$p14)
data$p14 <- gsub(").", "", data$p14)
data$post_bc_death_stage3and4_OR_only <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_OR_CI <- sapply(data$p10, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3and4_OR_CI_lower <- sapply(data$post_bc_death_stage3and4_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_OR_CI_upper <- sapply(data$post_bc_death_stage3and4_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3and4_1to11prescriptions_OR_only <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_1to11prescriptions_OR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3and4_1to11prescriptions_OR_CI_lower <- sapply(data$post_bc_death_stage3and4_1to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_1to11prescriptions_OR_CI_upper <- sapply(data$post_bc_death_stage3and4_1to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_only <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_CI <- sapply(data$p14, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_CI_lower <- sapply(data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_CI_upper <- sapply(data$post_bc_death_stage3and4_twelveplus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:331, 673:684, 692:703, 332:665)]
#extract unadjusted values from post bc death stage HR
data$p1 <- NA
data[grep("Unadjusted", data$post_bc_death_stage_HR, ignore.case = FALSE),]$p1 <- data[grep("Unadjusted", data$post_bc_death_stage_HR, ignore.case = FALSE),]$post_bc_death_stage_HR
data$p2 <- sapply(data$p1, function(x) strsplit(x, "14,358", fixed = TRUE)[[1]][1])
data$p3 <- sapply(data$p1, function(x) strsplit(x, "14,358", fixed = TRUE)[[1]][2])
data$p4 <- sapply(data$p3, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][1])
data$p5 <- sapply(data$p3, function(x) strsplit(x, "adjusted", fixed = TRUE)[[1]][2])
data$p6 <- sapply(data$p3, function(x) strsplit(x, "13,445", fixed = TRUE)[[1]][1])
data$p7 <- sapply(data$p3, function(x) strsplit(x, "13,445", fixed = TRUE)[[1]][2])
data$p8 <- sapply(data$p7, function(x) strsplit(x, "1.13", fixed = TRUE)[[1]][1])
data$p9 <- sapply(data$p7, function(x) strsplit(x, "1.13", fixed = TRUE)[[1]][2])
data$p10 <- sapply(data$p7, function(x) strsplit(x, "3771", fixed = TRUE)[[1]][1])
data$p11 <- sapply(data$p7, function(x) strsplit(x, "3771", fixed = TRUE)[[1]][2])
data$p12 <- sapply(data$p11, function(x) strsplit(x, ";", fixed = TRUE)[[1]][1])
data$p13 <- sapply(data$p11, function(x) strsplit(x, ";", fixed = TRUE)[[1]][2])
data$p14 <- sapply(data$p13, function(x) strsplit(x, "933", fixed = TRUE)[[1]][1])
data$p15 <- sapply(data$p13, function(x) strsplit(x, "933", fixed = TRUE)[[1]][2])
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$post_bc_death_stage1_unadj_HR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1_unadj_HR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage1_unadj_HR_CI_lower <- sapply(data$post_bc_death_stage1_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage1_unadj_HR_CI_upper <- sapply(data$post_bc_death_stage1_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p8 <- gsub("nonusers.", "", data$p8)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_bc_death_stage2_unadj_HR_only <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage2_unadj_HR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage2_unadj_HR_CI_lower <- sapply(data$post_bc_death_stage2_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage2_unadj_HR_CI_upper <- sapply(data$post_bc_death_stage2_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p12 <- gsub("nonusers.", "", data$p12)
data$p12 <- gsub("[^0-9.(-]", "", data$p12)
data$post_bc_death_stage3_unadj_HR_only <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3_unadj_HR_CI <- sapply(data$p12, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage3_unadj_HR_CI_lower <- sapply(data$post_bc_death_stage3_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage3_unadj_HR_CI_upper <- sapply(data$post_bc_death_stage3_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$p15 <- gsub("nonusers.", "", data$p15)
data$p15 <- gsub("[^0-9.(-]", "", data$p15)
data$post_bc_death_stage4_unadj_HR_only <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_stage4_unadj_HR_CI <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_stage4_unadj_HR_CI_lower <- sapply(data$post_bc_death_stage4_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_stage4_unadj_HR_CI_upper <- sapply(data$post_bc_death_stage4_unadj_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:388, 705:720, 389:689)]
#clean post bc death dose OR 
#I will be taking Model B adjusted HRs here
data$p1 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][3])
data$p4 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][4])
data$p5 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][5])
data$p6 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][6])
data$p7 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][7])
data$p8 <- sapply(data$post_bc_death_dose_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][8])
data$p9 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][2])
data$p11 <- sapply(data$p3, function(x) strsplit(x, ").", fixed = TRUE)[[1]][1])
data$p12 <- sapply(data$p3, function(x) strsplit(x, ").", fixed = TRUE)[[1]][2])
data$p13 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p15 <- sapply(data$p5, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p16 <- sapply(data$p5, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p17 <- sapply(data$p6, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p18 <- sapply(data$p6, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p19 <- sapply(data$p7, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p20 <- sapply(data$p7, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p21 <- sapply(data$p8, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p22 <- sapply(data$p8, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p9 <- gsub("[^0-9.(-]", "", data$p9)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$p13 <- gsub("[^0-9.(-]", "", data$p13)
data$p15 <- gsub("[^0-9.(-]", "", data$p15)
data$p17 <- gsub("[^0-9.(-]", "", data$p17)
data$p19 <- gsub("[^0-9.(-]", "", data$p19)
data$p21 <- gsub("[^0-9.(-]", "", data$p21)
data$post_bc_death_high_dose_OR_only <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_high_dose_OR_CI <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_high_dose_OR_CI_lower <- sapply(data$post_bc_death_high_dose_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_high_dose_OR_CI_upper <- sapply(data$post_bc_death_high_dose_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0to11prescriptions_OR_only <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0to11prescriptions_OR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0to11prescriptions_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0to11prescriptions_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_12plus_prescriptions_OR_only <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_12plus_prescriptions_OR_CI <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_12plus_prescriptions_OR_CI_lower <- sapply(data$post_bc_death_low_dose_12plus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_12plus_prescriptions_OR_CI_upper <- sapply(data$post_bc_death_low_dose_12plus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_1to365tabs_OR_only <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_1to365tabs_OR_CI <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_1to365tabs_OR_CI_lower <- sapply(data$post_bc_death_low_dose_1to365tabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_1to365tabs_OR_CI_upper <- sapply(data$post_bc_death_low_dose_1to365tabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_366plustabs_OR_only <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_366plustabs_OR_CI <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_366plustabs_OR_CI_lower <- sapply(data$post_bc_death_low_dose_366plustabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_366plustabs_OR_CI_upper <- sapply(data$post_bc_death_low_dose_366plustabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0to0.5tabs_perday_OR_only <- sapply(data$p19, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI <- sapply(data$p19, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_only <- sapply(data$p21, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI <- sapply(data$p21, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:475, 728:755, 476:705)]
#extract hormone therapy data from post bc death treatment OR and endocrine therapy data from post bc death treatment HR (these are the same)
data$p1 <- sapply(data$post_bc_death_treatment_OR, function(x) strsplit(x, "post-diag", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_treatment_OR, function(x) strsplit(x, "post-diag", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p1, function(x) strsplit(x, ":", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p1, function(x) strsplit(x, ":", fixed = TRUE)[[1]][2])
data$p5 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p6 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p7 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][3])
data$p5 <- gsub("low-dose", "", data$p5)
data$p5 <- gsub("non-exposed", "", data$p5)
data$p6 <- gsub("1-11", "", data$p6)
data$p6 <- gsub("low-dose", "", data$p6)
data$p7 <- gsub("12+", "", data$p7)
data$p7 <- gsub("low-dose", "", data$p7)
data$p5 <- gsub("[^0-9.(-]", "", data$p5)
data$p6 <- gsub("[^0-9.(-]", "", data$p6)
data$p7 <- gsub("[^0-9.(-]", "", data$p7)
data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_only <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_CI <- sapply(data$p5, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_CI_lower <- sapply(data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_CI_upper <- sapply(data$post_bc_death_hormone_therapy_and_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_only <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_CI <- sapply(data$p6, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_CI_lower <- sapply(data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_CI_upper <- sapply(data$post_bc_death_hormone_therapy_and_1to11prescriptions_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_only <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_CI <- sapply(data$p7, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_CI_lower <- sapply(data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_CI_upper <- sapply(data$post_bc_death_hormone_therapy_and_12plus_prescriptions_lowdose_aspirin_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:560, 741:752, 561:733)]
data$p1 <- sapply(data$post_bc_death_treatment_HR, function(x) strsplit(x, "451", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$post_bc_death_treatment_HR, function(x) strsplit(x, "451", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][1])
data$p4 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][2])
data$p3 <- gsub("nonusers.", "", data$p3)
data$p3 <- gsub("[^0-9.(-]", "", data$p3)
data$post_bc_death_hormone_therapy_aspirin_HR_only <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_aspirin_HR_CI <- sapply(data$p3, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_bc_death_hormone_therapy_and_aspirin_HR_CI_lower <- sapply(data$post_bc_death_hormone_therapy_and_aspirin_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_bc_death_hormone_therapy_and_aspirin_HR_CI_upper <- sapply(data$post_bc_death_hormone_therapy_and_aspirin_HR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:573, 750:753, 574:745)]
#clean unadj post ac death RR
data$p1 <- data$unadj_post_ac_death_RR
data$p1 <- gsub("95", "", data$p1)
data$p1 <- gsub("given-", "", data$p1)
data$p1 <- gsub("[^0-9.(-]", "", data$p1)
data$unadj_post_ac_death_RR_only <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_post_ac_death_RR_CI <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_post_ac_death_RR_CI_lower <- sapply(data$unadj_post_ac_death_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_post_ac_death_RR_CI_upper <- sapply(data$unadj_post_ac_death_RR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:581, 751:754, 582:749)]
#clean unadj post ac death OR
data$p1 <- data$unadj_post_ac_death_OR
data$p1 <- gsub("[^0-9.(-]", "", data$p1)
data$unadj_post_ac_death_OR_only <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$unadj_post_ac_death_OR_CI <- sapply(data$p1, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$unadj_post_ac_death_OR_CI_lower <- sapply(data$unadj_post_ac_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$unadj_post_ac_death_OR_CI_upper <- sapply(data$unadj_post_ac_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:586, 755:758, 587:753)]
#clean adj post ac death OR
#for this I am using model B data
data$p1 <- sapply(data$adj_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$adj_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][2])
data$p2 <- gsub("[^0-9.(-]", "", data$p2)
data$adj_post_ac_death_OR_only <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$adj_post_ac_death_OR_CI <- sapply(data$p2, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$adj_post_ac_death_OR_CI_lower <- sapply(data$adj_post_ac_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$adj_post_ac_death_OR_CI_upper <- sapply(data$adj_post_ac_death_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:610, 760:763, 611:757)]
#clean strat post ac death OR
#again will be using Model B ORs here
data$p1 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][1])
data$p2 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][2])
data$p3 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][3])
data$p4 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][4])
data$p5 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][5])
data$p6 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][6])
data$p7 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][7])
data$p8 <- sapply(data$strat_post_ac_death_OR, function(x) strsplit(x, "Model B", fixed = TRUE)[[1]][8])
data$p9 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][1])
data$p10 <- sapply(data$p2, function(x) strsplit(x, ").", fixed = TRUE)[[1]][2])
data$p11 <- sapply(data$p3, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p12 <- sapply(data$p3, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p13 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p14 <- sapply(data$p4, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p15 <- sapply(data$p5, function(x) strsplit(x, ").", fixed = TRUE)[[1]][1])
data$p16 <- sapply(data$p5, function(x) strsplit(x, ").", fixed = TRUE)[[1]][2])
data$p17 <- sapply(data$p6, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p18 <- sapply(data$p6, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p19 <- sapply(data$p7, function(x) strsplit(x, ")", fixed = TRUE)[[1]][1])
data$p20 <- sapply(data$p7, function(x) strsplit(x, ")", fixed = TRUE)[[1]][2])
data$p9 <- gsub("[^0-9.(-]", "", data$p9)
data$p11 <- gsub("[^0-9.(-]", "", data$p11)
data$p13 <- gsub("[^0-9.(-]", "", data$p13)
data$p15 <- gsub("[^0-9.(-]", "", data$p15)
data$p17 <- gsub("[^0-9.(-]", "", data$p17)
data$p19 <- gsub("[^0-9.(-]", "", data$p19)
data$p8 <- gsub("[^0-9.(-]", "", data$p8)
data$post_ac_death_high_dose_OR_only <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_high_dose_OR_CI <- sapply(data$p9, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_high_dose_OR_CI_lower <- sapply(data$post_bc_death_high_dose_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_high_dose_OR_CI_upper <- sapply(data$post_bc_death_high_dose_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0to11prescriptions_OR_only <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0to11prescriptions_OR_CI <- sapply(data$p11, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0to11prescriptions_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0to11prescriptions_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0to11prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_12plus_prescriptions_OR_only <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_12plus_prescriptions_OR_CI <- sapply(data$p13, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_12plus_prescriptions_OR_CI_lower <- sapply(data$post_bc_death_low_dose_12plus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_12plus_prescriptions_OR_CI_upper <- sapply(data$post_bc_death_low_dose_12plus_prescriptions_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_1to365tabs_OR_only <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_1to365tabs_OR_CI <- sapply(data$p15, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_1to365tabs_OR_CI_lower <- sapply(data$post_bc_death_low_dose_1to365tabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_1to365tabs_OR_CI_upper <- sapply(data$post_bc_death_low_dose_1to365tabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_366plustabs_OR_only <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_366plustabs_OR_CI <- sapply(data$p17, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_366plustabs_OR_CI_lower <- sapply(data$post_bc_death_low_dose_366plustabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_366plustabs_OR_CI_upper <- sapply(data$post_bc_death_low_dose_366plustabs_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0to0.5tabs_perday_OR_only <- sapply(data$p19, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0to0.5tabs_perday_OR_CI <- sapply(data$p19, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0to0.5tabs_perday_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0to0.5tabs_perday_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0to0.5tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0.5plus_tabs_perday_OR_only <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0.5plus_tabs_perday_OR_CI <- sapply(data$p8, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$post_ac_death_low_dose_0.5plus_tabs_perday_OR_CI_lower <- sapply(data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][1])
data$post_ac_death_low_dose_0.5plus_tabs_perday_OR_CI_upper <- sapply(data$post_bc_death_low_dose_0.5plus_tabs_perday_OR_CI, function(x) strsplit(x, "-", fixed = TRUE)[[1]][2])
data <- data[, c(1:625, 782:809, 626:761)]
#restore age column bc I want to use it for meta regression maybe
data$author <- sapply(data$author_year, function(x) strsplit(x, "(", fixed = TRUE)[[1]][1])
data$year <- sapply(data$author_year, function(x) strsplit(x, "(", fixed = TRUE)[[1]][2])
data$year <- gsub(")", "", data$year)
data <- data[c(1, 790, 791, 2:789)]
#set sample size column as numeric
data$cohort_size_number_only <- as.numeric(data$cohort_size_number_only)
#change Rothwell cohort size to number of bc patients in cohort to follow precedent I set elsewhere
data$cohort_size_number_only <- gsub("17299", "81", data$cohort_size_number_only)
#return to cleaning the characteristics columns
#clean age column 
#split into new columns again
data$mean_or_median_age <- NA
#I calculated the numbers for the following column by using either overall mean/median age (if available), or by working out overall means manually from control and exposed group means, or in the case of medians by taking the mean of median age of aspirin users and nonusers
#For Frisk I just used the Stage I-III numbers as this was by far the largest group
#For Barron I used 72 as the age for users in my calculation as it was the mode and equidistant between the other two ages for users (71 and 73)
#Li 2012 cannot be calculated bc they do not list size of control and exposed groups, so going to do a simple mean of the 2 figures given
data$mean_or_median_age = c("62", 
    NA, NA, "59.11", 
    "62", 
    "52.5", NA, NA, 
    "66.5", 
    NA, "60.19", 
    "63.8", 
    NA, "56", 
    NA, NA, "63", 
    NA, "61.02", 
    NA, NA, "68", 
    "69.5", 
    "64.9", 
    NA, "58.75"
    )
data <- data[c(1:53, 792, 54:791)]
data$mean_or_median_age <- as.numeric(data$mean_or_median_age)
#no need to clean sex column bc pretty much every study is female only
#clean stage characteristics
#from this point on I am going to use a data2 database so I don't have to change all the column numbers in my meta analysis code over and over
data2 <- data
#might as well get rid of Holmes 2011 and 2013 as well at this point
data2 <- data2[-c(7,8),]
#I think best way is to create columns manually and add them to the dataset (as most my data is in raw numbers, but I want percentages)
#My understanding is you can't really compare just T to TNM staging, so have only included TNM staging
#Have used % of patients with known stage (not just total cohort size)
#this obviously has the issue that not all studies have Stage IV (one also doesn't have Stage I), but given Stage IV patients usually a small % I think it should be ok
#for reference number of Stage IV patients is usually similar/smaller than number of Stage III patients
#import new columns using readxl
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "All stage columns")
#merge to data2
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
names(data2)[797] <- "stage_data_notes"
data2 <- data2[c(1:56, 793:797, 57:792)]
#clean menopause characteristics
#I will again do this by creating new columns in excel (% premenopausal and %postmenopausal) and importing them
#import from excel
Menopause_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Menopause stuff")
#merge with data2
data2 <- merge(data2, Menopause_columns, by="author_year")
data2 <- data2[c(1:67, 798, 799, 68:797)]
#clean grade characteristics
#add new columns
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Grade stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:64, 800:803, 65:799)]
#clean smoking characteristics
#Sendur is split only into smokers/nonsmokers; I will include smokers in the current smoker column, but as I can't seperate nonsmokers into past/never I won't include this data
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Smoking stuff") 
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:74, 804:806, 75:803)]
#clean molsubtype characteristics
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Molsubtype stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:69, 807:814, 70:806)]
#clean treatment characteristics
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Treatment stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:78, 815:818, 79:814)]
#clean race characteristics
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Race stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:91, 819:821, 92:818)]
#clean node characteristics
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Node stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:62, 822, 823, 63:821)]
#clean metastasis characteristics
#not enough data (and not similar enough) to make this worth it
#clean weight characteristics
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Weight Stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:92, 824:826, 93:823)]
#clean followup columns?
#I did Li by taking a a mean of the 2 values (as aspirin and non-aspirin groups were same size). Had to divide by 365 as number was in days not years
#did same for Shiao, but had to account for control and exposed groups being different sizes
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Followup Stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:101, 103, 104, 827, 102, 105:826)]
#clean exposure
Calculations_for_new_columns <- read_excel("D:/Documents/Uni Stuff/Year 3/Research project/Calculations for new columns.xlsx", sheet = "Exposure stuff")
data2 <- merge(data2, Calculations_for_new_columns, by="author_year")
data2 <- data2[c(1:105, 828, 106:827)]
