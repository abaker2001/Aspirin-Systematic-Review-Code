#run code for clean dataset first
library(meta)
data$year <- as.numeric(data$year)
data$cohort_size_number_only <- as.numeric(data$cohort_size_number_only)
#this code analyses unadj pre bc death OR
p1 <- data[c(3, 4, 75:78)]
unadj_pre_bc_death_OR_only_data <- p1[c(11, 20, 24),]
unadj_pre_bc_death_OR_only_analysis <- metagen(TE = log(unadj_pre_bc_death_OR_only), lower = log(unadj_pre_bc_death_OR_lower_CI), upper = log(unadj_pre_bc_death_OR_higher_CI), studlab = author_year, data = unadj_pre_bc_death_OR_only_data, exclude = NULL, sm = "OR")
summary(unadj_pre_bc_death_OR_only_analysis)
forest.meta(unadj_pre_bc_death_OR_only_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this code analyses unadj pre bc death HR
p2 <- data[c(3, 4, 80:83)]
unadj_pre_bc_death_HR_only_data <- p2[c(5, 13, 15, 17, 22, 26),]
#set the three unadj pre bc death HR columns I'll be using to numerical
unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_only <- as.numeric(unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_only)
unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_lower_CI <- as.numeric(unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_lower_CI)
unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_higher_CI <- as.numeric(unadj_pre_bc_death_HR_only_data$unadj_pre_bc_death_HR_higher_CI)
unadj_pre_bc_death_HR_only_analysis <- metagen(TE = log(unadj_pre_bc_death_HR_only), lower = log(unadj_pre_bc_death_HR_lower_CI), upper = log(unadj_pre_bc_death_HR_higher_CI), studlab = author_year, data = unadj_pre_bc_death_HR_only_data, exclude = NULL, sm = "HR")
summary(unadj_pre_bc_death_HR_only_analysis)
forest.meta(unadj_pre_bc_death_HR_only_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this code compiles all unadj pre bc death data (OR and HR) into one dataset, then analyses it
p3 <- data[c(3, 4, 73:83)]
unadj_pre_bc_death_HR_and_OR_combined_data <- p3[c(5, 11, 13, 15, 17, 20, 22, 24, 26),]
#unite OR and HR columns (and associated CI columns)
unadj_pre_bc_death_HR_and_OR_combined_data <- unadj_pre_bc_death_HR_and_OR_combined_data %>% unite(unadj_pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, unadj_pre_bc_death_HR_only, sep = "")
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR <- gsub("NA", "", unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR)
unadj_pre_bc_death_HR_and_OR_combined_data <- unadj_pre_bc_death_HR_and_OR_combined_data %>% unite(unadj_pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, unadj_pre_bc_death_HR_CI, sep = "")
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_CIs)
unadj_pre_bc_death_HR_and_OR_combined_data <- unadj_pre_bc_death_HR_and_OR_combined_data %>% unite(unadj_pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, unadj_pre_bc_death_HR_lower_CI, sep = "")
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_lower_CIs)
unadj_pre_bc_death_HR_and_OR_combined_data <- unadj_pre_bc_death_HR_and_OR_combined_data %>% unite(unadj_pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, unadj_pre_bc_death_HR_higher_CI, sep = "")
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_higher_CIs)
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR <- as.numeric(unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR)
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_lower_CIs)
unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(unadj_pre_bc_death_HR_and_OR_combined_data$unadj_pre_bc_death_OR_or_HR_higher_CIs)
#this next line isn't strictly necessary but it makes the data easier to read
unadj_pre_bc_death_HR_and_OR_combined_data <- unadj_pre_bc_death_HR_and_OR_combined_data[, c(1:3, 8, 4:7)]
#this line does the meta analysis, producing both fixed and random effects analyses
unadj_pre_bc_death_HR_and_OR_analysis <- metagen(TE = log(unadj_pre_bc_death_OR_or_HR), lower = log(unadj_pre_bc_death_OR_or_HR_lower_CIs), upper = log(unadj_pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = unadj_pre_bc_death_HR_and_OR_combined_data, exclude = NULL, sm = "HR")
summary(unadj_pre_bc_death_HR_and_OR_analysis)
#this line makes a forest plot of unadj pre bc death OR and HRs
forest.meta(unadj_pre_bc_death_HR_and_OR_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for meta analysing adj pre bc death HR (note all adj pre death data comes in the form of HRs
#set the three adj pre bc death HR columns I'll be using to numerical
data$adj_pre_bc_death_HR_only <- as.numeric(data$adj_pre_bc_death_HR_only)
data$adj_pre_bc_death_HR_CI_lower <- as.numeric(data$adj_pre_bc_death_HR_CI_lower)
data$adj_pre_bc_death_HR_CI_upper <- as.numeric(data$adj_pre_bc_death_HR_CI_upper)
#split off only the data I'll need for this analysis
p4 <- data[c(3, 4, 85:88)]
adj_pre_bc_death_HR_analysis_data <- p4[c(5, 13, 15, 17, 21, 22, 23, 26),]
#run meta analysis of pre bc death HR (note that even though both HRs and ORs are present I can only put one in the formula so chose HR)
pre_bc_death_HR_analysis <- metagen(TE = log(adj_pre_bc_death_HR_only), lower = log(adj_pre_bc_death_HR_CI_lower), upper = log(adj_pre_bc_death_HR_CI_upper), studlab = author_year, data = adj_pre_bc_death_HR_analysis_data, exclude = NULL, sm = "HR")
summary(pre_bc_death_HR_analysis)
#this code creates a forest plot of the data
 forest.meta(pre_bc_death_HR_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#run again with Fraser 2014 excluded
no_fraser_adj_pre_bc_death_HR_analysis_data <- p4[c(13, 15, 17, 21, 22, 23, 26),]
no_fraser_pre_bc_death_adj_HR_analysis <- metagen(TE = log(adj_pre_bc_death_HR_only), lower = log(adj_pre_bc_death_HR_CI_lower), upper = log(adj_pre_bc_death_HR_CI_upper), studlab = author_year, data = no_fraser_adj_pre_bc_death_HR_analysis_data, exclude = NULL, sm = "HR")
summary(no_fraser_pre_bc_death_adj_HR_analysis)
forest.meta(no_fraser_pre_bc_death_adj_HR_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#add all papers which didn't have an adjusted value to this analysis (the three OR ones)
p5 <- data[c(3, 4, 9, 54, 75:78, 85:88)]
all_pre_bc_death_analysis_data <- p5[c(5, 11, 13, 15, 17, 20, 21, 22, 23, 24, 26),]
#unite columns
all_pre_bc_death_analysis_data <- all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data <- all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data <- all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data <- all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs)
#run meta analysis  
all_pre_bc_death_analysis <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data, exclude = NULL, sm = "HR")
summary(all_pre_bc_death_analysis)
#generate forest plot
forest.meta(all_pre_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#run again with Fraser 2014 excluded
no_fraser_all_pre_bc_death_analysis_data <- p5[c(11, 13, 15, 17, 20, 21, 22, 23, 24, 26),]
no_fraser_all_pre_bc_death_analysis_data <- no_fraser_all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR <- gsub("NA", "", no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR)
no_fraser_all_pre_bc_death_analysis_data <- no_fraser_all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_CIs)
no_fraser_all_pre_bc_death_analysis_data <- no_fraser_all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs)
no_fraser_all_pre_bc_death_analysis_data <- no_fraser_all_pre_bc_death_analysis_data %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs)
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR <- as.numeric(no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR)
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_lower_CIs)
no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(no_fraser_all_pre_bc_death_analysis_data$pre_bc_death_OR_or_HR_higher_CIs)
no_fraser_all_pre_bc_death_analysis <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = no_fraser_all_pre_bc_death_analysis_data, exclude = NULL, sm = "HR")
summary(no_fraser_all_pre_bc_death_analysis)
forest.meta(no_fraser_all_pre_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for meta analysing unadj pre ac death HR only
p6 <- data[c(3, 4, 183:186)]
unadj_pre_ac_death_HR_data <- p6[c(4, 5, 15, 24, 26),]
unadj_pre_ac_death_HR_data$unadj_pre_ac_death_HR_only <- as.numeric(unadj_pre_ac_death_HR_data$unadj_pre_ac_death_HR_only)
unadj_pre_ac_death_HR_data$unadj_pre_ac_death_CI_lower <- as.numeric(unadj_pre_ac_death_HR_data$unadj_pre_ac_death_CI_lower)
unadj_pre_ac_death_HR_data$unadj_pre_ac_death_CI_upper <- as.numeric(unadj_pre_ac_death_HR_data$unadj_pre_ac_death_CI_upper)
unadj_pre_ac_death_HR_analysis <- metagen(TE = log(unadj_pre_ac_death_HR_only), lower = log(unadj_pre_ac_death_CI_lower), upper = log(unadj_pre_ac_death_CI_upper), studlab = author_year, data = unadj_pre_ac_death_HR_data, exclude = NULL, sm = "HR")
summary(unadj_pre_ac_death_HR_analysis)
forest.meta(unadj_pre_ac_death_HR_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit code is for meta analysing all unadj pre ac death (HR and OR)
#for Sendur 2014 I am using the 5-year overall survival data as it gives the greatest time for events to occur
p7 <- data[c(3, 4, 178:181, 183:186)]
unadj_pre_ac_death_HRandOR_data <- p7[c(4, 5, 14, 15, 24, 26),]
unadj_pre_ac_death_HRandOR_data <- unadj_pre_ac_death_HRandOR_data %>% unite(unadj_pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, unadj_pre_ac_death_HR_only, sep = "")
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR <- gsub("NA", "", unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR)
unadj_pre_ac_death_HRandOR_data <- unadj_pre_ac_death_HRandOR_data %>% unite(unadj_pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, unadj_pre_ac_death_CI, sep = "")
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI <- gsub("NA", "", unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI)
unadj_pre_ac_death_HRandOR_data <- unadj_pre_ac_death_HRandOR_data %>% unite(unadj_pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, unadj_pre_ac_death_CI_lower, sep = "")
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_lower)
unadj_pre_ac_death_HRandOR_data <- unadj_pre_ac_death_HRandOR_data %>% unite(unadj_pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, unadj_pre_ac_death_CI_upper, sep = "")
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_upper)
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR <- as.numeric(unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR)
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_lower <- as.numeric(unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_lower)
unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_upper <- as.numeric(unadj_pre_ac_death_HRandOR_data$unadj_pre_ac_death_OR_or_HR_CI_upper)
unadj_pre_ac_death_analysis <- metagen(TE = log(unadj_pre_ac_death_OR_or_HR), lower = log(unadj_pre_ac_death_OR_or_HR_CI_lower), upper = log(unadj_pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = unadj_pre_ac_death_HRandOR_data, exclude = NULL, sm = "HR")
summary(unadj_pre_ac_death_analysis)
forest.meta(unadj_pre_ac_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for meta analysing adj pre ac death HR
#set the three adj pre ac death HR columns I'll be using to numerical
data$adj_pre_ac_death_HR <- as.numeric(data$adj_pre_ac_death_HR)
data$adj_pre_ac_death_CI_lower <- as.numeric(data$adj_pre_ac_death_CI_lower)
data$adj_pre_ac_death_CI_upper <- as.numeric(data$adj_pre_ac_death_CI_upper)
p8 <- data[c(3, 4, 188:191)]
adj_pre_ac_death_HR_data <- p8[c(4, 5, 15, 21, 22, 23, 24, 26),]
adj_pre_ac_death_HR_analysis <- metagen(TE = log(adj_pre_ac_death_HR), lower = log(adj_pre_ac_death_CI_lower), upper = log(adj_pre_ac_death_CI_upper), studlab = author_year, data = adj_pre_ac_death_HR_data, exclude = NULL, sm = "HR")
summary(adj_pre_ac_death_HR_analysis)
forest.meta(adj_pre_ac_death_HR_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for combining and analysing unadj and adj pre ac death
data$unadj_pre_ac_death_after5years_OR_only <- as.numeric(data$unadj_pre_ac_death_after5years_OR_only)
data$unadj_pre_ac_death_after5years_OR_CI_lower <- as.numeric(data$unadj_pre_ac_death_after5years_OR_CI_lower)
data$unadj_pre_ac_death_after5years_OR_CI_upper <- as.numeric(data$unadj_pre_ac_death_after5years_OR_CI_upper)
p9 <- data[c(3, 4, 9, 54, 178:181, 188:191)]
all_pre_ac_death_data <- p9[c(4, 5, 14, 15, 21, 22, 23, 24, 26),]
all_pre_ac_death_data <- all_pre_ac_death_data %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data$pre_ac_death_OR_or_HR)
all_pre_ac_death_data <- all_pre_ac_death_data %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data <- all_pre_ac_death_data %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data <- all_pre_ac_death_data %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data$pre_ac_death_OR_or_HR)
all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data, exclude = NULL, sm = "HR")
summary(all_pre_ac_death_analysis)
forest.meta(all_pre_ac_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for compiling and analysing unadj pre rec RR, OR and HR
#again for Sendur I will be using the 5 year data (for same reasons)
p10 <- data[c(3, 4, 205:208, 210:213, 215:218)]
all_unadj_pre_rec_data <- p10[c(4, 14, 16, 17, 19, 24),]
all_unadj_pre_rec_data <- all_unadj_pre_rec_data %>% unite(unadj_pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_unadj_rec_RR_only, unadj_pre_rec_HR_only, sep = "")
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR <- gsub("NA", "", all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR)
all_unadj_pre_rec_data <- all_unadj_pre_rec_data %>% unite(unadj_pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_unadj_rec_RR_CI, unadj_pre_rec_HR_CI, sep = "")
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI)
all_unadj_pre_rec_data <- all_unadj_pre_rec_data %>% unite(unadj_pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_unadj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, sep = "")
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_lower)
all_unadj_pre_rec_data <- all_unadj_pre_rec_data %>% unite(unadj_pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_unadj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, sep = "")
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_upper)
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR <- as.numeric(all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR)
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_lower)
all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_unadj_pre_rec_data$unadj_pre_rec_OR_RR_or_HR_CI_upper)
all_unadj_pre_rec_analysis <- metagen(TE = log(unadj_pre_rec_OR_RR_or_HR), lower = log(unadj_pre_rec_OR_RR_or_HR_CI_lower), upper = log(unadj_pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_unadj_pre_rec_data, exclude = NULL, sm = "HR")
summary(all_unadj_pre_rec_analysis)
forest.meta(all_unadj_pre_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing adj pre rec
p11 <- data[c(3, 4, 221:224, 226:229)]
all_adj_pre_rec_data <- p11[c(16, 17, 19),]
all_adj_pre_rec_data <- all_adj_pre_rec_data %>% unite(adj_pre_rec_RR_or_HR, pre_adj_rec_RR_only, adj_pre_rec_HR_only, sep = "")
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR <- gsub("NA", "", all_adj_pre_rec_data$adj_pre_rec_RR_or_HR)
all_adj_pre_rec_data <- all_adj_pre_rec_data %>% unite(adj_pre_rec_RR_or_HR_CI, pre_adj_rec_RR_CI, adj_pre_rec_HR_CI, sep = "")
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI <- gsub("NA", "", all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI)
all_adj_pre_rec_data <- all_adj_pre_rec_data %>% unite(adj_pre_rec_RR_or_HR_CI_lower, pre_adj_rec_RR_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_lower)
all_adj_pre_rec_data <- all_adj_pre_rec_data %>% unite(adj_pre_rec_RR_or_HR_CI_upper, pre_adj_rec_RR_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_upper)
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR <- as.numeric(all_adj_pre_rec_data$adj_pre_rec_RR_or_HR)
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_lower <- as.numeric(all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_lower)
all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_upper <- as.numeric(all_adj_pre_rec_data$adj_pre_rec_RR_or_HR_CI_upper)
all_adj_pre_rec_analysis <- metagen(TE = log(adj_pre_rec_RR_or_HR), lower = log(adj_pre_rec_RR_or_HR_CI_lower), upper = log(adj_pre_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_adj_pre_rec_data, exclude = NULL, sm = "HR")
summary(all_adj_pre_rec_analysis)
forest.meta(all_adj_pre_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing all pre rec (adjusted where available, unadjusted where not)
p12 <- data[c(3, 4, 9, 54, 205:208, 215:218, 221:224, 226:229)]
all_pre_rec_data <- p12[c(4, 14, 16, 17, 19, 24),]
all_pre_rec_data <- all_pre_rec_data %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data$pre_rec_OR_RR_or_HR)
all_pre_rec_data$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data$pre_rec_OR_RR_or_HR)
all_pre_rec_data$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data$pre_rec_OR_RR_or_HR) 
all_pre_rec_data <- all_pre_rec_data %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data <- all_pre_rec_data %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data <- all_pre_rec_data %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data$pre_rec_OR_RR_or_HR)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data, exclude = NULL, sm = "HR")
summary(all_pre_rec_analysis)
forest.meta(all_pre_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing all unadj post bc death (HR, OR and RR)
#for Holmes 2010 I will use 6 to 7 days a week use data as this most closely follows the amount a person prescribed aspirin (who are usually told to take it daily) would be taking
p13 <- data[c(3, 4, 246:249, 251:254, 256:259)]
unadj_post_bc_death_data <- p13[c(2, 5, 9, 15, 17, 18, 20, 24, 26),]
unadj_post_bc_death_data <- unadj_post_bc_death_data %>% unite(unadj_post_bc_death_OR_RR_or_HR, post_bc_death_6to7daysaweekuse_RR_only, unadj_post_bc_death_OR_only, unadj_post_bc_death_HR_only, sep = "")
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR <- gsub("NA", "", unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR)
unadj_post_bc_death_data <- unadj_post_bc_death_data %>% unite(unadj_post_bc_death_OR_RR_or_HR_CI, post_bc_death_6to7daysaweekuse_RR_CI, unadj_post_bc_death_OR_CI, unadj_post_bc_death_HR_CI, sep = "")
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI)
unadj_post_bc_death_data <- unadj_post_bc_death_data %>% unite(unadj_post_bc_death_OR_RR_or_HR_CI_lower, post_bc_death_6to7daysaweekuse_RR_CI_lower, unadj_post_bc_death_OR_CI_lower, unadj_post_bc_death_HR_CI_lower, sep = "")
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_lower)
unadj_post_bc_death_data <- unadj_post_bc_death_data %>% unite(unadj_post_bc_death_OR_RR_or_HR_CI_upper, post_bc_death_6to7daysaweekuse_RR_CI_upper, unadj_post_bc_death_OR_CI_upper, unadj_post_bc_death_HR_CI_upper, sep = "")
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_upper)
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR <- as.numeric(unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR)
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_lower)
unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(unadj_post_bc_death_data$unadj_post_bc_death_OR_RR_or_HR_CI_upper)
unadj_post_bc_death_analysis <- metagen(TE = log(unadj_post_bc_death_OR_RR_or_HR), lower = log(unadj_post_bc_death_OR_RR_or_HR_CI_lower), upper = log(unadj_post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = unadj_post_bc_death_data, exclude = NULL, sm = "HR")
summary(unadj_post_bc_death_analysis)
forest.meta(unadj_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing post adj bc death HR
#set the three adj post bc death HR columns I'll be using to numerical
data$adj_post_bc_death_HR_only <- as.numeric(data$adj_post_bc_death_HR_only)
data$adj_post_bc_death_HR_CI_lower <- as.numeric(data$adj_post_bc_death_HR_CI_lower)
data$adj_post_bc_death_HR_CI_upper <- as.numeric(data$adj_post_bc_death_HR_CI_upper)
adj_post_death_HR_analysis <- metagen(TE = log(adj_post_bc_death_HR_only), lower = log(adj_post_bc_death_HR_CI_lower), upper = log(adj_post_bc_death_HR_CI_upper), studlab = , data = data, exclude = NULL, sm = "HR")
summary(adj_post_death_HR_analysis)
#this bit of code is for analysing all adj post bc death (HR, OR and RR)
#note I will be excluding Holmes 2011 and 2013 due to them sharing the same study pop as Holmes 2010 (reasons for choosing this of the 3 described elsewhere; briefly, bigger sample size than 2011 and 2013 assesses use too long after diagnosis)
p14 <- data[c(3, 4, 262:265, 267:270, 272:275)]
adj_post_bc_death_data <- p14[c(1, 2, 5, 9, 15, 17, 18, 20, 23, 25, 26),]
adj_post_bc_death_data <- adj_post_bc_death_data %>% unite(adj_post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, sep = "")
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR <- gsub("NA", "", adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR)
adj_post_bc_death_data <- adj_post_bc_death_data %>% unite(adj_post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, sep = "")
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI)
adj_post_bc_death_data <- adj_post_bc_death_data %>% unite(adj_post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, sep = "")
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_lower)
adj_post_bc_death_data <- adj_post_bc_death_data %>% unite(adj_post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, sep = "")
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_upper)
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR <- as.numeric(adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR)
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_lower)
adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(adj_post_bc_death_data$adj_post_bc_death_OR_RR_or_HR_CI_upper)
adj_post_bc_death_analysis <- metagen(TE = log(adj_post_bc_death_OR_RR_or_HR), lower = log(adj_post_bc_death_OR_RR_or_HR_CI_lower), upper = log(adj_post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = adj_post_bc_death_data, exclude = NULL, sm = "HR")
summary(adj_post_bc_death_analysis)
forest.meta(adj_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code analyses all post bc death data (adj where available, unadj where not; latter is only Williams 2018)
p15 <- data[c(3, 4, 9, 54, 251:254, 262:265, 267:270, 272:275)]
all_post_bc_death_data <- p15[c(1, 2, 5, 9, 15, 17, 18, 20, 23, 24, 25, 26),]
all_post_bc_death_data$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data$unadj_post_bc_death_OR_only)
all_post_bc_death_data$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data$unadj_post_bc_death_OR_CI)
all_post_bc_death_data$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data <- all_post_bc_death_data %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data <- all_post_bc_death_data %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data <- all_post_bc_death_data %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data <- all_post_bc_death_data %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data, exclude = NULL, sm = "HR")
summary(all_post_bc_death_analysis)
forest.meta(all_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#do again without Barron 2014 (bc same cohort source as Barron 2015, but smaller sample size and shorter, overlapping period of recruitment)
all_post_bc_death_data_minus_Barron2014 <- all_post_bc_death_data[-c(9),]
all_post_bc_death_data_minus_Barron2014$cohort_size_number_only <- as.numeric(all_post_bc_death_data_minus_Barron2014$cohort_size_number_only)
all_post_bc_death_analysis_no_Barron <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data_minus_Barron2014, exclude = NULL, sm = "HR")
summary(all_post_bc_death_analysis_no_Barron)
forest.meta(all_post_bc_death_analysis_no_Barron, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing post unadj ac death HR
#set the three unadj post ac death HR columns I'll be using to numerical
data$post_ac_death_unadj_HR <- as.numeric(data$post_ac_death_unadj_HR)
data$post_ac_death_unadj_HR_CI_lower <- as.numeric(data$post_ac_death_unadj_HR_CI_lower)
data$post_ac_death_unadj_HR_CI_upper <- as.numeric(data$post_ac_death_unadj_HR_CI_upper)
metagen(TE = log(post_ac_death_unadj_HR), lower = log(post_ac_death_unadj_HR_CI_lower), upper = log(post_ac_death_unadj_HR_CI_upper), studlab = , data = data, exclude = NULL, sm = "HR")
#this bit of code is for analysing all unadj post ac death (RR, OR and HR)
p16 <- data[c(3, 4, 585:588, 590:593, 595:598)]
unadj_post_ac_death_data <- p16[c(3, 4, 5, 6, 9, 12, 15, 18, 20, 24, 26),]
unadj_post_ac_death_data <- unadj_post_ac_death_data %>% unite(unadj_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, unadj_post_ac_death_OR_only, post_ac_death_unadj_HR, sep = "")
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR <- gsub("NA", "", unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR)
unadj_post_ac_death_data <- unadj_post_ac_death_data %>% unite(unadj_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, unadj_post_ac_death_OR_CI, post_ac_death_unadj_HR_CI, sep = "")
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI)
unadj_post_ac_death_data <- unadj_post_ac_death_data %>% unite(unadj_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, unadj_post_ac_death_OR_CI_lower, post_ac_death_unadj_HR_CI_lower, sep = "")
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_lower)
unadj_post_ac_death_data <- unadj_post_ac_death_data %>% unite(unadj_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, unadj_post_ac_death_OR_CI_upper, post_ac_death_unadj_HR_CI_upper, sep = "")
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_upper)
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR <- as.numeric(unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR)
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_lower)
unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(unadj_post_ac_death_data$unadj_post_ac_death_OR_RR_or_HR_CI_upper)
unadj_post_ac_death_analysis <- metagen(TE = log(unadj_post_ac_death_OR_RR_or_HR), lower = log(unadj_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(unadj_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = unadj_post_ac_death_data, exclude = NULL, sm = "HR")
summary(unadj_post_ac_death_analysis)
forest.meta(unadj_post_ac_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing adj post ac death HR
#set the three adj post ac death HR columns I'll be using to numerical
data$post_ac_death_adj_HR <- as.numeric(data$post_ac_death_adj_HR)
data$post_ac_death_adj_HR_CI_lower <- as.numeric(data$post_ac_death_adj_HR_CI_lower)
data$post_ac_death_adj_HR_CI_upper <- as.numeric(data$post_ac_death_adj_HR_CI_upper)
metagen(TE = log(post_ac_death_adj_HR), lower = log(post_ac_death_adj_HR_CI_lower), upper = log(post_ac_death_adj_HR_CI_upper), studlab = , data = data, exclude = NULL, sm = "HR")
#this bit of code is for analysing all adj post ac death (RR, OR and HR)
#for Holmes 2010 I am again using 6-7 days a week use data
#For Holmes 2014 I am using the greater than or equal to 1 uses per day data (rationale in clean dataset code)
#Again I am excluding Holmes 2013 in favour of Holmes 2010, and Barron 2014 in favour of Barron 2015
p17 <- data[c(3, 4, 601:604, 614:617, 619:622)]
adj_post_ac_death_data <- p17[c(1, 2, 5, 9, 10, 12, 15, 18, 20, 24, 25, 26),]
adj_post_ac_death_data <- adj_post_ac_death_data %>% unite(adj_post_ac_death_OR_RR_or_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR <- gsub("NA", "", adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR)
adj_post_ac_death_data <- adj_post_ac_death_data %>% unite(adj_post_ac_death_OR_RR_or_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI)
adj_post_ac_death_data <- adj_post_ac_death_data %>% unite(adj_post_ac_death_OR_RR_or_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_lower)
adj_post_ac_death_data <- adj_post_ac_death_data %>% unite(adj_post_ac_death_OR_RR_or_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_upper)
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR <- as.numeric(adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR)
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_lower)
adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(adj_post_ac_death_data$adj_post_ac_death_OR_RR_or_HR_CI_upper)
adj_post_ac_death_analysis <- metagen(TE = log(adj_post_ac_death_OR_RR_or_HR), lower = log(adj_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(adj_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = adj_post_ac_death_data, exclude = NULL, sm = "HR")
summary(adj_post_ac_death_analysis)
forest.meta(adj_post_ac_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing all post ac death (adj where available, unadj where not)
#again excluding Holmes 2013 and Barron 2014
p18 <- data[c(3, 4, 9, 54, 585:588, 595:598, 601:604, 614:617, 619:622)]
all_post_ac_data <- p18[c(1, 2, 3, 4, 5, 6, 9, 10, 12, 15, 18, 20, 24, 25, 26),]
all_post_ac_data$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data$post_ac_death_unadj_HR)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data$post_ac_death_unadj_HR_CI)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data <- all_post_ac_data %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data <- all_post_ac_data %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data <- all_post_ac_data %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data <- all_post_ac_data %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data, exclude = NULL, sm = "HR")
summary(all_post_ac_death_analysis)
forest.meta(all_post_ac_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing all unadj post rec (RR and HR)
#Again for Holmes 2010 using 6-7 days a week use
p19 <- data[c(3, 4, 750:753, 763:766)]
unadj_post_rec_data <- p19[c(2, 6, 12, 16, 19, 24),]
unadj_post_rec_data <- unadj_post_rec_data %>% unite(unadj_post_rec_RR_or_HR, post_rec_unadj_RR_only, post_rec_unadj_HR_only, sep = "")
unadj_post_rec_data$unadj_post_rec_RR_or_HR <- gsub("NA", "", unadj_post_rec_data$unadj_post_rec_RR_or_HR)
unadj_post_rec_data <- unadj_post_rec_data %>% unite(unadj_post_rec_RR_or_HR_CI, post_rec_unadj_RR_CI, post_rec_unadj_HR_CI, sep = "")
unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI <- gsub("NA", "", unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI)
unadj_post_rec_data <- unadj_post_rec_data %>% unite(unadj_post_rec_RR_or_HR_CI_lower, post_rec_unadj_RR_CI_lower, post_rec_unadj_HR_CI_lower, sep = "")
unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_lower)
unadj_post_rec_data <- unadj_post_rec_data %>% unite(unadj_post_rec_RR_or_HR_CI_upper, post_rec_unadj_RR_CI_upper, post_rec_unadj_HR_CI_upper, sep = "")
unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_upper)
unadj_post_rec_data$unadj_post_rec_RR_or_HR <- as.numeric(unadj_post_rec_data$unadj_post_rec_RR_or_HR)
unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_lower <- as.numeric(unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_lower)
unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_upper <- as.numeric(unadj_post_rec_data$unadj_post_rec_RR_or_HR_CI_upper)
unadj_post_rec_analysis <- metagen(TE = log(unadj_post_rec_RR_or_HR), lower = log(unadj_post_rec_RR_or_HR_CI_lower), upper = log(unadj_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = unadj_post_rec_data, exclude = NULL, sm = "HR")
summary(unadj_post_rec_analysis)
forest.meta(unadj_post_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code analyses all adj post rec (RR and HR)
#again for Holmes 2010 using 6-7 days a week data
p20 <- data[c(3, 4, 769:772, 782:785)]
adj_post_rec_data <- p20[c(2, 16, 19),]
adj_post_rec_data <- adj_post_rec_data %>% unite(adj_post_rec_RR_or_HR, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
adj_post_rec_data$adj_post_rec_RR_or_HR <- gsub("NA", "", adj_post_rec_data$adj_post_rec_RR_or_HR)
adj_post_rec_data <- adj_post_rec_data %>% unite(adj_post_rec_RR_or_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
adj_post_rec_data$adj_post_rec_RR_or_HR_CI <- gsub("NA", "", adj_post_rec_data$adj_post_rec_RR_or_HR_CI)
adj_post_rec_data <- adj_post_rec_data %>% unite(adj_post_rec_RR_or_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
adj_post_rec_data$adj_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", adj_post_rec_data$adj_post_rec_RR_or_HR_CI_lower)
adj_post_rec_data <- adj_post_rec_data %>% unite(adj_post_rec_RR_or_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
adj_post_rec_data$adj_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", adj_post_rec_data$adj_post_rec_RR_or_HR_CI_upper)
adj_post_rec_data$adj_post_rec_RR_or_HR <- as.numeric(adj_post_rec_data$adj_post_rec_RR_or_HR)
adj_post_rec_data$adj_post_rec_RR_or_HR_CI_lower <- as.numeric(adj_post_rec_data$adj_post_rec_RR_or_HR_CI_lower)
adj_post_rec_data$adj_post_rec_RR_or_HR_CI_upper <- as.numeric(adj_post_rec_data$adj_post_rec_RR_or_HR_CI_upper)
adj_post_rec_analysis <- metagen(TE = log(adj_post_rec_RR_or_HR), lower = log(adj_post_rec_RR_or_HR_CI_lower), upper = log(adj_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = adj_post_rec_data, exclude = NULL, sm = "HR")
summary(adj_post_rec_analysis)
forest.meta(adj_post_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit of code is for analysing all post rec (adj where available, unadj where not)
p21 <- data[c(3, 4, 9, 54, 763:766, 769:772, 782:785)]
all_post_rec_data <- p21[c(2, 6, 12, 16, 19, 24),]
all_post_rec_data$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data$post_rec_unadj_HR_only)
all_post_rec_data$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data$post_rec_unadj_HR_CI)
all_post_rec_data$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data$post_rec_unadj_HR_CI_lower)
all_post_rec_data$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data$post_rec_unadj_HR_CI_upper)
all_post_rec_data <- all_post_rec_data %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data$all_post_rec_RR_or_HR)
all_post_rec_data <- all_post_rec_data %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data$all_post_rec_RR_or_HR_CI)
all_post_rec_data <- all_post_rec_data %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data <- all_post_rec_data %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data$all_post_rec_RR_or_HR)
all_post_rec_data$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data, exclude = NULL, sm = "HR")
summary(all_post_rec_analysis)
forest.meta(all_post_rec_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this code is for meta regressions
#this bit is a meta regression of study publication year for all post bc death 
#you have to run the code for meta analysing all post bc death with no Barron (see above) before you use this code
all_post_bc_death_data_minus_Barron2014$year <- as.numeric(all_post_bc_death_data_minus_Barron2014$year)
metareg_year_all_post_bc_death_no_Barron <- metareg(all_post_bc_death_analysis_no_Barron, ~year)
metareg_year_all_post_bc_death_no_Barron
#this line generates a bubble plot to visualise the data
bubble(metareg_year_all_post_bc_death_no_Barron, studlab = TRUE)
#this bit is for doing a meta regression of all post bc death no barron by sample size of study
metareg_sample_size_all_post_bc_death_no_Barron <- metareg(all_post_bc_death_analysis_no_Barron, ~cohort_size_number_only)
metareg_sample_size_all_post_bc_death_no_Barron
#this line generates a bubble plot to visualise the data
bubble(metareg_sample_size_all_post_bc_death_no_Barron, studlab = TRUE)
#this bit is a meta regression of mean/median age in cohort and all post bc death
#again run code first
metareg_age_all_post_bc_death_no_Barron <- metareg(all_post_bc_death_analysis_no_Barron, ~mean_or_median_age)
metareg_age_all_post_bc_death_no_Barron
bubble(metareg_age_all_post_bc_death_no_Barron, studlab = TRUE)
#this code produces funnel plots for all 6 main analyses
funnel.meta(all_pre_bc_death_analysis, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(no_fraser_all_pre_bc_death_analysis, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(all_pre_ac_death_analysis, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(all_pre_rec_analysis, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(all_post_bc_death_analysis_no_Barron, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(all_post_ac_death_analysis, xlab = "Risk estimate", studlab = TRUE)
funnel.meta(all_post_rec_analysis, xlab = "Risk estimate", studlab = TRUE)
#this code produces Egger's tests for all 6 main analyses
metabias(all_pre_bc_death_analysis, method.bias = "linreg")
metabias(no_fraser_all_pre_bc_death_analysis, method.bias = "linreg")
metabias(all_pre_ac_death_analysis, method.bias = "linreg", k.min = 9)
metabias(all_pre_rec_analysis, method.bias = "linreg", k.min = 6)
metabias(all_post_bc_death_analysis_no_Barron, method.bias = "linreg")
metabias(all_post_ac_death_analysis, method.bias = "linreg")
metabias(all_post_rec_analysis, method.bias = "linreg", k.min = 6)
#this code is for analysis of postdiagnostic use stratified by stage
#first bit is looking at stage I patients only
#for Holmes 2010 as usual I am looking at 6-7 days per week use only as most closely resembles daily use
p22 <- data[c(3, 4, 306:309, 360:363)]
stage1_post_bc_death_data <- p22[c(1, 2, 15, 17),]
stage1_post_bc_death_data <- stage1_post_bc_death_data %>% unite(post_bc_death_stage1, post_bc_death_stage_I_6to7daysaweekuse_RR_only, post_bc_death_stage_I_HR, sep = "")
stage1_post_bc_death_data$post_bc_death_stage1 <- gsub("NA", "", stage1_post_bc_death_data$post_bc_death_stage1)
stage1_post_bc_death_data <- stage1_post_bc_death_data %>% unite(post_bc_death_stage1_CI, post_bc_death_stage_I_6to7daysaweekuse_RR_CI, post_bc_death_HR_stage_I_HR_CI, sep = "")
stage1_post_bc_death_data$post_bc_death_stage1_CI <- gsub("NA", "", stage1_post_bc_death_data$post_bc_death_stage1_CI)
stage1_post_bc_death_data <- stage1_post_bc_death_data %>% unite(post_bc_death_stage1_CI_lower, post_bc_death_stage_I_6to7daysaweekuse_RR_CI_lower, post_bc_death_stage_I_HR_CI_lower, sep = "")
stage1_post_bc_death_data$post_bc_death_stage1_CI_lower <- gsub("NA", "", stage1_post_bc_death_data$post_bc_death_stage1_CI_lower)
stage1_post_bc_death_data <- stage1_post_bc_death_data %>% unite(post_bc_death_stage1_CI_upper, post_bc_death_stage_I_6to7daysaweekuse_RR_CI_upper, post_bc_death_HR_stage_I_HR_CI_upper, sep = "")
stage1_post_bc_death_data$post_bc_death_stage1_CI_upper <- gsub("NA", "", stage1_post_bc_death_data$post_bc_death_stage1_CI_upper)
stage1_post_bc_death_data$post_bc_death_stage1 <- as.numeric(stage1_post_bc_death_data$post_bc_death_stage1)
stage1_post_bc_death_data$post_bc_death_stage1_CI_lower <- as.numeric(stage1_post_bc_death_data$post_bc_death_stage1_CI_lower)
stage1_post_bc_death_data$post_bc_death_stage1_CI_upper <- as.numeric(stage1_post_bc_death_data$post_bc_death_stage1_CI_upper) 
stage1_post_bc_death_analysis <- metagen(TE = log(post_bc_death_stage1), lower = log(post_bc_death_stage1_CI_lower), upper = log(post_bc_death_stage1_CI_upper), studlab = author_year, data = stage1_post_bc_death_data, exclude = NULL, sm = "HR")
summary(stage1_post_bc_death_analysis)
forest.meta(stage1_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#next bit looks at stage II patients
p23 <- data[c(3, 4, 318:321, 368:371)]
stage2_post_bc_death_data <- p23[c(1, 2, 15, 17),]
stage2_post_bc_death_data <- stage2_post_bc_death_data %>% unite(post_bc_death_stage2, post_bc_death_stage_II_6to7daysaweekuse_RR_only, post_bc_death_stage_II_HR, sep = "")
stage2_post_bc_death_data$post_bc_death_stage2 <- gsub("NA", "", stage2_post_bc_death_data$post_bc_death_stage2)
stage2_post_bc_death_data <- stage2_post_bc_death_data %>% unite(post_bc_death_stage2_CI, post_bc_death_stage_II_6to7daysaweekuse_RR_CI, post_bc_death_stage_II_HR_CI, sep = "")
stage2_post_bc_death_data$post_bc_death_stage2_CI <- gsub("NA", "", stage2_post_bc_death_data$post_bc_death_stage2_CI)
stage2_post_bc_death_data <- stage2_post_bc_death_data %>% unite(post_bc_death_stage2_CI_lower, post_bc_death_stage_II_6to7daysaweekuse_RR_CI_lower, post_bc_death_stage_II_HR_CI_lower, sep = "")
stage2_post_bc_death_data$post_bc_death_stage2_CI_lower <- gsub("NA", "", stage2_post_bc_death_data$post_bc_death_stage2_CI_lower)
stage2_post_bc_death_data <- stage2_post_bc_death_data %>% unite(post_bc_death_stage2_CI_upper, post_bc_death_stage_II_6to7daysaweekuse_RR_CI_upper, post_bc_death_stage_II_HR_CI_upper, sep = "")
stage2_post_bc_death_data$post_bc_death_stage2_CI_upper <- gsub("NA", "", stage2_post_bc_death_data$post_bc_death_stage2_CI_upper)
stage2_post_bc_death_data$post_bc_death_stage2 <- as.numeric(stage2_post_bc_death_data$post_bc_death_stage2)
stage2_post_bc_death_data$post_bc_death_stage2_CI_lower <- as.numeric(stage2_post_bc_death_data$post_bc_death_stage2_CI_lower)
stage2_post_bc_death_data$post_bc_death_stage2_CI_upper <- as.numeric(stage2_post_bc_death_data$post_bc_death_stage2_CI_upper) 
stage2_post_bc_death_analysis <- metagen(TE = log(post_bc_death_stage2), lower = log(post_bc_death_stage2_CI_lower), upper = log(post_bc_death_stage2_CI_upper), studlab = author_year, data = stage2_post_bc_death_data, exclude = NULL, sm = "HR")
summary(stage2_post_bc_death_analysis)
forest.meta(stage2_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#next bit looks at Stage III patients
p30 <- data[c(4, 330:333, 376:379)]
stage3_post_bc_death_data <- p30[c(2, 15, 17),]
stage3_post_bc_death_data <- stage3_post_bc_death_data %>% unite(post_bc_death_stage3, post_bc_death_stage_III_6to7daysaweekuse_RR_only, post_bc_death_stage_III_HR, sep = "")
stage3_post_bc_death_data$post_bc_death_stage3 <- gsub("NA", "", stage3_post_bc_death_data$post_bc_death_stage3)
stage3_post_bc_death_data <- stage3_post_bc_death_data %>% unite(post_bc_death_stage3_CI, post_bc_death_stage_III_6to7daysaweekuse_RR_CI, post_bc_death_stage_III_HR_CI, sep = "")
stage3_post_bc_death_data$post_bc_death_stage3_CI <- gsub("NA", "", stage3_post_bc_death_data$post_bc_death_stage3_CI)
stage3_post_bc_death_data <- stage3_post_bc_death_data %>% unite(post_bc_death_stage3_CI_lower, post_bc_death_stage_III_6to7daysaweekuse_RR_CI_lower, post_bc_death_stage_III_HR_CI_lower, sep = "")
stage3_post_bc_death_data$post_bc_death_stage3_CI_lower <- gsub("NA", "", stage3_post_bc_death_data$post_bc_death_stage3_CI_lower)
stage3_post_bc_death_data <- stage3_post_bc_death_data %>% unite(post_bc_death_stage3_CI_upper, post_bc_death_stage_III_6to7daysaweekuse_RR_CI_upper, post_bc_death_stage_III_HR_CI_upper, sep = "")
stage3_post_bc_death_data$post_bc_death_stage3_CI_upper <- gsub("NA", "", stage3_post_bc_death_data$post_bc_death_stage3_CI_upper)
stage3_post_bc_death_data$post_bc_death_stage3 <- as.numeric(stage3_post_bc_death_data$post_bc_death_stage3)
stage3_post_bc_death_data$post_bc_death_stage3_CI_lower <- as.numeric(stage3_post_bc_death_data$post_bc_death_stage3_CI_lower)
stage3_post_bc_death_data$post_bc_death_stage3_CI_upper <- as.numeric(stage3_post_bc_death_data$post_bc_death_stage3_CI_upper) 
stage3_post_bc_death_analysis <- metagen(TE = log(post_bc_death_stage3), lower = log(post_bc_death_stage3_CI_lower), upper = log(post_bc_death_stage3_CI_upper), studlab = author_year, data = stage3_post_bc_death_data, exclude = NULL, sm = "HR")
summary(stage3_post_bc_death_analysis)
forest.meta(stage3_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this bit looks at stage III and IV patients
#some papers already have combined Stage III and IV patient data, so they go in unchanged
#1 other has it seperate, so I will combine them manually
#come back to this later once you've worked out whether you need/want it
p31 <- data[c(4, 347:350, 376:387)]
stage3and4_post_bc_death_data <- p31[c(1, 15, 17, 20),]
#this code is for a meta regression using the stage percentages (need to use data2 dataset for this)
#this bit is for pre bc death 
#you need to run the the pre bc death code first (need to write it out here to convert to data2) 
p24 <- data2[c(1, 3, 4, 57:61, 80:83, 90:93)]
#to run this code without fraser just get rid of 6 in the next line
all_pre_bc_death_analysis_data2 <- p24[c(1, 4, 6, 7, 11, 13, 15, 16, 17, 21, 23),]
#unite columns
all_pre_bc_death_analysis_data2 <- all_pre_bc_death_analysis_data2 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data2 <- all_pre_bc_death_analysis_data2 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data2 <- all_pre_bc_death_analysis_data2 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data2 <- all_pre_bc_death_analysis_data2 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data2$pre_bc_death_OR_or_HR_higher_CIs)
#run meta analysis  
all_pre_bc_death_analysis2 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data2, exclude = NULL, sm = "HR")
#now do 4 meta regressions, one for each stage
metareg_stage_1_pre_bc_death <- metareg(all_pre_bc_death_analysis2, ~Stage_1_proportion)
metareg_stage_1_pre_bc_death
bubble(metareg_stage_1_pre_bc_death, studlab = TRUE)
metareg_stage_2_pre_bc_death <- metareg(all_pre_bc_death_analysis2, ~Stage_2_proportion)
metareg_stage_2_pre_bc_death
bubble(metareg_stage_2_pre_bc_death, studlab = TRUE)
metareg_stage_3_pre_bc_death <- metareg(all_pre_bc_death_analysis2, ~Stage_3_proportion)
metareg_stage_3_pre_bc_death
bubble(metareg_stage_3_pre_bc_death, studlab = TRUE)
metareg_stage_4_pre_bc_death <- metareg(all_pre_bc_death_analysis2, ~Stage_4_proportion)
metareg_stage_4_pre_bc_death
bubble(metareg_stage_4_pre_bc_death, studlab = TRUE)
#this code is for a pre ac death stage meta regression
p25 <- data2[c(1, 3, 4, 57:61, 189:192, 199:202)]
all_pre_ac_death_data2 <- p25[c(1, 4,  6, 11, 15, 18, 21, 23, 24),]
#Fraser is 6 here again 
#unite columns
all_pre_ac_death_data2 <- all_pre_ac_death_data2 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data2$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data2$pre_ac_death_OR_or_HR)
all_pre_ac_death_data2 <- all_pre_ac_death_data2 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data2 <- all_pre_ac_death_data2 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data2 <- all_pre_ac_death_data2 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data2$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data2$pre_ac_death_OR_or_HR)
all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data2$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis2 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data2, exclude = NULL, sm = "HR")
#again do a meta regression for each stage
metareg_stage_1_pre_ac_death <- metareg(all_pre_ac_death_analysis2, ~Stage_1_proportion)
metareg_stage_1_pre_ac_death
bubble(metareg_stage_1_pre_ac_death, studlab = TRUE)
metareg_stage_2_pre_ac_death <- metareg(all_pre_ac_death_analysis2, ~Stage_2_proportion)
metareg_stage_2_pre_ac_death
bubble(metareg_stage_2_pre_ac_death, studlab = TRUE)
metareg_stage_3_pre_ac_death <- metareg(all_pre_ac_death_analysis2, ~Stage_3_proportion)
metareg_stage_3_pre_ac_death
bubble(metareg_stage_3_pre_ac_death, studlab = TRUE)
metareg_stage_4_pre_ac_death <- metareg(all_pre_ac_death_analysis2, ~Stage_4_proportion)
metareg_stage_4_pre_ac_death
bubble(metareg_stage_4_pre_ac_death, studlab = TRUE)
#this code is for a pre rec stage meta regression
p26 <- data2[c(1, 57:61,  210:213, 220:223, 226:229, 231:234)]
all_pre_rec_data2 <- p26[c(5, 7, 10, 18, 23, 24),]
#unite columns 
all_pre_rec_data2 <- all_pre_rec_data2 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data2$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR)
all_pre_rec_data2$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR)
all_pre_rec_data2$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR) 
all_pre_rec_data2 <- all_pre_rec_data2 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data2 <- all_pre_rec_data2 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data2 <- all_pre_rec_data2 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data2$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data2$pre_rec_OR_RR_or_HR)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data2$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis2 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data2, exclude = NULL, sm = "HR")
#do meta regressions
metareg_stage_1_pre_rec <- metareg(all_pre_rec_analysis2, ~Stage_1_proportion)
metareg_stage_1_pre_rec
bubble(metareg_stage_1_pre_rec, studlab = TRUE)
metareg_stage_2_pre_rec <- metareg(all_pre_rec_analysis2, ~Stage_2_proportion)
metareg_stage_2_pre_rec
bubble(metareg_stage_2_pre_rec, studlab = TRUE)
metareg_stage_3_pre_rec <- metareg(all_pre_rec_analysis2, ~Stage_3_proportion)
metareg_stage_3_pre_rec
bubble(metareg_stage_3_pre_rec, studlab = TRUE)
#didn't do a Stage IV one bc only 2 papers had data
#this code is for a post bc death stage meta regression
p27 <- data2[c(1, 57:61, 256:259, 267:270, 272:275, 277:280)]
all_post_bc_death_data2 <- p27[c(2, 3, 6, 7, 8, 9, 11, 15, 16, 22, 23),]
all_post_bc_death_data2$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data2$unadj_post_bc_death_OR_only)
all_post_bc_death_data2$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data2$unadj_post_bc_death_OR_CI)
all_post_bc_death_data2$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data2$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data2$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data2$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data2 <- all_post_bc_death_data2 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data2$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data2 <- all_post_bc_death_data2 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data2 <- all_post_bc_death_data2 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data2 <- all_post_bc_death_data2 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data2$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data2$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis2 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data2, exclude = NULL, sm = "HR")
#do meta regressions
metareg_stage_1_post_bc_death <- metareg(all_post_bc_death_analysis2, ~Stage_1_proportion)
metareg_stage_1_post_bc_death
bubble(metareg_stage_1_post_bc_death, studlab = TRUE)
metareg_stage_2_post_bc_death <- metareg(all_post_bc_death_analysis2, ~Stage_2_proportion)
metareg_stage_2_post_bc_death
bubble(metareg_stage_2_post_bc_death, studlab = TRUE)
metareg_stage_3_post_bc_death <- metareg(all_post_bc_death_analysis2, ~Stage_3_proportion)
metareg_stage_3_post_bc_death
bubble(metareg_stage_3_post_bc_death, studlab = TRUE)
metareg_stage_4_post_bc_death <- metareg(all_post_bc_death_analysis2, ~Stage_4_proportion)
metareg_stage_4_post_bc_death
bubble(metareg_stage_4_post_bc_death, studlab = TRUE)
#this code is for a post ac death stage meta regression
p28 <- data2[c(1, 57:61, 596:599, 606:609, 612:615, 625:628, 630:633)]
all_post_ac_data2 <- p28[c(2, 3, 6, 8, 9, 11, 12, 14, 15, 16, 19, 20, 23, 24),]
#took wang out bc don't need it (no stage data) and was messing my attempts to make a bubble plot up
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data2$post_ac_death_unadj_HR)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data2$post_ac_death_unadj_HR_CI)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data2$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data2 <- all_post_ac_data2 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data2$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data2 <- all_post_ac_data2 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data2 <- all_post_ac_data2 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data2 <- all_post_ac_data2 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data2$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data2$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis2 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data2, exclude = NULL, sm = "HR")
#do meta regressions
metareg_stage_1_post_ac_death <- metareg(all_post_ac_death_analysis2, ~Stage_1_proportion)
metareg_stage_1_post_ac_death
bubble(metareg_stage_1_post_ac_death, studlab = TRUE)
metareg_stage_2_post_ac_death <- metareg(all_post_ac_death_analysis2, ~Stage_2_proportion)
metareg_stage_2_post_ac_death
bubble(metareg_stage_2_post_ac_death, studlab = TRUE)
metareg_stage_3_post_ac_death <- metareg(all_post_ac_death_analysis2, ~Stage_3_proportion)
metareg_stage_3_post_ac_death
bubble(metareg_stage_3_post_ac_death, studlab = TRUE)
metareg_stage_4_post_ac_death <- metareg(all_post_ac_death_analysis2, ~Stage_4_proportion)
metareg_stage_4_post_ac_death
bubble(metareg_stage_4_post_ac_death, studlab = TRUE)
#this code is for a meta regression of post rec by stage proportion
p29 <- data2[c(1, 57:61, 768:771, 774:777, 787:790)]
all_post_rec_data2 <- p29[c(5, 8, 10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis2 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
#do meta regressions
#can't do a Stage IV one as none of the papers have Stage IV data
metareg_stage_1_post_rec <- metareg(all_post_rec_analysis2, ~Stage_1_proportion)
metareg_stage_1_post_rec
bubble(metareg_stage_1_post_rec, studlab = TRUE)
metareg_stage_2_post_rec <- metareg(all_post_rec_analysis2, ~Stage_2_proportion)
metareg_stage_2_post_rec
bubble(metareg_stage_2_post_rec, studlab = TRUE)
metareg_stage_3_post_rec <- metareg(all_post_rec_analysis2, ~Stage_3_proportion)
metareg_stage_3_post_rec
bubble(metareg_stage_3_post_rec, studlab = TRUE)
#do age meta regressions for rest of analyses (not just post bc death)
#this is for pre bc death
metareg_age_all_pre_bc_death <- metareg(all_pre_bc_death_analysis, ~mean_or_median_age)
metareg_age_all_pre_bc_death
bubble(metareg_age_all_pre_bc_death, studlab = TRUE)
#this is for pre ac death
metareg_age_all_pre_ac_death <- metareg(all_pre_ac_death_analysis, ~mean_or_median_age)
metareg_age_all_pre_ac_death
bubble(metareg_age_all_pre_ac_death, studlab = TRUE)
#this is for pre rec
metareg_age_all_pre_rec <- metareg(all_pre_rec_analysis, ~mean_or_median_age)
metareg_age_all_pre_rec
bubble(metareg_age_all_pre_rec, studlab = TRUE)
#this is for post ac death
metareg_age_all_post_ac_death <- metareg(all_post_ac_death_analysis, ~mean_or_median_age)
metareg_age_all_post_ac_death
bubble(metareg_age_all_post_ac_death, studlab = TRUE)
#this is for post rec
metareg_age_all_post_rec <- metareg(all_post_rec_analysis, ~mean_or_median_age)
metareg_age_all_post_rec
bubble(metareg_age_all_post_rec, studlab = TRUE)
#this next bit of code is for menopause-stratified meta regressions
#I am going to create 2 new columns, '% of women in study postmenopausal' and '% of women in study premenopausal'
#and do meta regressions based on therese columns
#not ideal bc some are 100% postmenopausal, but should be useful for spotting patterns (hopefully)
#rewrite pre bc death stuff to include the menopause columns 
#to save space I'm just going to change the line about which rows to select from the stage 1 pre bc death code (and add the menopause columns to it)
#so for these meta regressions, run the two lines specifying which rows/columns to take, then the rest of the original code up to the meta analysis bit, then the new meta regression code from below
#also made alterations for fact there are 2 extra columns in data2 now
p24 <- data2[c(1, 3, 4, 57:61, 68:69, 82:85, 92:95)]
all_pre_bc_death_analysis_data2 <- p24[c(4, 11, 21),]
#run meta regression based on this new data
metareg_menopause_pre_bc_death <- metareg(all_pre_bc_death_analysis2, ~percent_postmenopausal)
metareg_menopause_pre_bc_death
bubble(metareg_menopause_pre_bc_death, studlab = TRUE)
#do same for pre ac death
p25 <- data2[c(1, 3, 4, 57:61, 68:69, 185:188, 195:198)]
all_pre_ac_death_data2 <- p25[c(4, 11, 18, 21),]
#do 2 analyses, 1 with % postmenopausal and 1 with % premenopausal (as Sendur's values for these two do not sum to 100)
metareg_menopause_pre_ac_death <- metareg(all_pre_ac_death_analysis2, ~percent_postmenopausal)
metareg_menopause_pre_ac_death
bubble(metareg_menopause_pre_ac_death, studlab = TRUE)
metareg_menopause_pre_ac_death2 <- metareg(all_pre_ac_death_analysis2, ~percent_premenopausal)
metareg_menopause_pre_ac_death2
bubble(metareg_menopause_pre_ac_death2, studlab = TRUE)
#do same for pre rec
p26 <- data2[c(1, 57:61, 68:69, 212:215, 222:225, 228:231, 233:236)]
all_pre_rec_data2 <- p26[c(5, 10, 18),]
metareg_menopause_pre_rec <- metareg(all_pre_rec_analysis2, ~percent_premenopausal)
metareg_menopause_pre_rec
bubble(metareg_menopause_pre_rec, studlab = TRUE)
metareg_menopause_pre_rec2 <- metareg(all_pre_rec_analysis2, ~percent_postmenopausal)
metareg_menopause_pre_rec2
bubble(metareg_menopause_pre_rec2, studlab = TRUE)
#now do same for post bc death
p27 <- data2[c(1, 57:61, 68:69, 258:261, 269:272, 274:277, 279:282)]
all_post_bc_death_data2 <- p27[c(3, 8, 11, 22),]
metareg_menopause_post_bc_death <- metareg(all_post_bc_death_analysis2, ~percent_postmenopausal)
metareg_menopause_post_bc_death
bubble(metareg_menopause_post_bc_death, studlab = TRUE)
#now do same for post ac death
p28 <- data2[c(1, 57:61, 68:69, 592:595, 602:605, 608:611, 621:624, 626:629)]
all_post_ac_data2 <- p28[c(3, 8, 11, 20, 22),]
metareg_menopause_post_ac_death <- metareg(all_post_ac_death_analysis2, ~percent_postmenopausal)
metareg_menopause_post_ac_death
bubble(metareg_menopause_post_ac_death, studlab = TRUE)
#now do same for post rec
p29 <- data2[c(1, 57:61, 68:69, 770:773, 776:779, 789:792)]
all_post_rec_data2 <- p29[c(5, 8, 10, 20),]
metareg_menopause_post_rec <- metareg(all_post_rec_analysis2, ~percent_postmenopausal)
metareg_menopause_post_rec
bubble(metareg_menopause_post_rec, studlab = TRUE)
#this code is for a subgroup analysis of ER status for post bc death
#again using 6-7 days pw use for Holmes
p32 <- data[c(4, 427:430, 439:442, 456:459, 468:471)]
post_bc_death_ER_data <- p32[c(2, 15, 17),]
#do an ER+ meta analysis first
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_pos, post_bc_death_ER_pos_6to7_daysaweekuse_RR, ER_pos_HR_post_bc_death, sep = "")
post_bc_death_ER_data$post_bc_death_ER_pos <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_pos)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_pos_CI, post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI, ER_pos_HR_CI_post_bc_death, sep = "")
post_bc_death_ER_data$post_bc_death_ER_pos_CI <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_pos_CI)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_pos_CI_lower, post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI_lower, ER_pos_HR_CI_lower_post_bc_death, sep = "")
post_bc_death_ER_data$post_bc_death_ER_pos_CI_lower <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_pos_CI_lower)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_pos_CI_upper, post_bc_death_ER_pos_6to7_daysaweekuse_RR_CI_upper, ER_pos_HR_CI_upper_post_bc_death, sep = "")
post_bc_death_ER_data$post_bc_death_ER_pos_CI_upper <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_pos_CI_upper)
post_bc_death_ER_data$post_bc_death_ER_pos <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_pos)
post_bc_death_ER_data$post_bc_death_ER_pos_CI_lower <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_pos_CI_lower)
post_bc_death_ER_data$post_bc_death_ER_pos_CI_upper <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_pos_CI_upper)
er_pos_post_bc_death_analysis <- metagen(TE = log(post_bc_death_ER_pos), lower = log(post_bc_death_ER_pos_CI_lower), upper = log(post_bc_death_ER_pos_CI_upper), studlab = author_year, data = post_bc_death_ER_data, exclude = NULL, sm = "HR")
summary(er_pos_post_bc_death_analysis)
forest.meta(er_pos_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#now do ER negative meta analysis
post_bc_death_ER_data <- post_bc_death_ER_data[-c(2),]
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_neg, post_bc_death_ER_neg_6to7_daysaweekuse_RR, post_bc_death_ER_neg_HR, sep = "")
post_bc_death_ER_data$post_bc_death_ER_neg <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_neg)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_neg_CI, post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI, post_bc_death_ER_neg_HR_CI, sep = "")
post_bc_death_ER_data$post_bc_death_ER_neg_CI <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_neg_CI)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_neg_CI_lower, post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI_lower, post_bc_death_ER_neg_HR_CI_lower, sep = "")
post_bc_death_ER_data$post_bc_death_ER_neg_CI_lower <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_neg_CI_lower)
post_bc_death_ER_data <- post_bc_death_ER_data %>% unite(post_bc_death_ER_neg_CI_upper, post_bc_death_ER_neg_6to7_daysaweekuse_RR_CI_upper, post_bc_death_ER_neg_HR_CI_upper, sep = "")
post_bc_death_ER_data$post_bc_death_ER_neg_CI_upper <- gsub("NA", "", post_bc_death_ER_data$post_bc_death_ER_neg_CI_upper)
post_bc_death_ER_data$post_bc_death_ER_neg <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_neg)
post_bc_death_ER_data$post_bc_death_ER_neg_CI_lower <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_neg_CI_lower)
post_bc_death_ER_data$post_bc_death_ER_neg_CI_upper <- as.numeric(post_bc_death_ER_data$post_bc_death_ER_neg_CI_upper)
er_neg_post_bc_death_analysis <- metagen(TE = log(post_bc_death_ER_neg), lower = log(post_bc_death_ER_neg_CI_lower), upper = log(post_bc_death_ER_neg_CI_upper), studlab = author_year, data = post_bc_death_ER_data, exclude = NULL, sm = "HR")
summary(er_neg_post_bc_death_analysis)
forest.meta(er_neg_post_bc_death_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
#this is for a meta regression of grade
#need to start by creating some grade columns like the stage ones
#might do data3, data4 etc. from now on so don't have to keep changing numbers further up
#start by making new grade columns in excel
#pretty sure grade 1 is equal to low, grade 2 to intermediate and grade 3 to high, so will treat the data as such 
#not going to do a grade 4 analysis bc only 2 papers have this data
#this code is for a grade 1/2/3 proportion meta regression for pre bc death
z1 <- data2[c(1, 65:68, 86:89, 96:99)]
all_pre_bc_death_analysis_data3 <- z1[c(1, 4, 6, 15, 16, 23),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis3 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
#do meta regressions
metareg_grade1_pre_bc_death <- metareg(all_pre_bc_death_analysis3, ~grade1_percent)
metareg_grade1_pre_bc_death
bubble(metareg_grade1_pre_bc_death, studlab = TRUE)
metareg_grade2_pre_bc_death <- metareg(all_pre_bc_death_analysis3, ~grade2_percent)
metareg_grade2_pre_bc_death
bubble(metareg_grade2_pre_bc_death, studlab = TRUE)
metareg_grade3_pre_bc_death <- metareg(all_pre_bc_death_analysis3, ~grade3_percent)
metareg_grade3_pre_bc_death
bubble(metareg_grade3_pre_bc_death, studlab = TRUE)
#this code is for grade meta regression of pre ac death
z2 <- data2[c(1, 65:68, 189:192, 199:202)]
all_pre_ac_death_data3 <- z2[c(1, 4, 6, 15, 18, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis3 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
#do meta regressions
metareg_grade1_pre_ac_death <- metareg(all_pre_ac_death_analysis3, ~grade1_percent)
metareg_grade1_pre_ac_death
bubble(metareg_grade1_pre_ac_death, studlab = TRUE)
metareg_grade2_pre_ac_death <- metareg(all_pre_ac_death_analysis3, ~grade2_percent)
metareg_grade2_pre_ac_death
bubble(metareg_grade2_pre_ac_death, studlab = TRUE)
metareg_grade3_pre_ac_death <- metareg(all_pre_ac_death_analysis3, ~grade3_percent)
metareg_grade3_pre_ac_death
bubble(metareg_grade3_pre_ac_death, studlab = TRUE)
#this code is for a grade meta regression of pre rec
z3 <- data2[c(1, 65:68, 216:219, 226:229, 232:235, 237:240)]
all_pre_rec_data3 <- z3[c(5, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis3 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR")
#do meta regressions
metareg_grade1_pre_rec <- metareg(all_pre_rec_analysis3, ~grade1_percent)
metareg_grade1_pre_rec
bubble(metareg_grade1_pre_rec, studlab = TRUE)
metareg_grade2_pre_rec <- metareg(all_pre_rec_analysis3, ~grade2_percent)
metareg_grade2_pre_rec
bubble(metareg_grade2_pre_rec, studlab = TRUE)
metareg_grade3_pre_rec <- metareg(all_pre_rec_analysis3, ~grade3_percent)
metareg_grade3_pre_rec
bubble(metareg_grade3_pre_rec, studlab = TRUE)
#this code is for a grade meta regression of post bc death
z4 <- data2[c(1, 65:68, 262:265, 273:276, 278:281, 283:286)]
all_post_bc_death_data3 <- z4[c(2, 6, 15, 16, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis3 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
#do meta regressions
metareg_grade1_post_bc_death <- metareg(all_post_bc_death_analysis3, ~grade1_percent)
metareg_grade1_post_bc_death
bubble(metareg_grade1_post_bc_death, studlab = TRUE)
metareg_grade2_post_bc_death <- metareg(all_post_bc_death_analysis3, ~grade2_percent)
metareg_grade2_post_bc_death
bubble(metareg_grade2_post_bc_death, studlab = TRUE)
metareg_grade3_post_bc_death <- metareg(all_post_bc_death_analysis3, ~grade3_percent)
metareg_grade3_post_bc_death
bubble(metareg_grade3_post_bc_death, studlab = TRUE)
#this code is for a post ac death grade meta regression
z5 <- data2[c(1, 65:68, 596:599, 606:609, 612:615, 625:628, 630:633)]
all_post_ac_data3 <- z5[c(2, 6, 14, 15, 16, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis3 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
#do meta regressions 
metareg_grade1_post_ac_death <- metareg(all_post_ac_death_analysis3, ~grade1_percent)
metareg_grade1_post_ac_death
bubble(metareg_grade1_post_ac_death, studlab = TRUE)
metareg_grade2_post_ac_death <- metareg(all_post_ac_death_analysis3, ~grade2_percent)
metareg_grade2_post_ac_death
bubble(metareg_grade2_post_ac_death, studlab = TRUE)
metareg_grade3_post_ac_death <- metareg(all_post_ac_death_analysis3, ~grade3_percent)
metareg_grade3_post_ac_death
bubble(metareg_grade3_post_ac_death, studlab = TRUE)
#only 2 post rec papers have grade data, so can't really do a meta regression based on that
#will now do meta regressions of sample size and study year for all the other analyses
#this is a meta regression of study year and pre bc death
#run the normal pre bc death regression first (do for all these analyses)
metareg_year_pre_bc_death <- metareg(all_pre_bc_death_analysis, ~year)
metareg_year_pre_bc_death
bubble(metareg_year_pre_bc_death, studlab = TRUE)
#this is a meta regression of year and pre ac death
metareg_year_pre_ac_death <- metareg(all_pre_ac_death_analysis, ~year)
metareg_year_pre_ac_death
bubble(metareg_year_pre_ac_death, studlab = TRUE)
#this is a meta regression of year and pre rec
metareg_year_pre_rec <- metareg(all_pre_rec_analysis, ~year)
metareg_year_pre_rec
bubble(metareg_year_pre_rec, studlab = TRUE)
#this is a meta regression of year and post ac death
metareg_year_post_ac_death <- metareg(all_post_ac_death_analysis, ~year)
metareg_year_post_ac_death
bubble(metareg_year_post_ac_death, studlab = TRUE)
#this is a meta regression of year and post rec
metareg_year_post_rec <- metareg(all_post_rec_analysis, ~year)
metareg_year_post_rec
bubble(metareg_year_post_rec, studlab = TRUE)
#this is pre bc death sample size
metareg_sample_size_pre_bc_death <- metareg(all_pre_bc_death_analysis, ~cohort_size_number_only)
metareg_sample_size_pre_bc_death
bubble(metareg_sample_size_pre_bc_death, studlab = TRUE)
#this is pre ac death sample size
metareg_sample_size_pre_ac_death <- metareg(all_pre_ac_death_analysis, ~cohort_size_number_only)
metareg_sample_size_pre_ac_death
bubble(metareg_sample_size_pre_ac_death, studlab = TRUE)
#this is for pre rec sample size
metareg_sample_size_pre_rec <- metareg(all_pre_rec_analysis, ~cohort_size_number_only)
metareg_sample_size_pre_rec
bubble(metareg_sample_size_pre_rec, studlab = TRUE)
#this is for post ac death sample size
metareg_sample_size_post_ac_death <- metareg(all_post_ac_death_analysis, ~cohort_size_number_only)
metareg_sample_size_post_ac_death
bubble(metareg_sample_size_post_ac_death, studlab = TRUE)
#this is for post rec sample size
metareg_sample_size_post_rec <- metareg(all_post_rec_analysis, ~cohort_size_number_only)
metareg_sample_size_post_rec
bubble(metareg_sample_size_post_rec, studlab = TRUE)
#now do meta regressions of smoking status and all 6 analyses
#start with pre bc death
s1 <- data2[c(1, 75:77, 89:92, 99:102)]
all_pre_bc_death_analysis_data3 <- s1[c(1, 4, 13, 16, 17, 21),]
#unite columns
#just going to leave it as all pre bc death analysis 3 to save time coding, can run stuff up to point is needed if need to do again
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis4 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
#now do meta regressions for never, past, current smokers
metareg_never_smokers_pre_bc_death <- metareg(all_pre_bc_death_analysis4, ~percent_never_smoker)
metareg_never_smokers_pre_bc_death
bubble(metareg_never_smokers_pre_bc_death, studlab = TRUE)
metareg_past_smokers_pre_bc_death <- metareg(all_pre_bc_death_analysis4, ~percent_past_smoker)
metareg_past_smokers_pre_bc_death
bubble(metareg_past_smokers_pre_bc_death, studlab = TRUE)
metareg_current_smokers_pre_bc_death <- metareg(all_pre_bc_death_analysis4, ~percent_current_smoker)
metareg_current_smokers_pre_bc_death
bubble(metareg_current_smokers_pre_bc_death, studlab = TRUE)
#this code is for pre ac death smoking meta regression
s2 <- data2[c(1, 75:77, 192:195, 202:205)]
all_pre_ac_death_data3 <- s2[c(1, 4, 18, 21),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis4 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_never_smokers_pre_ac_death <- metareg(all_pre_ac_death_analysis4, ~percent_never_smoker)
metareg_never_smokers_pre_ac_death
bubble(metareg_never_smokers_pre_ac_death, studlab = TRUE)
metareg_past_smokers_pre_ac_death <- metareg(all_pre_ac_death_analysis4, ~percent_past_smoker)
metareg_past_smokers_pre_ac_death
bubble(metareg_past_smokers_pre_ac_death, studlab = TRUE)
metareg_current_smokers_pre_ac_death <- metareg(all_pre_ac_death_analysis4, ~percent_current_smoker)
metareg_current_smokers_pre_ac_death
bubble(metareg_current_smokers_pre_ac_death, studlab = TRUE)
#not enough pre rec papers have smoking data to do a meta regression
#this code is for a post bc death smoking meta regression
s3 <- data2[c(1, 75:77, 265:268, 276:279, 281:284, 286:289)]
all_post_bc_death_data3 <- s3[c(2, 16, 22),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis4 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_never_smokers_post_bc_death <- metareg(all_post_bc_death_analysis4, ~percent_never_smoker)
metareg_never_smokers_post_bc_death
bubble(metareg_never_smokers_post_bc_death, studlab = TRUE)
metareg_past_smokers_post_bc_death <- metareg(all_post_bc_death_analysis4, ~percent_past_smoker)
metareg_past_smokers_post_bc_death
bubble(metareg_past_smokers_post_bc_death, studlab = TRUE)
metareg_current_smokers_post_bc_death <- metareg(all_post_bc_death_analysis4, ~percent_current_smoker)
metareg_current_smokers_post_bc_death
bubble(metareg_current_smokers_post_bc_death, studlab = TRUE)
#this code is for a post ac death smoking meta regression
s4 <- data2[c(1, 75:77, 599:602, 609:612, 615:618, 628:631, 633:636)]
all_post_ac_data3 <- s4[c(2, 16, 22),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis4 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_never_smokers_post_ac_death <- metareg(all_post_ac_death_analysis4, ~percent_never_smoker)
metareg_never_smokers_post_ac_death
bubble(metareg_never_smokers_post_ac_death, studlab = TRUE)
metareg_past_smokers_post_ac_death <- metareg(all_post_ac_death_analysis4, ~percent_past_smoker)
metareg_past_smokers_post_ac_death
bubble(metareg_past_smokers_post_ac_death, studlab = TRUE)
metareg_current_smokers_post_ac_death <- metareg(all_post_ac_death_analysis4, ~percent_current_smoker)
metareg_current_smokers_post_ac_death
bubble(metareg_current_smokers_post_ac_death, studlab = TRUE)
#not enough of the post rec papers have smoking data to do an analysis
#now do meta regressions of molsubtype data
#start with meta regressions by % ER positive
#for any analysis w Zhou 2019 involved may be worth doing a regression by % negative too
#start as usual w pre bc death
e1 <- data2[c(1, 70, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- e1[c(1, 4, 6, 7, 11, 15),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis5 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_ER_pos_pre_bc_death <- metareg(all_pre_bc_death_analysis5, ~ER_pos_percent)
metareg_ER_pos_pre_bc_death
bubble(metareg_ER_pos_pre_bc_death, studlab = TRUE)
#this is pre ac death er pos/neg
e2 <- data2[c(1, 70, 71, 204:207, 214:217)] 
all_pre_ac_death_data3 <- e2[c(1, 4, 6, 11, 15, 18, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis5 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_ER_pos_pre_ac_death <- metareg(all_pre_ac_death_analysis5, ~ER_pos_percent)
metareg_ER_pos_pre_ac_death
bubble(metareg_ER_pos_pre_ac_death, studlab = TRUE)
metareg_ER_neg_pre_ac_death <- metareg(all_pre_ac_death_analysis5, ~ER_neg_percent)
metareg_ER_neg_pre_ac_death
bubble(metareg_ER_neg_pre_ac_death, studlab = TRUE)
#this is for pre rec er pos/neg
e3 <- data2[c(1, 70:71, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- e3[c(5, 7, 10, 18, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis5 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_ER_pos_pre_rec <- metareg(all_pre_rec_analysis5, ~ER_pos_percent)
metareg_ER_pos_pre_rec
bubble(metareg_ER_pos_pre_rec, studlab = TRUE)
metareg_ER_neg_pre_rec <- metareg(all_pre_rec_analysis5, ~ER_neg_percent)
metareg_ER_neg_pre_rec
bubble(metareg_ER_neg_pre_rec, studlab = TRUE)
#this is for post bc death ER pos
e4 <- data2[c(1, 70, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- e4[c(2, 3, 6, 7, 8, 11, 15),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis5 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_ER_pos_post_bc_death <- metareg(all_post_bc_death_analysis5, ~ER_pos_percent)
metareg_ER_pos_post_bc_death
bubble(metareg_ER_pos_post_bc_death, studlab = TRUE)
#this is for post ac death ER pos/neg
e5 <- data2[c(1, 70:71, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- e5[c(2, 3, 6, 8, 11, 14, 15, 20, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis5 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_ER_pos_post_ac_death <- metareg(all_post_ac_death_analysis5, ~ER_pos_percent)
metareg_ER_pos_post_ac_death
bubble(metareg_ER_pos_post_ac_death, studlab = TRUE)
metareg_ER_neg_post_ac_death <- metareg(all_post_ac_death_analysis5, ~ER_neg_percent)
metareg_ER_neg_post_ac_death
bubble(metareg_ER_neg_post_ac_death, studlab = TRUE)
#this is for post rec er pos 
e6 <- data2[c(1, 70, 789:792, 795:798, 808:811)]
all_post_rec_data2 <- e6[c(5, 8, 10, 20),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis5 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_ER_pos_post_rec <- metareg(all_post_rec_analysis5, ~ER_pos_percent)
metareg_ER_pos_post_rec
bubble(metareg_ER_pos_post_rec, studlab = TRUE)
#now do meta regressions of PR status
#start w pre bc death 
pr1 <- data2[c(1, 72, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- pr1[c(1, 4, 11),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis6 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_PR_pos_pre_bc_death <- metareg(all_pre_bc_death_analysis6, ~PR_pos_percent)
metareg_PR_pos_pre_bc_death
bubble(metareg_PR_pos_pre_bc_death, studlab = TRUE)
#this is pre ac death pr pos/neg
pr2 <- data2[c(1, 72:73, 204:207, 214:217)] 
all_pre_ac_death_data3 <- pr2[c(1, 4, 11, 18, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis6 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_PR_pos_pre_ac_death <- metareg(all_pre_ac_death_analysis6, ~PR_pos_percent)
metareg_PR_pos_pre_ac_death
bubble(metareg_PR_pos_pre_ac_death, studlab = TRUE)
metareg_PR_neg_pre_ac_death <- metareg(all_pre_ac_death_analysis6, ~PR_neg_percent)
metareg_PR_neg_pre_ac_death
bubble(metareg_PR_neg_pre_ac_death, studlab = TRUE)
#not enough papers have PR data to do pre rec PR meta analysis
#this is for post bc death PR pos
pr4 <- data2[c(1, 72, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- pr4[c(2, 3, 11),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis6 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_PR_pos_post_bc_death <- metareg(all_post_bc_death_analysis6, ~PR_pos_percent)
metareg_PR_pos_post_bc_death
bubble(metareg_PR_pos_post_bc_death, studlab = TRUE)
#this is for post ac death PR pos/neg
pr5 <- data2[c(1, 72:73, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- pr5[c(2, 3, 11, 14, 20, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis6 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_PR_pos_post_ac_death <- metareg(all_post_ac_death_analysis6, ~PR_pos_percent)
metareg_PR_pos_post_ac_death
bubble(metareg_PR_pos_post_ac_death, studlab = TRUE)
metareg_PR_neg_post_ac_death <- metareg(all_post_ac_death_analysis6, ~PR_neg_percent)
metareg_PR_neg_post_ac_death
bubble(metareg_PR_neg_post_ac_death, studlab = TRUE)
#not enough papers have PR data to do a post rec meta regression
#now do meta regressions for HER2+ proportion
#start with pre bc death 
h1 <- data2[c(1, 74, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- h1[c(1, 4, 7, 11, 23),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis7 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_HER2_pos_pre_bc_death <- metareg(all_pre_bc_death_analysis7, ~HER2_pos_percent)
metareg_HER2_pos_pre_bc_death
bubble(metareg_HER2_pos_pre_bc_death, studlab = TRUE)
#this is for pre ac death HER2 pos
h2 <- data2[c(1, 74, 204:207, 214:217)] 
all_pre_ac_death_data3 <- h2[c(1, 4, 11, 18, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis7 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_HER2_pos_pre_ac_death <- metareg(all_pre_ac_death_analysis7, ~HER2_pos_percent)
metareg_HER2_pos_pre_ac_death
bubble(metareg_HER2_pos_pre_ac_death, studlab = TRUE)
#this is for pre rec HER2 pos
h3 <- data2[c(1, 74, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- h3[c(7, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis7 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_HER2_pos_pre_rec <- metareg(all_pre_rec_analysis7, ~HER2_pos_percent)
metareg_HER2_pos_pre_rec
bubble(metareg_HER2_pos_pre_rec, studlab = TRUE)
#this is for post bc death HER2 pos
h4 <- data2[c(1, 74, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- h4[c(2, 7, 11, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis7 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_HER2_pos_post_bc_death <- metareg(all_post_bc_death_analysis7, ~HER2_pos_percent)
metareg_HER2_pos_post_bc_death
bubble(metareg_HER2_pos_post_bc_death, studlab = TRUE)
#this is for post ac death HER2 pos
h5 <- data2[c(1, 74, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- h5[c(2, 11, 14, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis7 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_HER2_pos_post_ac_death <- metareg(all_post_ac_death_analysis7, ~HER2_pos_percent)
metareg_HER2_pos_post_ac_death
bubble(metareg_HER2_pos_post_ac_death, studlab = TRUE)
#not enough post rec papers have HER2 data to do regression
#now do HR status meta regressions for pre ac death and post ac death (only ones w enough papers (>=3) to justify it)
#start with pre ac death
hr1 <- data2[c(1, 76, 204:207, 214:217)] 
all_pre_ac_death_data3 <- hr1[c(21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis8 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_HR_pos_pre_ac_death <- metareg(all_pre_ac_death_analysis8, ~HR_pos_percent)
metareg_HR_pos_pre_ac_death
bubble(metareg_HR_pos_pre_ac_death, studlab = TRUE)
#this is for post ac death HR pos
hr2 <- data2[c(1, 76, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- hr2[c(14, 20, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis8 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_HR_pos_post_ac_death <- metareg(all_post_ac_death_analysis8, ~HR_pos_percent)
metareg_HR_pos_post_ac_death
bubble(metareg_HR_pos_post_ac_death, studlab = TRUE)
#now do meta regressions of treatment details (radiotherapy, chemotherapy, hormone therapy, surgery)
#start with radiotherapy proportion
#start with pre bc death
r1 <- data2[c(1, 79, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- r1[c(6, 7, 15, 16, 21, 23),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis9 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_radiation_pre_bc_death <- metareg(all_pre_bc_death_analysis9, ~radiation_percent)
metareg_radiation_pre_bc_death
bubble(metareg_radiation_pre_bc_death, studlab = TRUE)
#this is for pre ac death radiation
r2 <- data2[c(1, 79, 204:207, 214:217)] 
all_pre_ac_death_data3 <- r2[c(6, 15, 18, 21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis9 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_radiation_pre_ac_death <- metareg(all_pre_ac_death_analysis9, ~radiation_percent)
metareg_radiation_pre_ac_death
bubble(metareg_radiation_pre_ac_death, studlab = TRUE)
#this is for pre rec radiation
r3 <- data2[c(1, 79, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- r3[c(5, 7, 10, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis9 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_radiation_pre_rec <- metareg(all_pre_rec_analysis9, ~radiation_percent)
metareg_radiation_pre_rec
bubble(metareg_radiation_pre_rec, studlab = TRUE)
#this is for post bc death radiation
r4 <- data2[c(1, 79, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- r4[c(6, 7, 15, 16, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis9 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_radiation_post_bc_death <- metareg(all_post_bc_death_analysis9, ~radiation_percent)
metareg_radiation_post_bc_death
bubble(metareg_radiation_post_bc_death, studlab = TRUE)
#this is for post ac death radiation
r5 <- data2[c(1, 79, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- r5[c(6, 15, 16, 19, 20, 22, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis9 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_radiation_post_ac_death <- metareg(all_post_ac_death_analysis9, ~radiation_percent)
metareg_radiation_post_ac_death
bubble(metareg_radiation_post_ac_death, studlab = TRUE)
#this is for post rec radiation
r6 <- data2[c(1, 79, 789:792, 795:798, 808:811)]
all_post_rec_data2 <- r6[c(5, 10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis9 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_radiation_post_rec <- metareg(all_post_rec_analysis9, ~radiation_percent)
metareg_radiation_post_rec
bubble(metareg_radiation_post_rec, studlab = TRUE)
#now do chemo meta regressions for all meta analyses
#start with pre bc death again
c1 <- data2[c(1, 80, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- c1[c(6, 7, 15, 16, 21, 23),]
#unite columns
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis10 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_chemo_pre_bc_death <- metareg(all_pre_bc_death_analysis10, ~chemo_percent)
metareg_chemo_pre_bc_death
bubble(metareg_chemo_pre_bc_death, studlab = TRUE)
#this is for pre ac death chemo
c2 <- data2[c(1, 80, 204:207, 214:217)] 
all_pre_ac_death_data3 <- c2[c(6, 15, 18, 21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis10 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_chemo_pre_ac_death <- metareg(all_pre_ac_death_analysis10, ~chemo_percent)
metareg_chemo_pre_ac_death
bubble(metareg_chemo_pre_ac_death, studlab = TRUE)
#this is for pre rec chemo
c3 <- data2[c(1, 80, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- c3[c(5, 7, 10, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis10 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_chemo_pre_rec <- metareg(all_pre_rec_analysis10, ~chemo_percent)
metareg_chemo_pre_rec
bubble(metareg_chemo_pre_rec, studlab = TRUE)
#this is for post bc death chemo
c4 <- data2[c(1, 80, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- c4[c(2, 6, 7, 15, 16, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis10 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_chemo_post_bc_death <- metareg(all_post_bc_death_analysis10, ~chemo_percent)
metareg_chemo_post_bc_death
bubble(metareg_chemo_post_bc_death, studlab = TRUE)
#this is for post ac death chemo
c5 <- data2[c(1, 80, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- c5[c(2, 6, 14, 15, 16, 19, 20, 22, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis10 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_chemo_post_ac_death <- metareg(all_post_ac_death_analysis10, ~chemo_percent)
metareg_chemo_post_ac_death
bubble(metareg_chemo_post_ac_death, studlab = TRUE)
#this is for post rec chemo
c6 <- data2[c(1, 80, 789:792, 795:798, 808:811)]
all_post_rec_data2 <- c6[c(5, 10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis10 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_chemo_post_rec <- metareg(all_post_rec_analysis10, ~chemo_percent)
metareg_chemo_post_rec
bubble(metareg_chemo_post_rec, studlab = TRUE)
#now do meta regressions for hormone therapy proportion
#start with pre bc death
t1 <- data2[c(1, 81, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- t1[c(6, 7, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis11 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_hormone_therapy_pre_bc_death <- metareg(all_pre_bc_death_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_pre_bc_death
bubble(metareg_hormone_therapy_pre_bc_death, studlab = TRUE)
#this is for pre ac death hormone therapy
t2 <- data2[c(1, 81, 204:207, 214:217)] 
all_pre_ac_death_data3 <- t2[c(6, 18, 21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis11 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_hormone_therapy_pre_ac_death <- metareg(all_pre_ac_death_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_pre_ac_death
bubble(metareg_hormone_therapy_pre_ac_death, studlab = TRUE)
#this is for pre rec hormone therapy
t3 <- data2[c(1, 81, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- t3[c(5, 7, 10, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis11 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_hormone_therapy_pre_rec <- metareg(all_pre_rec_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_pre_rec
bubble(metareg_hormone_therapy_pre_rec, studlab = TRUE)
#this is for post bc death hormone therapy
t4 <- data2[c(1, 81, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- t4[c(2, 6, 7, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis11 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_hormone_therapy_post_bc_death <- metareg(all_post_bc_death_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_post_bc_death
bubble(metareg_hormone_therapy_post_bc_death, studlab = TRUE)
#this is for post ac death hormone therapy
t5 <- data2[c(1, 81, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- t5[c(2, 6, 22, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis11 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_hormone_therapy_post_ac_death <- metareg(all_post_ac_death_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_post_ac_death
bubble(metareg_hormone_therapy_post_ac_death, studlab = TRUE)
#this is for post rec hormone therapy
t6 <- data2[c(1, 81, 789:792, 795:798, 808:811)]
all_post_rec_data2 <- t6[c(5, 10, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis11 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_hormone_therapy_post_rec <- metareg(all_post_rec_analysis11, ~hormone_therapy_percent)
metareg_hormone_therapy_post_rec
bubble(metareg_hormone_therapy_post_rec, studlab = TRUE)
#now do meta regressions of surgery proportion
#start with pre bc death
g1 <- data2[c(1, 82, 101:104, 111:114)]
all_pre_bc_death_analysis_data3 <- g1[c(6, 15, 16, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis12 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_surgery_pre_bc_death <- metareg(all_pre_bc_death_analysis12, ~surgery_percent)
metareg_surgery_pre_bc_death
bubble(metareg_surgery_pre_bc_death, studlab = TRUE)
#this is for pre ac death surgery 
g2 <- data2[c(1, 82, 204:207, 214:217)] 
all_pre_ac_death_data3 <- g2[c(6, 15, 18, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis12 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_surgery_pre_ac_death <- metareg(all_pre_ac_death_analysis12, ~surgery_percent)
metareg_surgery_pre_ac_death
bubble(metareg_surgery_pre_ac_death, studlab = TRUE)
#this is for pre rec surgery
g3 <- data2[c(1, 82, 231:234, 241:244, 247:250, 252:255)]
all_pre_rec_data3 <- g3[c(5, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis12 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_surgery_pre_rec <- metareg(all_pre_rec_analysis12, ~surgery_percent)
metareg_surgery_pre_rec
bubble(metareg_surgery_pre_rec, studlab = TRUE)
#this is for post bc death surgery
g4 <- data2[c(1, 82, 277:280, 288:291, 293:296, 298:301)]
all_post_bc_death_data3 <- g4[c(6, 15, 16, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis12 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_surgery_post_bc_death <- metareg(all_post_bc_death_analysis12, ~surgery_percent)
metareg_surgery_post_bc_death
bubble(metareg_surgery_post_bc_death, studlab = TRUE)
#this is for post ac death surgery
g5 <- data2[c(1, 82, 611:614, 621:624, 627:630, 640:643, 645:648)]
all_post_ac_data3 <- g5[c(6, 15, 16, 19, 22, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis12 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_surgery_post_ac_death <- metareg(all_post_ac_death_analysis12, ~surgery_percent)
metareg_surgery_post_ac_death
bubble(metareg_surgery_post_ac_death, studlab = TRUE)
#this is for post rec surgery
g6 <- data2[c(1, 82, 789:792, 795:798, 808:811)]
all_post_rec_data2 <- g6[c(5, 19, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis12 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_surgery_post_rec <- metareg(all_post_rec_analysis12, ~surgery_percent)
metareg_surgery_post_rec
bubble(metareg_surgery_post_rec, studlab = TRUE)
#now do meta regressions by race 
#start with proportion of cohort white- will be doing this for every analysis except post bc death
#start with pre bc death
w1 <- data2[c(1, 92, 104:107, 114:117)]
all_pre_bc_death_analysis_data3 <- w1[c(11, 13, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis13 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_white_pre_bc_death <- metareg(all_pre_bc_death_analysis13, ~percent_white)
metareg_white_pre_bc_death
bubble(metareg_white_pre_bc_death, studlab = TRUE)
#this is for pre ac death proportion white
w2 <- data2[c(1, 92, 207:210, 217:220)] 
all_pre_ac_death_data3 <- w2[c(11, 21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis13 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_white_pre_ac_death <- metareg(all_pre_ac_death_analysis13, ~percent_white)
metareg_white_pre_ac_death
bubble(metareg_white_pre_ac_death, studlab = TRUE)
#this is for pre rec proportion white
w3 <- data2[c(1, 92, 234:237, 244:247, 250:253, 255:258)]
all_pre_rec_data3 <- w3[c(10, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis13 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_white_pre_rec <- metareg(all_pre_rec_analysis13, ~percent_white)
metareg_white_pre_rec
bubble(metareg_white_pre_rec, studlab = TRUE)
#this is for post ac death proportion white
w4 <- data2[c(1, 92, 614:617, 624:627, 630:633, 643:646, 648:651)]
all_post_ac_data3 <- w4[c(11, 19, 20, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis13 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_white_post_ac_death <- metareg(all_post_ac_death_analysis13, ~percent_white)
metareg_white_post_ac_death
bubble(metareg_white_post_ac_death, studlab = TRUE)
#this is for post rec proportion white
w5 <- data2[c(1, 92, 792:795, 798:801, 811:814)]
all_post_rec_data2 <- w5[c(10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis13 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_white_post_rec <- metareg(all_post_rec_analysis13, ~percent_white)
metareg_white_post_rec
bubble(metareg_white_post_rec, studlab = TRUE)
#now do regressions by proportion of study cohort of black ethnicity
#start with pre bc death
b1 <- data2[c(1, 93, 104:107, 114:117)]
all_pre_bc_death_analysis_data3 <- b1[c(13, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis14 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_black_pre_bc_death <- metareg(all_pre_bc_death_analysis14, ~percent_black)
metareg_black_pre_bc_death
bubble(metareg_black_pre_bc_death, studlab = TRUE)
#this is for pre ac death by proportion black
b2 <- data2[c(1, 93, 207:210, 217:220)] 
all_pre_ac_death_data3 <- b2[c(21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis14 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_black_pre_ac_death <- metareg(all_pre_ac_death_analysis14, ~percent_black)
metareg_black_pre_ac_death
bubble(metareg_black_pre_ac_death, studlab = TRUE)
#this is for pre rec proportion black
b3 <- data2[c(1, 93, 234:237, 244:247, 250:253, 255:258)]
all_pre_rec_data3 <- b3[c(10, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis14 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_black_pre_rec <- metareg(all_pre_rec_analysis14, ~percent_black)
metareg_black_pre_rec
bubble(metareg_black_pre_rec, studlab = TRUE)
#this is for post ac death proportion black
b4 <- data2[c(1, 93, 614:617, 624:627, 630:633, 643:646, 648:651)]
all_post_ac_data3 <- b4[c(19, 20, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis14 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_black_post_ac_death <- metareg(all_post_ac_death_analysis14, ~percent_black)
metareg_black_post_ac_death
bubble(metareg_black_post_ac_death, studlab = TRUE)
#this is for post rec proportion black
b5 <- data2[c(1, 93, 792:795, 798:801, 811:814)]
all_post_rec_data2 <- b5[c(10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis14 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_black_post_rec <- metareg(all_post_rec_analysis14, ~percent_black)
metareg_black_post_rec
bubble(metareg_black_post_rec, studlab = TRUE)
#now do meta regressions of proportion asian
#start with post ac death
a1 <- data2[c(1, 94, 614:617, 624:627, 630:633, 643:646, 648:651)]
all_post_ac_data3 <- a1[c(19, 20, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis15 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_asian_post_ac_death <- metareg(all_post_ac_death_analysis15, ~percent_asian)
metareg_asian_post_ac_death
bubble(metareg_asian_post_ac_death, studlab = TRUE)
#this is for post rec proportion asian
a2 <- data2[c(1, 94, 792:795, 798:801, 811:814)]
all_post_rec_data2 <- a2[c(10, 19, 20),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis15 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_asian_post_rec <- metareg(all_post_rec_analysis15, ~percent_asian)
metareg_asian_post_rec
bubble(metareg_asian_post_rec, studlab = TRUE)
#now do meta regression based on node positivity data
#start with pre bc death
n1 <- data2[c(1, 64, 106:109, 116:119)]
all_pre_bc_death_analysis_data3 <- n1[c(1, 4, 6, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis15 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_node_pre_bc_death <- metareg(all_pre_bc_death_analysis15, ~node_pos_percent)
metareg_node_pre_bc_death
bubble(metareg_node_pre_bc_death, studlab = TRUE)
#this code is for pre ac death node pos
n2 <- data2[c(1, 64, 209:212, 219:222)] 
all_pre_ac_death_data3 <- n2[c(1, 4, 6, 18, 21, 23),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis15 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_node_pre_ac_death <- metareg(all_pre_ac_death_analysis15, ~node_pos_percent)
metareg_node_pre_ac_death
bubble(metareg_node_pre_ac_death, studlab = TRUE)
#this is for pre rec node pos
n3 <- data2[c(1, 64, 236:239, 246:249, 252:255, 257:260)]
all_pre_rec_data3 <- n3[c(10, 18, 23),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis15 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_node_pre_rec <- metareg(all_pre_rec_analysis15, ~node_pos_percent)
metareg_node_pre_rec
bubble(metareg_node_pre_rec, studlab = TRUE)
#this is for post bc death node pos
n4 <- data2[c(1, 64, 282:285, 293:296, 298:301, 303:306)]
all_post_bc_death_data3 <- n4[c(1, 3, 6, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis15 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_node_post_bc_death <- metareg(all_post_bc_death_analysis15, ~node_pos_percent)
metareg_node_post_bc_death
bubble(metareg_node_post_bc_death, studlab = TRUE)
#this is for post ac death node pos
n5 <- data2[c(1, 64, 616:619, 626:629, 632:635, 645:648, 650:653)]
all_post_ac_data3 <- n5[c(1, 3, 6, 19, 20, 23),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis16 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_node_post_ac_death <- metareg(all_post_ac_death_analysis16, ~node_pos_percent)
metareg_node_post_ac_death
bubble(metareg_node_post_ac_death, studlab = TRUE)
#this is for post rec node pos
n6 <- data2[c(1, 64, 794:797, 800:803, 813:816)]
all_post_rec_data2 <- n6[c(10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis16 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_node_post_rec <- metareg(all_post_rec_analysis16, ~node_pos_percent)
metareg_node_post_rec
bubble(metareg_node_post_rec, studlab = TRUE)
#not really enough data to do a metastasis meta regression
#now do a meta regression of proportion of people with bmi <25, 25-30, >30
#start with bmi <25
#start with pre bc death
#start with pre bc death
x1 <- data2[c(1, 93, 109:112, 119:122)]
all_pre_bc_death_analysis_data3 <- x1[c(4, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis17 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_bmiunder25_pre_bc_death <- metareg(all_pre_bc_death_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_pre_bc_death
bubble(metareg_bmiunder25_pre_bc_death, studlab = TRUE)
#this is for pre ac death bmi under 25 
x2 <- data2[c(1, 93, 212:215, 222:225)] 
all_pre_ac_death_data3 <- x2[c(4, 18, 21, 23),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis17 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_bmiunder25_pre_ac_death <- metareg(all_pre_ac_death_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_pre_ac_death
bubble(metareg_bmiunder25_pre_ac_death, studlab = TRUE)
#this is for pre rec bmi under 25
x3 <- data2[c(1, 93, 239:242, 249:252, 255:258, 260:263)]
all_pre_rec_data3 <- x3[c(10, 18, 23),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis17 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_bmiunder25_pre_rec <- metareg(all_pre_rec_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_pre_rec
bubble(metareg_bmiunder25_pre_rec, studlab = TRUE)
#this is for post bc death bmi under 25
x4 <- data2[c(1, 93, 285:288, 296:299, 301:304, 306:309)]
all_post_bc_death_data3 <- x4[c(8, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis17 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_bmiunder25_post_bc_death <- metareg(all_post_bc_death_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_post_bc_death
bubble(metareg_bmiunder25_post_bc_death, studlab = TRUE)
#this is for post ac death bmi under 25
x5 <- data2[c(1, 93, 619:622, 629:632, 635:638, 648:651, 653:656)]
all_post_ac_data3 <- x5[c(8, 14, 22, 23),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis17 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_bmiunder25_post_ac_death <- metareg(all_post_ac_death_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_post_ac_death
bubble(metareg_bmiunder25_post_ac_death, studlab = TRUE)
#this is for post rec bmi under 25
x6 <- data2[c(1, 93, 797:800, 803:806, 816:819)]
all_post_rec_data2 <- x6[c(8, 10, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis17 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_bmiunder25_post_rec <- metareg(all_post_rec_analysis17, ~bmi_under25_percent)
metareg_bmiunder25_post_rec
bubble(metareg_bmiunder25_post_rec, studlab = TRUE)
#now do meta regressions based on proportion of cohort w bmi >25 and <30
#start with pre bc death
y1 <- data2[c(1, 94, 109:112, 119:122)]
all_pre_bc_death_analysis_data3 <- y1[c(4, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis18 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_bmi25to30_pre_bc_death <- metareg(all_pre_bc_death_analysis18, ~bmi_25to30_percent)
metareg_bmi25to30_pre_bc_death
bubble(metareg_bmi25to30_pre_bc_death, studlab = TRUE)
#this is for pre ac death bmi 25-30
y2 <- data2[c(1, 94, 212:215, 222:225)] 
all_pre_ac_death_data3 <- y2[c(4, 18, 21, 23),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis18 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_bmi25to30_pre_ac_death <- metareg(all_pre_ac_death_analysis18, ~bmi_25to30_percent)
metareg_bmi25to30_pre_ac_death
bubble(metareg_bmi25to30_pre_ac_death, studlab = TRUE)
#this is for pre rec bmi 25-30
y3 <- data2[c(1, 94, 239:242, 249:252, 255:258, 260:263)]
all_pre_rec_data3 <- y3[c(10, 18, 23),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis18 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_bmi25to30_pre_rec <- metareg(all_pre_rec_analysis18, ~bmi_25to30_percent)
metareg_bmi25to30_pre_rec
bubble(metareg_bmi25to30_pre_rec, studlab = TRUE)
#not enough data to do post bc death bmi 25-30
#this is for post ac death bmi 25-30
y4 <- data2[c(1, 94, 619:622, 629:632, 635:638, 648:651, 653:656)]
all_post_ac_data3 <- y4[c(14, 22, 23),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis18 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_bmi25to30_post_ac_death <- metareg(all_post_ac_death_analysis18, ~bmi_25to30_percent)
metareg_bmi25to30_post_ac_death
bubble(metareg_bmi25to30_post_ac_death, studlab = TRUE)
#not enough data to do post rec bmi 25-30
#now do meta regressions based on proportion of cohort w bmi >30
#start with pre bc death
v1 <- data2[c(1, 95, 109:112, 119:122)]
all_pre_bc_death_analysis_data3 <- v1[c(4, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis19 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_bmiover30_pre_bc_death <- metareg(all_pre_bc_death_analysis19, ~bmi_over30_percent)
metareg_bmiover30_pre_bc_death
bubble(metareg_bmiover30_pre_bc_death, studlab = TRUE)
#this code is for pre ac death bmi over 30
v2 <- data2[c(1, 95, 212:215, 222:225)] 
all_pre_ac_death_data3 <- v2[c(4, 18, 21, 23),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis19 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_bmiover30_pre_ac_death <- metareg(all_pre_ac_death_analysis19, ~bmi_over30_percent)
metareg_bmiover30_pre_ac_death
bubble(metareg_bmiover30_pre_ac_death, studlab = TRUE)
#this is for pre rec bmi over 30
v3 <- data2[c(1, 95, 239:242, 249:252, 255:258, 260:263)]
all_pre_rec_data3 <- v3[c(10, 18, 23),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis19 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_bmiover30_pre_rec <- metareg(all_pre_rec_analysis19, ~bmi_over30_percent)
metareg_bmiover30_pre_rec
bubble(metareg_bmiover30_pre_rec, studlab = TRUE)
#not enough data to do post bc death bmi >30
#this is for post ac death bmi >30
v4 <- data2[c(1, 95, 619:622, 629:632, 635:638, 648:651, 653:656)]
all_post_ac_data3 <- v4[c(14, 22, 23),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis19 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_bmiover30_post_ac_death <- metareg(all_post_ac_death_analysis19, ~bmi_over30_percent)
metareg_bmiover30_post_ac_death
bubble(metareg_bmiover30_post_ac_death, studlab = TRUE)
#not enough data to do post rec bmi >30
#now do meta regression of followup length and all analyses
#start with pre bc death 
f1 <- data2[c(1, 104, 110:113, 120:123)]
all_pre_bc_death_analysis_data3 <- f1[c(6, 7, 15, 16, 17, 21, 23),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis20 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_followup_pre_bc_death <- metareg(all_pre_bc_death_analysis20, ~mean_or_median_followup)
metareg_followup_pre_bc_death
bubble(metareg_followup_pre_bc_death, studlab = TRUE)
#this is for pre ac death followup length
f2 <- data2[c(1, 104, 213:216, 223:226)] 
all_pre_ac_death_data3 <- f2[c(6, 15, 18, 21, 23, 24),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis20 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_followup_pre_ac_death <- metareg(all_pre_ac_death_analysis20, ~mean_or_median_followup)
metareg_followup_pre_ac_death
bubble(metareg_followup_pre_ac_death, studlab = TRUE)
#this is for pre rec follouwp
f3 <- data2[c(1, 104, 240:243, 250:253, 256:259, 261:264)]
all_pre_rec_data3 <- f3[c(5, 7, 10, 18, 23, 24),]
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR, unadj_pre_rec_after5years_OR_only, pre_adj_rec_RR_only, unadj_pre_rec_HR_only, adj_pre_rec_HR_only, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- gsub("0.98", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR) 
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI, unadj_pre_rec_after5years_OR_CI, pre_adj_rec_RR_CI, unadj_pre_rec_HR_CI, adj_pre_rec_HR_CI, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.80-0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI <- gsub("0.88-1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_lower, unadj_pre_rec_after5years_OR_CI_lower, pre_adj_rec_RR_CI_lower, unadj_pre_rec_CI_lower, adj_pre_rec__HR_CI_lower, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.80", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- gsub("0.88", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3 <- all_pre_rec_data3 %>% unite(pre_rec_OR_RR_or_HR_CI_upper, unadj_pre_rec_after5years_OR_CI_upper, pre_adj_rec_RR_CI_upper, unadj_pre_rec_CI_upper, adj_pre_rec__HR_CI_upper, sep = "")
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("0.96", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- gsub("1.09", "", all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_data3$pre_rec_OR_RR_or_HR <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_lower)
all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper <- as.numeric(all_pre_rec_data3$pre_rec_OR_RR_or_HR_CI_upper)
all_pre_rec_analysis20 <- metagen(TE = log(pre_rec_OR_RR_or_HR), lower = log(pre_rec_OR_RR_or_HR_CI_lower), upper = log(pre_rec_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_pre_rec_data3, exclude = NULL, sm = "HR") 
metareg_followup_pre_rec <- metareg(all_pre_rec_analysis20, ~mean_or_median_followup)
metareg_followup_pre_rec
bubble(metareg_followup_pre_rec, studlab = TRUE)
#this is for post bc death followup
f4 <- data2[c(1, 104, 286:289, 297:300, 302:305, 307:310)]
all_post_bc_death_data3 <- f4[c(3, 6, 7, 9, 15, 16, 22, 23),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis20 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_followup_post_bc_death <- metareg(all_post_bc_death_analysis20, ~mean_or_median_followup)
metareg_followup_post_bc_death
bubble(metareg_followup_post_bc_death, studlab = TRUE)
#this is for post ac death followup
f5 <- data2[c(1, 104, 620:623, 630:633, 636:639, 649:652, 654:657)]
all_post_ac_data3 <- f5[c(3, 6, 9, 12, 15, 16, 19, 20, 22, 23, 24),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis20 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_followup_post_ac_death <- metareg(all_post_ac_death_analysis20, ~mean_or_median_followup)
metareg_followup_post_ac_death
bubble(metareg_followup_post_ac_death, studlab = TRUE)
#this is for post rec followup
f6 <- data2[c(1, 104, 798:801, 804:807, 817:820)]
all_post_rec_data2 <- f6[c(5, 10, 19, 20, 23),]
all_post_rec_data2$post_rec_unadj_HR_only <- gsub("0.98", "", all_post_rec_data2$post_rec_unadj_HR_only)
all_post_rec_data2$post_rec_unadj_HR_CI <- gsub("0.81-1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI)
all_post_rec_data2$post_rec_unadj_HR_CI_lower <- gsub("0.81", "", all_post_rec_data2$post_rec_unadj_HR_CI_lower)
all_post_rec_data2$post_rec_unadj_HR_CI_upper <- gsub("1.20", "", all_post_rec_data2$post_rec_unadj_HR_CI_upper)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR, post_rec_unadj_HR_only, post_rec_adj_RR_only, post_rec_adj_HR_only, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI, post_rec_unadj_HR_CI, post_rec_adj_RR_CI, post_rec_adj_HR_CI, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_lower, post_rec_unadj_HR_CI_lower, post_rec_adj_RR_CI_lower, post_rec_adj_HR_CI_lower, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2 <- all_post_rec_data2 %>% unite(all_post_rec_RR_or_HR_CI_upper, post_rec_unadj_HR_CI_upper, post_rec_adj_RR_CI_upper, post_rec_adj_HR_CI_upper, sep = "")
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- gsub("NA", "", all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_data2$all_post_rec_RR_or_HR <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_lower)
all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper <- as.numeric(all_post_rec_data2$all_post_rec_RR_or_HR_CI_upper)
all_post_rec_analysis20 <- metagen(TE = log(all_post_rec_RR_or_HR), lower = log(all_post_rec_RR_or_HR_CI_lower), upper = log(all_post_rec_RR_or_HR_CI_upper), studlab = author_year, data = all_post_rec_data2, exclude = NULL, sm = "HR")
metareg_followup_post_rec <- metareg(all_post_rec_analysis20, ~mean_or_median_followup)
metareg_followup_post_rec
bubble(metareg_followup_post_rec, studlab = TRUE)
#now do meta regression of low dose aspirin % and all analyses
#start with pre bc death 
q1 <- data2[c(1, 106, 111:114, 121:124)]
all_pre_bc_death_analysis_data3 <- q1[c(1, 6, 7, 15, 16, 17),]
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR, unadj_pre_bc_death_OR_only, adj_pre_bc_death_HR_only, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_CIs, unadj_pre_bc_death_OR_CI, adj_pre_bc_death_HR_CI, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_lower_CIs, unadj_pre_bc_death_OR_lower_CI, adj_pre_bc_death_HR_CI_lower, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3 <- all_pre_bc_death_analysis_data3 %>% unite(pre_bc_death_OR_or_HR_higher_CIs, unadj_pre_bc_death_OR_higher_CI, adj_pre_bc_death_HR_CI_upper, sep = "")
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- gsub("NA", "", all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_lower_CIs)
all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs <- as.numeric(all_pre_bc_death_analysis_data3$pre_bc_death_OR_or_HR_higher_CIs)
all_pre_bc_death_analysis21 <- metagen(TE = log(pre_bc_death_OR_or_HR), lower = log(pre_bc_death_OR_or_HR_lower_CIs), upper = log(pre_bc_death_OR_or_HR_higher_CIs), studlab = author_year, data = all_pre_bc_death_analysis_data3, exclude = NULL, sm = "HR")
metareg_lowdose_pre_bc_death <- metareg(all_pre_bc_death_analysis21, ~percent_lowdose)
metareg_lowdose_pre_bc_death
bubble(metareg_lowdose_pre_bc_death, studlab = TRUE)
#this is for pre ac death lowdose
q2 <- data2[c(1, 106, 214:217, 224:227)] 
all_pre_ac_death_data3 <- q2[c(1, 6, 15),]
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR, unadj_pre_ac_death_after5years_OR_only, adj_pre_ac_death_HR, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI, unadj_pre_ac_death_after5years_OR_CI, adj_pre_ac_death_CI, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_lower, unadj_pre_ac_death_after5years_OR_CI_lower, adj_pre_ac_death_CI_lower, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3 <- all_pre_ac_death_data3 %>% unite(pre_ac_death_OR_or_HR_CI_upper, unadj_pre_ac_death_after5years_OR_CI_upper, adj_pre_ac_death_CI_upper, sep = "")
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- gsub("NA", "", all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_lower)
all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper <- as.numeric(all_pre_ac_death_data3$pre_ac_death_OR_or_HR_CI_upper)
all_pre_ac_death_analysis21 <- metagen(TE = log(pre_ac_death_OR_or_HR), lower = log(pre_ac_death_OR_or_HR_CI_lower), upper = log(pre_ac_death_OR_or_HR_CI_upper), studlab = author_year, data = all_pre_ac_death_data3, exclude = NULL, sm = "HR")
metareg_lowdose_pre_ac_death <- metareg(all_pre_ac_death_analysis21, ~percent_lowdose)
metareg_lowdose_pre_ac_death
bubble(metareg_lowdose_pre_ac_death, studlab = TRUE)
#not enough data to do pre rec
#this is for post bc death lowdose
q3 <- data2[c(1, 106, 287:290, 298:301, 303:306, 308:311)]
all_post_bc_death_data3 <- q3[c(2, 6, 7, 9, 15, 16),]
all_post_bc_death_data3$unadj_post_bc_death_OR_only <- gsub("0.98", "", all_post_bc_death_data3$unadj_post_bc_death_OR_only)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI <- gsub("0.83-1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower <- gsub("0.83", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_lower)
all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper <- gsub("1.15", "", all_post_bc_death_data3$unadj_post_bc_death_OR_CI_upper)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR, adj_post_bc_death_RR_only, post_adj_bc_death_OR_only, adj_post_bc_death_HR_only, unadj_post_bc_death_OR_only, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI, adj_post_bc_death_RR_CI, post_adj_bc_death_OR_CI, adj_post_bc_death_HR_CI, unadj_post_bc_death_OR_CI, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_lower, adj_post_bc_death_RR_CI_lower, post_adj_bc_death_OR_CI_lower, adj_post_bc_death_HR_CI_lower, unadj_post_bc_death_OR_CI_lower, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3 <- all_post_bc_death_data3 %>% unite(post_bc_death_OR_RR_or_HR_CI_upper, adj_post_bc_death_RR_CI_upper, post_adj_bc_death_OR_CI_upper, adj_post_bc_death_HR_CI_upper, unadj_post_bc_death_OR_CI_upper, sep = "")
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_lower)
all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_bc_death_data3$post_bc_death_OR_RR_or_HR_CI_upper)
all_post_bc_death_analysis21 <- metagen(TE = log(post_bc_death_OR_RR_or_HR), lower = log(post_bc_death_OR_RR_or_HR_CI_lower), upper = log(post_bc_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_bc_death_data3, exclude = NULL, sm = "HR")
metareg_lowdose_post_bc_death <- metareg(all_post_bc_death_analysis21, ~percent_lowdose)
metareg_lowdose_post_bc_death
bubble(metareg_lowdose_post_bc_death, studlab = TRUE)
#this is for post ac death lowdose
q4 <- data2[c(1, 106, 621:624, 631:634, 637:640, 650:653, 655:658)]
all_post_ac_data3 <- q4[c(2, 6, 9, 14, 15, 16, 20),]
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.08", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.22", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.87", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("2.18", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("0.5", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.92-1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.01-1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.35-2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("1.99-2.40", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.34-0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.69-2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI <- gsub("0.79-1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.92", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.01", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.35", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("1.99", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.34", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.69", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_lower <- gsub("0.79", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_lower)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.26", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.47", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.61", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.4", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("0.75", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("2.31", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3$post_ac_death_unadj_HR_CI_upper <- gsub("1.48", "", all_post_ac_data3$post_ac_death_unadj_HR_CI_upper)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR, unadj_post_ac_death_RR_only, post_ac_death_unadj_HR, post_ac_death_adj_RR, adj_post_ac_death_OR_only, post_ac_death_adj_HR, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI, unadj_post_ac_death_RR_CI, post_ac_death_unadj_HR_CI, post_ac_death_adj_RR_CI, adj_post_ac_death_OR_CI, post_ac_death_adj_HR_CI, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_lower, unadj_post_ac_death_RR_CI_lower, post_ac_death_unadj_HR_CI_lower, post_ac_death_adj_RR_CI_lower, adj_post_ac_death_OR_CI_lower, post_ac_death_adj_HR_CI_lower, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3 <- all_post_ac_data3 %>% unite(all_post_ac_death_OR_RR_or_HR_CI_upper, unadj_post_ac_death_RR_CI_upper, post_ac_death_unadj_HR_CI_upper, post_ac_death_adj_RR_CI_upper, adj_post_ac_death_OR_CI_upper, post_ac_death_adj_HR_CI_upper, sep = "")
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- gsub("NA", "", all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_lower)
all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper <- as.numeric(all_post_ac_data3$all_post_ac_death_OR_RR_or_HR_CI_upper)
all_post_ac_death_analysis21 <- metagen(TE = log(all_post_ac_death_OR_RR_or_HR), lower = log(all_post_ac_death_OR_RR_or_HR_CI_lower), upper = log(all_post_ac_death_OR_RR_or_HR_CI_upper), studlab = author_year, data = all_post_ac_data3, exclude = NULL, sm = "HR")
metareg_lowdose_post_ac_death <- metareg(all_post_ac_death_analysis21, ~percent_lowdose)
metareg_lowdose_post_ac_death
bubble(metareg_lowdose_post_ac_death, studlab = TRUE)
#not enough data to do post rec 
#now do meta analyses of pre bc death dose strat 
#frisk 2018 has < or > 75mg/day, and 85% of use is 75mg, so i will include it 
#the measure is > or < 1 pill per day
dose_pre_bc_data <- data[c(4, 129:136, 141:156)]  
dose_pre_bc_data <- dose_pre_bc_data[c(17, 21, 22),]
dose_pre_bc_data <- dose_pre_bc_data %>% unite(lessthan1dailypill_HR, pre_bc_death_dose_lessthan75mguse_HR_only, pre_bc_death_dose_lessthanonedailypill_HR_only, pre_bc_death_dose_lessthansevenweeklypills_HR_only, sep = "")
dose_pre_bc_data$lessthan1dailypill_HR <- gsub("NA", "", dose_pre_bc_data$lessthan1dailypill_HR)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(morethan1dailypill_HR, pre_bc_death_dose_greaterthan75mguse_HR_only, pre_bc_death_dose_greaterthanonedailypill_HR_only, pre_bc_death_dose_morethansevenweeklypills_HR_only, sep = "")
dose_pre_bc_data$morethan1dailypill_HR <- gsub("NA", "", dose_pre_bc_data$morethan1dailypill_HR)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(lessthan1dailypill_HR_CI, pre_bc_death_dose_lessthan75mguse_HR_CI, pre_bc_death_dose_lessthanonedailypill_HR_CI, pre_bc_death_dose_lessthansevenweeklypills_HR_CI, sep = "")
dose_pre_bc_data$lessthan1dailypill_HR_CI <- gsub("NA", "", dose_pre_bc_data$lessthan1dailypill_HR_CI)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(morethan1dailypill_HR_CI, pre_bc_death_dose_greaterthan75mguse_HR_CI, pre_bc_death_dose_greaterthanonedailypill_HR_CI, pre_bc_death_dose_morethansevenweeklypills_HR_CI, sep = "")
dose_pre_bc_data$morethan1dailypill_HR_CI <- gsub("NA", "", dose_pre_bc_data$morethan1dailypill_HR_CI)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(lessthan1dailypill_HR_CI_lower, pre_bc_death_dose_lessthan75mguse_HR_CI_lower, pre_bc_death_dose_lessthanonedailypill_HR_CI_lower, pre_bc_death_dose_lessthansevenweeklypills_HR_CI_lower, sep = "")
dose_pre_bc_data$lessthan1dailypill_HR_CI_lower <- gsub("NA", "", dose_pre_bc_data$lessthan1dailypill_HR_CI_lower)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(lessthan1dailypill_HR_CI_upper, pre_bc_death_dose_lessthan75mguse_HR_CI_upper, pre_bc_death_dose_lessthanonedailypill_HR_CI_upper, pre_bc_death_dose_lessthansevenweeklypills_HR_CI_upper, sep = "")
dose_pre_bc_data$lessthan1dailypill_HR_CI_upper <- gsub("NA", "", dose_pre_bc_data$lessthan1dailypill_HR_CI_upper)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(morethan1dailypill_HR_CI_lower, pre_bc_death_dose_greaterthan75mguse_HR_CI_lower, pre_bc_death_dose_greaterthanonedailypill_HR_CI_lower, pre_bc_death_dose_morethansevenweeklypills_HR_CI_lower, sep = "")
dose_pre_bc_data$morethan1dailypill_HR_CI_lower <- gsub("NA", "", dose_pre_bc_data$morethan1dailypill_HR_CI_lower)
dose_pre_bc_data <- dose_pre_bc_data %>% unite(morethan1dailypill_HR_CI_upper, pre_bc_death_dose_greaterthan75mguse_HR_CI_upper, pre_bc_death_dose_greaterthanonedailypill_HR_CI_upper, pre_bc_death_dose_morethansevenweeklypills_HR_CI_upper, sep = "")
dose_pre_bc_data$morethan1dailypill_HR_CI_upper <- gsub("NA", "", dose_pre_bc_data$morethan1dailypill_HR_CI_upper)
dose_pre_bc_data$lessthan1dailypill_HR <- as.numeric(dose_pre_bc_data$lessthan1dailypill_HR)
dose_pre_bc_data$morethan1dailypill_HR <- as.numeric(dose_pre_bc_data$morethan1dailypill_HR)
dose_pre_bc_data$lessthan1dailypill_HR_CI_lower <- as.numeric(dose_pre_bc_data$lessthan1dailypill_HR_CI_lower)
dose_pre_bc_data$lessthan1dailypill_HR_CI_upper <- as.numeric(dose_pre_bc_data$lessthan1dailypill_HR_CI_upper)
dose_pre_bc_data$morethan1dailypill_HR_CI_lower <- as.numeric(dose_pre_bc_data$morethan1dailypill_HR_CI_lower)
dose_pre_bc_data$morethan1dailypill_HR_CI_upper <- as.numeric(dose_pre_bc_data$morethan1dailypill_HR_CI_upper)
lessthan1dailydose_pre_bc_analysis <- metagen(TE = log(lessthan1dailypill_HR), lower = log(lessthan1dailypill_HR_CI_lower), upper = log(lessthan1dailypill_HR_CI_upper), studlab = author_year, data = dose_pre_bc_data, exclude = NULL, sm = "HR")
summary(lessthan1dailydose_pre_bc_analysis)
forest.meta(lessthan1dailydose_pre_bc_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
morethan1dailydose_pre_bc_analysis <- metagen(TE = log(morethan1dailypill_HR), lower = log(morethan1dailypill_HR_CI_lower), upper = log(morethan1dailypill_HR_CI_upper), studlab = author_year, data = dose_pre_bc_data, exclude = NULL, sm = "HR")
summary(morethan1dailydose_pre_bc_analysis)
forest.meta(morethan1dailydose_pre_bc_analysis, sortvar = TE,predict = TRUE, print.tau2 = FALSE, leftlabs = c("Author", "g", "SE"))
